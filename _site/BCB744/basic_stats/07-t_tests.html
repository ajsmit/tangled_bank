<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.361">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="AJ Smit">
<meta name="dcterms.date" content="2021-01-01">
<title>The Tangled Bank - 7. t-tests</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../BCB744/basic_stats/08-anova.html" rel="next">
<link href="../../BCB744/basic_stats/06-assumptions.html" rel="prev">
<link href="../../images/favicon.ico" rel="icon">
<script src="../../site_libs/cookie-consent/cookie-consent.js"></script>
<link href="../../site_libs/cookie-consent/cookie-consent.css" rel="stylesheet">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-SCYH68M489"></script><script type="text/plain" cookie-consent="tracking">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-SCYH68M489', { 'anonymize_ip': true});
</script><script type="text/javascript" charset="UTF-8">
document.addEventListener('DOMContentLoaded', function () {
cookieconsent.run({
  "notice_banner_type":"simple",
  "consent_type":"implied",
  "palette":"light",
  "language":"en",
  "page_load_consent_levels":["strictly-necessary","functionality","tracking","targeting"],
  "notice_banner_reject_button_hide":false,
  "preferences_center_close_button_hide":false,
  "website_name":""
  });
});
</script><style>html{ scroll-behavior: smooth; }</style>
<script async="" src="https://hypothes.is/embed.js"></script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><link rel="stylesheet" href="../../styles.css">
</head>
<body class="nav-sidebar floating nav-fixed slimcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="navbar navbar-expand-lg navbar-dark "><div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">The Tangled Bank</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
<li class="nav-item">
    <a class="nav-link active" href="../../index.html" rel="" target="" aria-current="page">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html" rel="" target="">
 <span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-vignettes" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Vignettes</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-vignettes">
<li>
    <a class="dropdown-item" href="../../vignettes/chl_ERDDAP.html" rel="" target="">
 <span class="dropdown-text">Retrieving Chlorophyll-a Data from ERDDAP Servers</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../vignettes/chl_sightings.html" rel="" target="">
 <span class="dropdown-text">Plotting the Whale Sightings and Chlorophyll-<em>a</em> Concentrations</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../vignettes/chl_localisation.html" rel="" target="">
 <span class="dropdown-text">Spatial Localisation, Subsetting, and Aggregation of the Chlorophyll-<em>a</em> Data</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../vignettes/prep_NOAA_OISST.html" rel="" target="">
 <span class="dropdown-text">Downloading and Prep: ERDDAP</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../vignettes/regridding.html" rel="" target="">
 <span class="dropdown-text">Regridding gridded data</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../vignettes/MHW_basic_detection.html" rel="" target="">
 <span class="dropdown-text">Basic Detection and Visualisation of Events</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../vignettes/gridded_data.html" rel="" target="">
 <span class="dropdown-text">Detecting Events in Gridded Data</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../vignettes/alt_method.html" rel="" target="">
 <span class="dropdown-text">Downloading and Prep: Python + CDO</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../vignettes/elem_ts_methods.html" rel="" target="">
 <span class="dropdown-text">Wavelet Analysis of Diatom Time Series</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../vignettes/MHW_MCS_horizonplots.html" rel="" target="">
 <span class="dropdown-text">Displaying MHWs and MCSs as horizon plots</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../vignettes/heatwaveR_issues.html" rel="" target="">
 <span class="dropdown-text">heatwaveR issues</span></a>
  </li>  
    </ul>
</li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-high-performace-computing" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">High-Performace Computing</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-high-performace-computing">
<li>
    <a class="dropdown-item" href="../../vignettes/README_Lengau.html" rel="" target="">
 <span class="dropdown-text">Using Lengau</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../vignettes/README_tmux.html" rel="" target="">
 <span class="dropdown-text">Using tmux</span></a>
  </li>  
    </ul>
</li>
</ul>
<ul class="navbar-nav navbar-nav-scroll ms-auto">
<li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/ajsmit" rel="" target=""><i class="bi bi-twitter" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-bi-github" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
      <i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-bi-github">
<li>
    <a class="dropdown-item" href="https://github.com/ajsmit/tangled_bank" rel="" target="">
 <span class="dropdown-text">Source Code</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://bugs.com" rel="" target="">
 <span class="dropdown-text">Report a Bug</span></a>
  </li>  
    </ul>
</li>
</ul>
<div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../BCB744/basic_stats/01-data-in-R.html">BCB744 (Biostatistics)</a></li><li class="breadcrumb-item"><a href="../../BCB744/basic_stats/07-t_tests.html">7. <em>t</em>-tests</a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-center sidebar-header">
      <a href="../../index.html" class="sidebar-logo-link">
      <img src="../../images/hex_logo.png" alt="" class="sidebar-logo py-0 d-lg-inline d-none"></a>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
 <span class="menu-text">☘︎</span>
  </li>
        <li class="sidebar-item">
 <span class="menu-text">UNDERGRADUATE</span>
  </li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="false">
 <span class="menu-text">BDC223</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../pages/BDC223_FAQ.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">FAQ</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false">
 <span class="menu-text">BDC334</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BDC334/BDC334_index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">BDC334: Macroecology and Global Biogeography</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BDC334/01-introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lab 1: Ecological Data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BDC334/02a-r_rstudio.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lab 2a: R and RStudio</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BDC334/02b-env_dist.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lab 2b: Environmental Distance</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BDC334/03-biodiversity1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lab 3: Quantifying Biodiversity</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BDC334/04-biodiversity2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lab 4: Describing Biodiversity Patterns</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../pages/Transboundary_systems.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Transboundary systems</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item">
 <span class="menu-text">☘</span>
  </li>
        <li class="sidebar-item">
 <span class="menu-text">HONOURS CORE</span>
  </li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false">
 <span class="menu-text">BCB744 (Intro R)</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BCB744/BCB744_index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">BCB744: Introduction to R, and Biostatistics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BCB744/intro_r/01-RStudio.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">1. R and RStudio</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BCB744/intro_r/02-working-with-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">2. Working with data and code</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BCB744/intro_r/03-workflow.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">3. R workflows</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BCB744/intro_r/04-graphics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">4. Graphics with ggplot2</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BCB744/intro_r/05-faceting.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">5. Faceting figures</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BCB744/intro_r/06-brewing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">6. Brewing colours</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BCB744/intro_r/07-mapping.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">7. Mapping with ggplot2</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BCB744/intro_r/08-mapping_style.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">8. Mapping with style</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BCB744/intro_r/09-mapping_rnaturalearth.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">9. Mapping with Natural Earth and the <strong>sf</strong> package</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BCB744/intro_r/10-mapping_quakes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">10. The Fiji Earthquake Data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BCB744/intro_r/11-tidy.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">11. Tidy data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BCB744/intro_r/12-tidier.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">12. Tidier data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BCB744/intro_r/13-tidiest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">13. Tidiest data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BCB744/intro_r/14-recap.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">14. Recap</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BCB744/intro_r/15-functions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">15. Functions by chapter</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BCB744/intro_r/16-base_r.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">16. Base R primer</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BCB744/intro_r/17-dates.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">17. Dates</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
 <span class="menu-text">BCB744 (Biostatistics)</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BCB744/basic_stats/01-data-in-R.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">1. Data classes and structures in R</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BCB744/basic_stats/02-summarise-and-describe.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">2. Exploring with summaries and descriptions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BCB744/basic_stats/03-visualise.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">3. Exploring with figures</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BCB744/basic_stats/04-distributions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">4. Data distributions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BCB744/basic_stats/05-inference.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">5. Statistical inference and hypothesis testing</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BCB744/basic_stats/06-assumptions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">6. Assumptions for parametric statistics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BCB744/basic_stats/07-t_tests.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">7. <em>t</em>-tests</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BCB744/basic_stats/08-anova.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">8. Analysis of Variance (ANOVA)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BCB744/basic_stats/09-regressions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">9. Simple linear regressions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BCB744/basic_stats/10-correlations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">10. Correlations</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BCB744/basic_stats/11-glance.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">11. Non-parametric statistical tests at a glance</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BCB744/basic_stats/12-confidence.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">12. Confidence intervals</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item">
 <span class="menu-text">☘</span>
  </li>
        <li class="sidebar-item">
 <span class="menu-text">HONOURS ELECTIVES</span>
  </li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="false">
 <span class="menu-text">BCB743</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BCB743/BCB743_index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">BCB743: Quantitative Ecology</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BCB743/00-review.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">1-4. Review Biogeography and Global Ecology</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BCB743/05-correlations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">5. Correlations and Associations</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BCB743/06-deep_dive.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">6. Deep Dive into Gradients</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BCB743/07-ordination.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">7. Ordination</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BCB743/08-PCA.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">8a. Principal Component Analysis (PCA)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BCB743/08-PCA_examples.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">8b. PCA Additional Examples</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BCB743/08-PCA_SDG.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">8c. PCA of WHO SDGs</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BCB743/09-CA.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">9. Correspondence Analysis (CA)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BCB743/10-PCoA.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">10. Principal Coordinate Analysis (PCoA)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BCB743/11-nMDS.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">11a. non-Metric Multidimensional Scaling (nMDS)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BCB743/11-nMDS_diatoms.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">11b. nMDS of Mayombo’s Diatom Data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BCB743/12-constrained_ordination.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">12. Constrained Ordination</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BCB743/13-cluster_analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">13. Cluster Analysis</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item">
 <span class="menu-text">☘︎</span>
  </li>
        <li class="sidebar-item">
 <span class="menu-text">SUPPORT</span>
  </li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="false">
 <span class="menu-text">Web Resources</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../resources/general_resources_web.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">R Resources</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../resources/ecology_resources_web.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Quantitative Ecology Resources</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../resources/spatial_resources_web.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Spatial R Resources</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item">
 <span class="menu-text">☘︎</span>
  </li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">On this page</h2>
   
  <ul>
<li><a href="#at-a-glance" id="toc-at-a-glance" class="nav-link active" data-scroll-target="#at-a-glance"><span class="header-section-number">1</span> At a glance</a></li>
  <li><a href="#introduction-to-t-tests" id="toc-introduction-to-t-tests" class="nav-link" data-scroll-target="#introduction-to-t-tests"><span class="header-section-number">2</span> Introduction to <em>t</em>-tests</a></li>
  <li>
<a href="#one-sample-t-tests" id="toc-one-sample-t-tests" class="nav-link" data-scroll-target="#one-sample-t-tests"><span class="header-section-number">3</span> One-sample <em>t</em>-tests</a>
  <ul class="collapse">
<li><a href="#two-sided-one-sample-t-test" id="toc-two-sided-one-sample-t-test" class="nav-link" data-scroll-target="#two-sided-one-sample-t-test"><span class="header-section-number">3.1</span> Two-sided one-sample <em>t</em>-test</a></li>
  <li><a href="#one-sided-one-sample-t-tests" id="toc-one-sided-one-sample-t-tests" class="nav-link" data-scroll-target="#one-sided-one-sample-t-tests"><span class="header-section-number">3.2</span> One-sided one-sample <em>t</em>-tests</a></li>
  </ul>
</li>
  <li>
<a href="#two-sample-t-tests" id="toc-two-sample-t-tests" class="nav-link" data-scroll-target="#two-sample-t-tests"><span class="header-section-number">4</span> Two-sample <em>t</em>-tests</a>
  <ul class="collapse">
<li><a href="#two-sided-two-sample-t-test" id="toc-two-sided-two-sample-t-test" class="nav-link" data-scroll-target="#two-sided-two-sample-t-test"><span class="header-section-number">4.1</span> Two-sided two-sample <em>t</em>-test</a></li>
  <li><a href="#one-sided-two-sample-t-test" id="toc-one-sided-two-sample-t-test" class="nav-link" data-scroll-target="#one-sided-two-sample-t-test"><span class="header-section-number">4.2</span> One-sided two-sample <em>t</em>-test</a></li>
  </ul>
</li>
  <li><a href="#paired-t-tests" id="toc-paired-t-tests" class="nav-link" data-scroll-target="#paired-t-tests"><span class="header-section-number">5</span> Paired <em>t</em>-tests</a></li>
  <li>
<a href="#is-there-a-difference-between-two-proportions" id="toc-is-there-a-difference-between-two-proportions" class="nav-link" data-scroll-target="#is-there-a-difference-between-two-proportions"><span class="header-section-number">6</span> Is there a difference between two proportions?</a>
  <ul class="collapse">
<li><a href="#one-sample-and-two-sample-tests" id="toc-one-sample-and-two-sample-tests" class="nav-link" data-scroll-target="#one-sample-and-two-sample-tests"><span class="header-section-number">6.1</span> One-sample and two-sample tests</a></li>
  <li><a href="#one-sided-and-two-sided-tests" id="toc-one-sided-and-two-sided-tests" class="nav-link" data-scroll-target="#one-sided-and-two-sided-tests"><span class="header-section-number">6.2</span> One-sided and two-sided tests</a></li>
  </ul>
</li>
  <li>
<a href="#a-t-test-workflow" id="toc-a-t-test-workflow" class="nav-link" data-scroll-target="#a-t-test-workflow"><span class="header-section-number">7</span> A <em>t</em>-test workflow</a>
  <ul class="collapse">
<li><a href="#loading-data" id="toc-loading-data" class="nav-link" data-scroll-target="#loading-data"><span class="header-section-number">7.1</span> Loading data</a></li>
  <li><a href="#visualising-data" id="toc-visualising-data" class="nav-link" data-scroll-target="#visualising-data"><span class="header-section-number">7.2</span> Visualising data</a></li>
  <li><a href="#formulating-a-hypothesis" id="toc-formulating-a-hypothesis" class="nav-link" data-scroll-target="#formulating-a-hypothesis"><span class="header-section-number">7.3</span> Formulating a hypothesis</a></li>
  <li><a href="#choosing-a-test" id="toc-choosing-a-test" class="nav-link" data-scroll-target="#choosing-a-test"><span class="header-section-number">7.4</span> Choosing a test</a></li>
  <li><a href="#checking-assumptions" id="toc-checking-assumptions" class="nav-link" data-scroll-target="#checking-assumptions"><span class="header-section-number">7.5</span> Checking assumptions</a></li>
  <li><a href="#running-an-analysis" id="toc-running-an-analysis" class="nav-link" data-scroll-target="#running-an-analysis"><span class="header-section-number">7.6</span> Running an analysis</a></li>
  <li><a href="#interpreting-the-results" id="toc-interpreting-the-results" class="nav-link" data-scroll-target="#interpreting-the-results"><span class="header-section-number">7.7</span> Interpreting the results</a></li>
  <li><a href="#drawing-conclusions" id="toc-drawing-conclusions" class="nav-link" data-scroll-target="#drawing-conclusions"><span class="header-section-number">7.8</span> Drawing conclusions</a></li>
  <li><a href="#going-further" id="toc-going-further" class="nav-link" data-scroll-target="#going-further"><span class="header-section-number">7.9</span> Going further</a></li>
  </ul>
</li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion"><span class="header-section-number">8</span> Conclusion</a></li>
  </ul><div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/ajsmit/tangled_bank/edit/main/BCB744/basic_stats/07-t_tests.qmd" class="toc-action">Edit this page</a></p><p><a href="https://github.com/ajsmit/tangled_bank/issues/new" class="toc-action">Report an issue</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content page-columns page-full column-body" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">7. <em>t</em>-tests</h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
<p class="subtitle lead">Comparing the means of two groups</p>
</div>


<div class="quarto-title-meta-author">
  <div class="quarto-title-meta-heading">Author</div>
  <div class="quarto-title-meta-heading">Affiliation</div>
  
    <div class="quarto-title-meta-contents">
    <p class="author"><a href="https://ajsmit.netlify.app">AJ Smit</a> <a href="https://orcid.org/0000-0002-3799-6126" class="quarto-title-author-orcid"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg=="></a></p>
  </div>
    <div class="quarto-title-meta-contents">
        <p class="affiliation">
            <a href="https://uwc.ac.za">
            University of the Western Cape
            </a>
          </p>
      </div>
    </div>

<div class="quarto-title-meta">

      
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">January 1, 2021</p>
    </div>
  </div>
  
    
  </div>
  

</header><div class="callout callout-style-simple callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
In this Chapter
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>One-sample <em>t</em>-tests</li>
<li>Two-sample s <em>t</em>-tests</li>
<li>Paired <em>t</em>-tests</li>
<li>Comparison of proportions</li>
</ul>
</div>
</div>
<div class="callout callout-style-simple callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Cheatsheet
</div>
</div>
<div class="callout-body-container callout-body">
<p>Find here a <a href="../../docs/Methods_cheatsheet_v1.pdf">Cheatsheet</a> on statistical methods.</p>
</div>
</div>
<div class="callout callout-style-simple callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tasks to complete in this Chapter
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>Task E 1-6</li>
</ul>
</div>
</div>
<section id="at-a-glance" class="level1" data-number="1"><h1 data-number="1">
<span class="header-section-number">1</span> At a glance</h1>
<p>Student’s <em>t</em>-tests are used to compare the <em>means of two groups</em> to determine if there is a significant difference between them. These are the expectations about your data:</p>
<ul>
<li><p><strong>Continuous dependant variable</strong> The dependent variable should be measured on a <em>continuous scale</em> (e.g., height, mass, concentration).</p></li>
<li>
<p><strong>Categorical independent variable</strong> The independent variable has two independent groups being compared, so we expect a <em>factor variable with two groups</em> (e.g.&nbsp;fertiliser levels of high and low, vegetation types of grassland and forest, herbivory levels of moderate and intense). The observations within each group should not affect the other group’s observations. There are two types of <em>t</em>-tests depending on whether the samples are independent or paired (related):</p>
<ul>
<li>
<strong>Independent sample <em>t</em>-test</strong> Appropriate when the groups consist of different individuals or observations.</li>
<li>
<strong>Paired sample <em>t</em>-test</strong>: Appropriate when the groups are related, such as before-and-after measurements or matched pairs of individuals.</li>
</ul>
</li>
</ul>
<p>Other assumptions to be aware of with regards to the dependent variable:</p>
<ul>
<li><p><strong>Normal distribution</strong> The data in each group should follow a normal distribution or be approximately normally distributed for you to use the Student’s <em>t</em>-test, <code><a href="https://rdrr.io/r/stats/t.test.html">t.test()</a></code>. If the assumption of normality is not met, as, for example, determined with the <code><a href="https://rdrr.io/r/stats/shapiro.test.html">shapiro.test()</a></code>, you may consider using a non-parametric alternative such as the Wilcoxon signed-rank test, <code><a href="https://rdrr.io/r/stats/wilcox.test.html">wilcox.test()</a></code>, as a replacement for a one-sample <em>t</em>-test or the Mann-Whitney test, also with <code><a href="https://rdrr.io/r/stats/wilcox.test.html">wilcox.test()</a></code> (but note how to set the function arguments), in stead of a two-sample <em>t</em>-test. This assumption can be relaxed for large sample sizes due to the <a href="../../BCB744/basic_stats/04-distributions.html#sec-normal">Central Limit Theorem</a>.</p></li>
<li><p><strong>Homoscedasticity</strong> The variances of the two groups should be approximately equal. If this assumption is not met, you can use Welch’s <em>t</em>-test in stead of Student’s <em>t</em>-test, as the former does not require variances to be equal. The default setting for <code><a href="https://rdrr.io/r/stats/t.test.html">t.test()</a></code> is actually Welch’s <em>t</em>-test; to perform a Student’s <em>t</em>-test (one- or two-sample <em>t</em>-test) you need to set the argument <code>var.equal = TRUE</code>.</p></li>
<li><p><strong>Random sampling</strong> The data should be obtained through random sampling or random assignment, ensuring that each observation has an equal chance of being included in the sample.</p></li>
</ul></section><section id="introduction-to-t-tests" class="level1" data-number="2"><h1 data-number="2">
<span class="header-section-number">2</span> Introduction to <em>t</em>-tests</h1>
<p>The simplest experiment that makes any scientific sense is one where data are collected to represent two groups—maybe a treatment compared to a control. For example, “does adding manure to some plants have a measurable effect on their growth compared to the situation where nothing was added that might affect the plants’ growth?” To answer this very basic question one often uses a <strong><em>t</em>-test</strong>.</p>
<p>The most commonly used <em>t</em>-test is <strong>Student’s <em>t</em>-test</strong>, a statistical hypothesis test used to determine whether two samples of data are significantly different from each other. It was introduced by William Gosset, who wrote under the pseudonym ‘Student,’ in 1908. This is a parametric test, and as already indicated, it assumes the data are normally distributed and that the variances of the two samples being compared are equal.</p>
<p>Now it becomes interesting. There are several flavours of <em>t</em>-tests, depending on the nature of our samples and the type of question being asked, but all of them involve comparing two samples. Specifically, <em>the comparison involves the sample means</em>, and as such, they test whether or not the central tendencies of two samples differ. Here are the variations:</p>
<ul>
<li>
<p><strong>One-sample <em>t</em>-tests:</strong> only one sample set of data that we wish to compare against a known population mean:</p>
<ul>
<li>one-sided one-sample <em>t</em>-tests</li>
<li>two-sided one-sample <em>t</em>-tests</li>
</ul>
</li>
<li>
<p><strong>Two-sample (or independent sample) <em>t</em>-tests:</strong> the means of two groups are compared against each other:</p>
<ul>
<li>one-sided two-sample <em>t</em>-tests</li>
<li>two-sided two-sample <em>t</em>-tests</li>
</ul>
</li>
<li>
<p><strong>Paired sample <em>t</em>-tests:</strong> two samples that are ‘matched’ or, as the name indicates, <em>paired</em>, i.e.&nbsp;they are not independent of one another:</p>
<ul>
<li>one-sided</li>
<li>two-sided</li>
</ul>
</li>
</ul>
<p>Let’s go into detail into each of these variations of <em>t</em>-tests.</p>
</section><section id="one-sample-t-tests" class="level1 page-columns page-full" data-number="3"><h1 data-number="3">
<span class="header-section-number">3</span> One-sample <em>t</em>-tests</h1>
<section id="two-sided-one-sample-t-test" class="level2 page-columns page-full" data-number="3.1"><h2 data-number="3.1" class="anchored" data-anchor-id="two-sided-one-sample-t-test">
<span class="header-section-number">3.1</span> Two-sided one-sample <em>t</em>-test</h2>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Hypothesis for two-sided one-sample <em>t</em>-test
</div>
</div>
<div class="callout-body-container callout-body">
<p><span class="math inline">\(H_{0}: \bar{x} = \mu_{0}\)</span> and <span class="math inline">\(H_{a}: \bar{x} \ne \mu_{0}\)</span></p>
<p>This is the same as:</p>
<p><span class="math inline">\(H_{0}: \bar{x} - \mu_{0} = 0\)</span> and <span class="math inline">\(H_{a}: \bar{x} - \mu_{0} \ne 0\)</span></p>
<p>Here <span class="math inline">\(\bar{x}\)</span> is the population mean and <span class="math inline">\(\mu_{0}\)</span> the hypothesised mean to which <span class="math inline">\(\bar{x}\)</span> is being compared. In this example we have a two-sided one-sample <em>t</em>-test.</p>
<p>As stated above, <span class="math inline">\(H_{0}\)</span> does not make a distinction between whether it expects <span class="math inline">\(\bar{x}\)</span> to be <span class="math inline">\(\lt\)</span> or <span class="math inline">\(\gt\)</span> <span class="math inline">\(\mu_{0}\)</span>.</p>
</div>
</div>
<p>Generally when we use a <em>t</em>-test it will be a two-sample <em>t</em>-test (see below). Occasionally, however, we may have only one set of observations (random samples taken to represent a population) whose mean, <span class="math inline">\(\bar{x}\)</span>, we wish to compare against a known population mean, <span class="math inline">\(\mu_{0}\)</span>, which had been established <em>a priori</em> (<a href="#eq-onesample">Equation&nbsp;1</a>). In R’s <code><a href="https://rdrr.io/r/stats/t.test.html">t.test()</a></code> function, the default setting is for a <strong>two-sided one-sample <em>t</em>-test</strong>—that is, <em>we don’t care if our</em> <span class="math inline">\(H_{a}\)</span> <em>is significantly less than</em> <span class="math inline">\(\mu_{0}\)</span> <em>or if it is significantly greater than</em> <span class="math inline">\(\mu_{0}\)</span>.</p>

<div class="no-row-height column-margin column-container"><div class="">
<p><strong>The one-sample <em>t</em>-test:</strong></p>
<p><span id="eq-onesample"><span class="math display">\[t = \frac{\overline{x} - \mu}{s / \sqrt{n}} \tag{1}\]</span></span></p>
<p>where <span class="math inline">\(t\)</span> is the calculated <span class="math inline">\(t\)</span>-value, <span class="math inline">\(\overline{x}\)</span> is the sample mean, <span class="math inline">\(\mu\)</span> is the hypothesised population mean, <span class="math inline">\(s\)</span> is the sample standard deviation, and <span class="math inline">\(n\)</span> the sample size.</p>
</div></div><div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># create a single sample of random normal data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">666</span><span class="op">)</span></span>
<span><span class="va">r_one</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>dat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">20</span>, mean <span class="op">=</span> <span class="fl">20</span>, sd <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>,</span>
<span>                    sample <span class="op">=</span> <span class="st">"A"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<!-- ```{r} -->
<!-- ## check normality -->
<!-- shapiro.test(r_one$dat) -->
<!-- ``` -->
<div class="cell">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># compare random data against a population mean of 20</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="va">r_one</span><span class="op">$</span><span class="va">dat</span>, mu <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    One Sample t-test

data:  r_one$dat
t = 0.0048653, df = 19, p-value = 0.9962
alternative hypothesis: true mean is not equal to 20
95 percent confidence interval:
 16.91306 23.10133
sample estimates:
mean of x 
 20.00719 </code></pre>
</div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># compare random data against a population mean of 30</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="va">r_one</span><span class="op">$</span><span class="va">dat</span>, mu <span class="op">=</span> <span class="fl">30</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    One Sample t-test

data:  r_one$dat
t = -6.7596, df = 19, p-value = 1.858e-06
alternative hypothesis: true mean is not equal to 30
95 percent confidence interval:
 16.91306 23.10133
sample estimates:
mean of x 
 20.00719 </code></pre>
</div>
</div>
<p>What do the results of these two different tests show? Let’s visualise these data to get a better understanding (<a href="#fig-boxplot1">Figure&nbsp;1</a>).</p>
<div class="cell page-columns page-full">
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">r_one</span>, <span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">dat</span>, x <span class="op">=</span> <span class="va">sample</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_boxplot</span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"indianred"</span>, notch <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>               alpha <span class="op">=</span> <span class="fl">0.3</span>, colour <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># population  mean (mu) = 20</span></span>
<span>  <span class="fu">geom_hline</span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">20</span>, colour <span class="op">=</span> <span class="st">"dodgerblue2"</span>, </span>
<span>             size <span class="op">=</span> <span class="fl">0.9</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># population  mean (mu) = 30</span></span>
<span>  <span class="fu">geom_hline</span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">30</span>, colour <span class="op">=</span> <span class="st">"indianred2"</span>, </span>
<span>             size <span class="op">=</span> <span class="fl">0.9</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>y <span class="op">=</span> <span class="st">"Value"</span>, x <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">coord_flip</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_pubclean</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div id="fig-boxplot1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="07-t_tests_files/figure-html/fig-boxplot1-1.svg" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;1: Boxplot of random normal data with. A hypothetical population mean of 20 is shown as a blue line, with the red line showing a mean of 30.</figcaption></figure>
</div>
</div></div></div>
<p>The boxplot shows the distribution of our random data against two potential population means. Does this help now to illustrate the results of our one-sample <em>t</em>-tests?</p>
</section><section id="one-sided-one-sample-t-tests" class="level2" data-number="3.2"><h2 data-number="3.2" class="anchored" data-anchor-id="one-sided-one-sample-t-tests">
<span class="header-section-number">3.2</span> One-sided one-sample <em>t</em>-tests</h2>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Hypothesis for one-sided one-sample <em>t</em>-test
</div>
</div>
<div class="callout-body-container callout-body">
<p>For example, when we are concerned that our sample mean, <span class="math inline">\(\bar{x}\)</span>, should be less than the <em>a priori</em> established value, <span class="math inline">\(\mu_{0}\)</span>:</p>
<p><span class="math inline">\(H_{0}: \bar{x} \ge \mu_{0}\)</span> and <span class="math inline">\(H_{a}: \bar{x} \lt \mu_{0}\)</span></p>
<p>Only one of the two options is shown.</p>
</div>
</div>
<p>Remember that a normal distribution has two tails. As indicated already, when we are testing for significance we are generally looking for a result that sits in the far end of either of these tails. Occasionally, however, we may want to know if the result is specifically in one of the two tails. Explicitly the leading or trailing tail. For example, is the mean value of our sample population, <span class="math inline">\(\bar{x}\)</span>, <em>significantly greater than the value</em> <span class="math inline">\(\mu_{0}\)</span>? <em>Or, is</em> <span class="math inline">\(\bar{x}\)</span> <em>less than the value</em> <span class="math inline">\(\mu_{0}\)</span>? This <em>t</em>-test is called a <strong>one-sided one-sample <em>t</em>-tests</strong>. To specify this in R we must add an argument as seen below:</p>
<div class="cell">
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># check against the trailing tail</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="va">r_one</span><span class="op">$</span><span class="va">dat</span>, mu <span class="op">=</span> <span class="fl">30</span>, alternative <span class="op">=</span> <span class="st">"less"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    One Sample t-test

data:  r_one$dat
t = -6.7596, df = 19, p-value = 9.292e-07
alternative hypothesis: true mean is less than 30
95 percent confidence interval:
     -Inf 22.56339
sample estimates:
mean of x 
 20.00719 </code></pre>
</div>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># check against the leading tail</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="va">r_one</span><span class="op">$</span><span class="va">dat</span>, mu <span class="op">=</span> <span class="fl">30</span>, alternative <span class="op">=</span> <span class="st">"greater"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    One Sample t-test

data:  r_one$dat
t = -6.7596, df = 19, p-value = 1
alternative hypothesis: true mean is greater than 30
95 percent confidence interval:
 17.451    Inf
sample estimates:
mean of x 
 20.00719 </code></pre>
</div>
</div>
<p>Are these the results we would have expected? Why does the second test not return a significant result?</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Task E
</div>
</div>
<div class="callout-body-container callout-body">
<ol type="1">
<li>Create a visualisation to graphically demonstrate the outcome of this <em>t</em>-test.</li>
</ol>
</div>
</div>
</section></section><section id="two-sample-t-tests" class="level1 page-columns page-full" data-number="4"><h1 data-number="4">
<span class="header-section-number">4</span> Two-sample <em>t</em>-tests</h1>
<section id="two-sided-two-sample-t-test" class="level2 page-columns page-full" data-number="4.1"><h2 data-number="4.1" class="anchored" data-anchor-id="two-sided-two-sample-t-test">
<span class="header-section-number">4.1</span> Two-sided two-sample <em>t</em>-test</h2>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Hypothesis for two-sided two-sample <em>t</em>-test
</div>
</div>
<div class="callout-body-container callout-body">
<p><span class="math inline">\(H_{0}: \bar{A} = \bar{B}\)</span> and <span class="math inline">\(H_{a}: \bar{A} \ne \bar{B}\)</span></p>
<p>where <span class="math inline">\(\bar{A}\)</span> is the population mean of the first sample and <span class="math inline">\(\bar{B}\)</span> the population mean of the second sample. In this example we have a two-sided two-sample <em>t</em>-test, which is the default in R’s <code><a href="https://rdrr.io/r/stats/t.test.html">t.test()</a></code> function.</p>
<p>As stated above, <span class="math inline">\(H_{0}\)</span> does not make a distinction between whether it expects the difference between <span class="math inline">\(\bar{A}\)</span> and <span class="math inline">\(\bar{B}\)</span> to be greater than or less than 0.</p>
</div>
</div>
<p>A two-sample <em>t</em>-test is used when we have samples from two different (independent) populations whose means, <span class="math inline">\(\bar{A}\)</span> and <span class="math inline">\(\bar{B}\)</span>, we would like to compare against one another. Sometimes it is called an independent sample <em>t</em>-test. Specifically, it tests whether the <em>difference between the means of two samples is zero</em>. Note that again <em>we make no distinction between whether it is more interesting that the difference is greater than zero or less zero</em>—as long as there is a difference between <span class="math inline">\(\bar{A}\)</span> and <span class="math inline">\(\bar{B}\)</span>. This test is called a <strong>two-sided two sample <em>t</em>-test</strong> and it is the most common use of a <em>t</em>-test.</p>
<p>There are two varieties of <em>t</em>-tests. In the case of samples whose variances do not differ, we perform a <strong>Student’s <em>t</em>-test</strong>. <a href="#eq-tstat">Equation&nbsp;2</a> shows how to calculate the <em>t</em>-statistic for Student’s <em>t</em>-test. The other case is if we have unequal variances in <span class="math inline">\(\bar{A}\)</span> and <span class="math inline">\(\bar{B}\)</span> (established with the Levene’s test for equality of variances; see <a href="../../BCB744/basic_stats/06-assumptions.html#sec-homogeneity">Chapter 6</a>); here, we perform <strong>Welch’s <em>t</em>-test</strong> as written in <a href="#eq-welch">Equation&nbsp;4</a>. Welch’s <em>t</em>-test is the default in R’s <code><a href="https://rdrr.io/r/stats/t.test.html">t.test()</a></code> function.</p>

<div class="no-row-height column-margin column-container"><div class="">
<p><strong>Student’s <em>t</em>-test:</strong> <span id="eq-tstat"><span class="math display">\[t=\frac{\bar{A}-\bar{B}}{\sqrt{\frac{S^{2}}{n}+\frac{S^{2}}{m}}} \tag{2}\]</span></span></p>
<p><span class="math inline">\(\bar{A}\)</span> and <span class="math inline">\(\bar{B}\)</span> are the means for groups <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span>, respectively; <span class="math inline">\(n\)</span> and <span class="math inline">\(m\)</span> are the sample sizes of the two sets of samples, respectively; and <span class="math inline">\(S^{2}\)</span> is the pooled variance, which is calculated as per <a href="#eq-pooledvar">Equation&nbsp;3</a>:</p>
<p><span id="eq-pooledvar"><span class="math display">\[S^{2}=\frac{(n-1)S_{A}^{2}+(m-1)S_{B}^{2} }{n+m-2} \tag{3}\]</span></span></p>
<p>The degrees of freedom, <em>d.f.</em>, in the equation for the shared variance is <span class="math inline">\(n_{A}+m_{B}-2\)</span>.</p>
</div><div class="">
<p><strong>Welch’s <em>t</em>-test:</strong> <span id="eq-welch"><span class="math display">\[t=\frac{\bar{A}-\bar{B}}{\sqrt{\frac{S^{2}_{A}}{n}+\frac{S^{2}_{B}}{m}}} \tag{4}\]</span></span></p>
<p>Here, <span class="math inline">\(S_{A}\)</span> and <span class="math inline">\(S_{B}\)</span> are the variances of groups <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span>, respectively (see Section X). The <em>d.f.</em> to use with Welch’s <em>t</em>-test is obtained using the Welch–Satterthwaite equation (<a href="#eq-satterthwaite">Equation&nbsp;5</a>):</p>
<p><span id="eq-satterthwaite"><span class="math display">\[d.f. = \frac{\left( \frac{S^{2}_{A}}{n}+\frac{S^{2}_{B}}{m} \right)^{2}}{\left( \frac{S^{4}_{A}}{n-1} + \frac{S^{4}_{B}}{m-1} \right)} \tag{5}\]</span></span></p>
</div></div>
<p>What do we do with this <em>t</em>-statistic? In the olden days we had to calculate the <em>t</em>-statistics and the <em>d.f.</em> by hand. These two values, the <em>d.f.</em> and <em>t</em>-value had to be read off a table of pre-calculated <em>t</em>-values, probabilities and degrees of freedom <a href="https://home.ubalt.edu/ntsbarsh/Business-stat/StatistialTables.pdf">as in here</a>. Luckily, the <em>t</em>-test function nowadays does this all automagically. But if you are feeling nostalgic over times that you have sadly never experienced, please calculate the <em>t</em>-statistic and the <em>d.f.</em> yourself and give the table a go. In fact, an excessive later in this Chapter will give you an opportunity to do so.</p>
<p>Back to the present day and the wonders of modern technology. Let’s generate some new random normal data and test to see if the data belonging to the two groups differ significantly from one-another. First, we apply the <em>t</em>-test function as usual:</p>
<div class="cell">
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># random normal data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">666</span><span class="op">)</span></span>
<span><span class="va">r_two</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>dat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">20</span>, mean <span class="op">=</span> <span class="fl">4</span>, sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>                            <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">20</span>, mean <span class="op">=</span> <span class="fl">5</span>, sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                    sample <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="fl">20</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"B"</span>, <span class="fl">20</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># perform t-test</span></span>
<span><span class="co"># note how we set the `var.equal` argument to TRUE because we know </span></span>
<span><span class="co"># our data has the same SD (they are simulated as such!)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="va">dat</span> <span class="op">~</span> <span class="va">sample</span>, data <span class="op">=</span> <span class="va">r_two</span>, var.equal <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Two Sample t-test

data:  dat by sample
t = -1.9544, df = 38, p-value = 0.05805
alternative hypothesis: true difference in means between group A and group B is not equal to 0
95 percent confidence interval:
 -1.51699175  0.02670136
sample estimates:
mean in group A mean in group B 
       4.001438        4.746584 </code></pre>
</div>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># if the variances are not equal, simply set `var.equal` to false</span></span>
<span><span class="co"># and a Welch's t-test will be performed</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The first argument we see in <code><a href="https://rdrr.io/r/stats/t.test.html">t.test()</a></code> is <code>dat ~ sample</code>. Usually in R when we see a <code>~</code> (tilde) we are creating what is known as a formula. A formula tells R how it should look for interactions between data and factors. For example <code>Y ~ X</code> reads: <span class="math inline">\(Y\)</span> as a function of <span class="math inline">\(X\)</span>. In our code above we see <code>dat ~ sample</code>. This means we are telling R that the <em>t</em>-test we want it to perform is when the <code>dat</code> column is a function of the <code>sample</code> column. In plain English we are dividing up the <code>dat</code> column into the two different samples we have, and then running a <em>t</em>-test on these samples. Another way of stating this is that the value of <code>dat</code> depends on the grouping it belong to (<code>A</code> or <code>B</code>). We will see this same formula notation cropping up later under ANOVAs, linear models, etc.</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Task E
</div>
</div>
<div class="callout-body-container callout-body">
<ol start="2" type="1">
<li>Create a visualisation to graphically demonstrate the outcome of this <em>t</em>-test.</li>
</ol>
</div>
</div>
</section><section id="one-sided-two-sample-t-test" class="level2" data-number="4.2"><h2 data-number="4.2" class="anchored" data-anchor-id="one-sided-two-sample-t-test">
<span class="header-section-number">4.2</span> One-sided two-sample <em>t</em>-test</h2>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Hypothesis for one-sided two-sample <em>t</em>-test
</div>
</div>
<div class="callout-body-container callout-body">
<p>For example, when we are concerned that the sample mean of the first population, <span class="math inline">\(\bar{A}\)</span>, should be greater than that of the second, <span class="math inline">\(\bar{B}\)</span>:</p>
<p><span class="math inline">\(H_{0}: \bar{A} \le \bar{B}\)</span> and <span class="math inline">\(H_{a}: \bar{A} \gt \bar{B}\)</span></p>
<p>Only one of the two options is shown.</p>
</div>
</div>
<p>Just as with the one-sample <em>t</em>-tests above, we may also specify which tail of the distribution we are interested in when we compare the means of our two samples. This is a <strong>one-sided two-sample <em>t</em>-test</strong>, and here too we have the Student’s <em>t</em>-test and Welch’s <em>t</em>-test varieties. We do so by providing the same arguments as previously:</p>
<div class="cell">
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># is the mean of sample B smaller than that of sample A?</span></span>
<span><span class="fu">compare_means</span><span class="op">(</span><span class="va">dat</span> <span class="op">~</span> <span class="va">sample</span>, data <span class="op">=</span> <span class="va">r_two</span>, method <span class="op">=</span> <span class="st">"t.test"</span>, var.equal <span class="op">=</span> <span class="cn">TRUE</span>, alternative <span class="op">=</span> <span class="st">"less"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 8
  .y.   group1 group2     p p.adj p.format p.signif method
  &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;    &lt;chr&gt; 
1 dat   A      B      0.971  0.97 0.97     ns       T-test</code></pre>
</div>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># is the mean of sample B greater than that of sample A?</span></span>
<span><span class="fu">compare_means</span><span class="op">(</span><span class="va">dat</span> <span class="op">~</span> <span class="va">sample</span>, data <span class="op">=</span> <span class="va">r_two</span>, method <span class="op">=</span> <span class="st">"t.test"</span>, var.equal <span class="op">=</span> <span class="cn">TRUE</span>, alternative <span class="op">=</span> <span class="st">"greater"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 8
  .y.   group1 group2      p p.adj p.format p.signif method
  &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;    &lt;chr&gt; 
1 dat   A      B      0.0290 0.029 0.029    *        T-test</code></pre>
</div>
</div>
<p>What do these results show? Is this surprising?</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Task E
</div>
</div>
<div class="callout-body-container callout-body">
<ol start="3" type="1">
<li>Repeat the above analyses using the old-fashioned <code><a href="https://rdrr.io/r/stats/t.test.html">t.test()</a></code> function.</li>
<li>Repeat the above analysis using the even more old-fashioned <a href="#eq-tstat">Equation&nbsp;2</a>. Show the code and talk us through the step you followed to read the <em>p</em>-values off the table of <em>t</em>-statistics.</li>
</ol>
</div>
</div>
</section></section><section id="paired-t-tests" class="level1 page-columns page-full" data-number="5"><h1 data-number="5">
<span class="header-section-number">5</span> Paired <em>t</em>-tests</h1>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Hypothesis for two-sided paired <em>t</em>-test
</div>
</div>
<div class="callout-body-container callout-body">
<p><span class="math inline">\(H_{0}: \bar{d} = 0\)</span> and <span class="math inline">\(H_{a}: \bar{d} \ne 0\)</span></p>
<p>where <span class="math inline">\(\bar{d}\)</span> is the mean population difference based on the matched pairs.</p>
<p>Again, here <span class="math inline">\(H_{0}\)</span> does not consider if differences are greater than or less than 0—a difference in either direction is significant. One-sided versions of the hypothesis can be stated as well.</p>
</div>
</div>

<div class="no-row-height column-margin column-container"><div class="">
<p><strong>Paired <em>t</em>-test:</strong> <span class="math display">\[t = \frac{\bar{d}}{s_d/\sqrt{n}}\]</span></p>
<p>where <span class="math inline">\(\bar{d}\)</span> is the sample mean of the differences between paired observations, <span class="math inline">\(s_d\)</span> is the sample standard deviation of the differences, and <span class="math inline">\(n\)</span> is the number of pairs. The resulting <span class="math inline">\(t\)</span>-statistic is then compared to the appropriate <span class="math inline">\(t\)</span>-distribution with <span class="math inline">\(n-1\)</span> degrees of freedom to determine the <span class="math inline">\(p\)</span>-value.</p>
</div></div><p>Paired <em>t</em>-tests are done when comparing matched samples, and in other words, when our second assumption of <em>t</em>-tests is violated: the observations are independent of one another—in paired samples, clearly they are not independent. This test is also sometimes called a dependent sample <em>t</em>-test or a repeated measures <em>t</em>-test.</p>
<p>For example, we design a survey to determine if, in a group of 20 people, individuals’ right arms differ in length from that of their left arms. For person A, we measure her right arm and her left arm. For person B we measure his right arm and his left arm. So we go all the way to person 20. A right arm belonging with one individual is always matched against a left arm in the same individual. The samples are paired so we use a paired <em>t</em>-test.</p>
<p>Another example: we follow the growth of a sample of 20 piglets over three weeks to see if they weigh more after three weeks than they did at the start of the assessment period. We measure the first piglet, named Halal, at the start of the three week period and again after. We do the same for the second piglet, Kosher. And so it goes. Each piglet has a paired set of measurements, one before matched with one after. In both these examples the data in the two groups (left arm and right arm; or before and after) are not independent, so we need to account for this in the analysis. In practice, how do we perform such a <em>t</em>-test? Who can think of a dataset we’ve used in the past that we would use a paired <em>t</em>-test for?</p>
<div class="cell">
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">compare_means</span><span class="op">(</span><span class="va">dat</span> <span class="op">~</span> <span class="va">sample</span>, data <span class="op">=</span> <span class="va">r_two</span>, method <span class="op">=</span> <span class="st">"t.test"</span>, paired <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 8
  .y.   group1 group2      p p.adj p.format p.signif method
  &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;    &lt;chr&gt; 
1 dat   A      B      0.0391 0.039 0.039    *        T-test</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Task E
</div>
</div>
<div class="callout-body-container callout-body">
<ol start="5" type="1">
<li>Divide the class into two groups. In each group, collect your own data that are suitable for analysis with a paired <em>t</em>-test. State your hypothesis. Test it. Discuss.</li>
</ol>
</div>
</div>
</section><section id="is-there-a-difference-between-two-proportions" class="level1" data-number="6"><h1 data-number="6">
<span class="header-section-number">6</span> Is there a difference between two proportions?</h1>
<p>All of the tests we covered above are designed to deal with continuous data, such as fish lengths or chlorophyll content. If we want to compare proportions (probabilities of success) of different samples against each other, or some known population mean, we need <code><a href="https://rdrr.io/r/stats/prop.test.html">prop.test()</a></code>. Let’s create a dummy dataset to get a better idea of how this function works. Below we create some data showing the result of placing two different subjects, Jack and Jill, in separate sealed rooms for two hours (120 minutes). Once every minute a mosquito is let into the room before being extracted again. The columns <code>yes</code> and <code>no</code> show if the mosquito bit the subject during that one minute. Who says science can’t be fun!</p>
<div class="cell">
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">mosquito</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">70</span>, <span class="fl">85</span>, <span class="fl">50</span>, <span class="fl">35</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">mosquito</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"yes"</span>, <span class="st">"no"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">mosquito</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Jack"</span>, <span class="st">"Jill"</span><span class="op">)</span></span>
<span><span class="va">mosquito</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     yes no
Jack  70 50
Jill  85 35</code></pre>
</div>
</div>
<section id="one-sample-and-two-sample-tests" class="level2" data-number="6.1"><h2 data-number="6.1" class="anchored" data-anchor-id="one-sample-and-two-sample-tests">
<span class="header-section-number">6.1</span> One-sample and two-sample tests</h2>
<p>As with <em>t</em>-tests, proportion tests may also be based on one sample, or two. If we have only one sample we must specify the total number of trials as well as what the expected population probability of success is. Because these are individual values, and not matrices, we will show what this would look like without using any objects but will rather give each argument within <code><a href="https://rdrr.io/r/stats/prop.test.html">prop.test()</a></code> a single exact value. In the arguments within <code><a href="https://rdrr.io/r/stats/prop.test.html">prop.test()</a></code>, <code>x</code> denotes the number of successes recorded, <code>n</code> shows the total number of individual trials performed, and <code>p</code> is the expected probability. It is easiest to consider this as though it were a series of 100 coin tosses.</p>
<div class="cell">
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># When the probability matches the population</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/prop.test.html">prop.test</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">45</span>, n <span class="op">=</span> <span class="fl">100</span>, p <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    1-sample proportions test with continuity correction

data:  45 out of 100, null probability 0.5
X-squared = 0.81, df = 1, p-value = 0.3681
alternative hypothesis: true p is not equal to 0.5
95 percent confidence interval:
 0.3514281 0.5524574
sample estimates:
   p 
0.45 </code></pre>
</div>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># When it doesn't</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/prop.test.html">prop.test</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">33</span>, n <span class="op">=</span> <span class="fl">100</span>, p <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    1-sample proportions test with continuity correction

data:  33 out of 100, null probability 0.5
X-squared = 10.89, df = 1, p-value = 0.0009668
alternative hypothesis: true p is not equal to 0.5
95 percent confidence interval:
 0.2411558 0.4320901
sample estimates:
   p 
0.33 </code></pre>
</div>
</div>
<p>If we have two samples that we would like to compare against one another we enter them into the function as follows:</p>
<div class="cell">
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># NB: Note that the `mosquito` data are a matrix, NOT a data.frame</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/prop.test.html">prop.test</a></span><span class="op">(</span><span class="va">mosquito</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    2-sample test for equality of proportions with continuity correction

data:  mosquito
X-squared = 3.5704, df = 1, p-value = 0.05882
alternative hypothesis: two.sided
95 percent confidence interval:
 -0.253309811  0.003309811
sample estimates:
   prop 1    prop 2 
0.5833333 0.7083333 </code></pre>
</div>
</div>
<p>Do mosquito’s bite Jack and Jill at different proportions?</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Task E
</div>
</div>
<div class="callout-body-container callout-body">
<ol start="6" type="1">
<li>Divide the class into two groups, Group A and Group B. In each group, collect data on 100 coin tosses. The intention is to compare the coin tosses across Groups A and B. State your hypothesis. Test it. Discuss.</li>
</ol>
</div>
</div>
</section><section id="one-sided-and-two-sided-tests" class="level2" data-number="6.2"><h2 data-number="6.2" class="anchored" data-anchor-id="one-sided-and-two-sided-tests">
<span class="header-section-number">6.2</span> One-sided and two-sided tests</h2>
<p>As with all other tests that compare values, proportion tests may be specified as either one or two-sided. Just to be clear, the default setting for <code><a href="https://rdrr.io/r/stats/prop.test.html">prop.test()</a></code>, like everything else, is a two-sided test. See code below to confirm that the results are identical with or without the added argument:</p>
<div class="cell">
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Default</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/prop.test.html">prop.test</a></span><span class="op">(</span><span class="va">mosquito</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    2-sample test for equality of proportions with continuity correction

data:  mosquito
X-squared = 3.5704, df = 1, p-value = 0.05882
alternative hypothesis: two.sided
95 percent confidence interval:
 -0.253309811  0.003309811
sample estimates:
   prop 1    prop 2 
0.5833333 0.7083333 </code></pre>
</div>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Explicitly state two-sided test</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/prop.test.html">prop.test</a></span><span class="op">(</span><span class="va">mosquito</span>, alternative <span class="op">=</span> <span class="st">"two.sided"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    2-sample test for equality of proportions with continuity correction

data:  mosquito
X-squared = 3.5704, df = 1, p-value = 0.05882
alternative hypothesis: two.sided
95 percent confidence interval:
 -0.253309811  0.003309811
sample estimates:
   prop 1    prop 2 
0.5833333 0.7083333 </code></pre>
</div>
</div>
<p>Should we want to specify only one of the tails to be considered, we do so precisely the same as with t-tests. Below are examples of what this code would look like:</p>
<div class="cell">
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Jack is bit less than Jill</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/prop.test.html">prop.test</a></span><span class="op">(</span><span class="va">mosquito</span>, alternative <span class="op">=</span> <span class="st">"less"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    2-sample test for equality of proportions with continuity correction

data:  mosquito
X-squared = 3.5704, df = 1, p-value = 0.02941
alternative hypothesis: less
95 percent confidence interval:
 -1.00000000 -0.01597923
sample estimates:
   prop 1    prop 2 
0.5833333 0.7083333 </code></pre>
</div>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Jack is bit more than Jill</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/prop.test.html">prop.test</a></span><span class="op">(</span><span class="va">mosquito</span>, alternative <span class="op">=</span> <span class="st">"greater"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    2-sample test for equality of proportions with continuity correction

data:  mosquito
X-squared = 3.5704, df = 1, p-value = 0.9706
alternative hypothesis: greater
95 percent confidence interval:
 -0.2340208  1.0000000
sample estimates:
   prop 1    prop 2 
0.5833333 0.7083333 </code></pre>
</div>
</div>
<p>Do these results differ from the two-sided test? What is different?</p>
</section></section><section id="a-t-test-workflow" class="level1 page-columns page-full" data-number="7"><h1 data-number="7">
<span class="header-section-number">7</span> A <em>t</em>-test workflow</h1>
<p>Now that we have seen how to compare the means of two sample sets of data, let’s see what that complete workflow would look like in R. For this example we will use the <code>ecklonia</code> data from <a href="https://robwschlegel.github.io/Intro_R_Workshop/">Intro R Workshop: Data Manipulation, Analysis and Graphing</a>.</p>
<section id="loading-data" class="level2" data-number="7.1"><h2 data-number="7.1" class="anchored" data-anchor-id="loading-data">
<span class="header-section-number">7.1</span> Loading data</h2>
<p>Before we can run any analyses we will need to load our data. We are also going to convert these data from their wide format into a long format because this is more useful for the rest of our workflow.</p>
<div class="cell">
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">ecklonia</span> <span class="op">&lt;-</span> <span class="fu">read_csv</span><span class="op">(</span><span class="st">"../../data/ecklonia.csv"</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">gather</span><span class="op">(</span>key <span class="op">=</span> <span class="st">"variable"</span>, value <span class="op">=</span> <span class="st">"value"</span>, <span class="op">-</span><span class="va">species</span>, <span class="op">-</span><span class="va">site</span>, <span class="op">-</span><span class="va">ID</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="visualising-data" class="level2 page-columns page-full" data-number="7.2"><h2 data-number="7.2" class="anchored" data-anchor-id="visualising-data">
<span class="header-section-number">7.2</span> Visualising data</h2>
<p>With our data loaded, let’s visualise them in order to ensure that these are indeed the data we are after (<a href="#fig-ecklonia1">Figure&nbsp;2</a>). Visualising the data will also help us to formulate a hypothesis.</p>
<div class="cell page-columns page-full">
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">ecklonia</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">variable</span>, y <span class="op">=</span> <span class="va">value</span>, fill <span class="op">=</span> <span class="va">site</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_boxplot</span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"black"</span>, fill <span class="op">=</span> <span class="st">"dodgerblue4"</span>, alpha <span class="op">=</span> <span class="fl">0.4</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">coord_flip</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div id="fig-ecklonia1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="07-t_tests_files/figure-html/fig-ecklonia1-1.svg" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;2: Boxplots showing differences in morphometric properties of the kelp <em>Ecklonia maxima</em> at two sites in False Bay.</figcaption></figure>
</div>
</div></div></div>
<p>The first thing we should notice from the figure above is that our different measurements are on very different scales. This makes comparing all of our data visually rather challenging. Even given this complication, one should readily be able to make out that the measurement values at Batsata Rock appear to be greater than at Boulders Beach. Within the framework of the scientific process, that is what we would call an ‘observation’, and is the first step towards formulating a hypothesis. The next step is to refine our observation into a hypothesis. By what measurement are the kelps greater at one site than the other?</p>
</section><section id="formulating-a-hypothesis" class="level2 page-columns page-full" data-number="7.3"><h2 data-number="7.3" class="anchored" data-anchor-id="formulating-a-hypothesis">
<span class="header-section-number">7.3</span> Formulating a hypothesis</h2>
<p>Looking at the figure above it appears that for almost all measurements of length, Batsata Rock far exceeds that of Boulders Beach however, the stipe masses between the two sites appear to be more similar. Let’s pull out just this variable and create a new boxplot (<a href="#fig-ecklonia2">Figure&nbsp;3</a>).</p>
<div class="cell page-columns page-full">
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># filter the data</span></span>
<span><span class="va">ecklonia_sub</span> <span class="op">&lt;-</span> <span class="va">ecklonia</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">variable</span> <span class="op">==</span> <span class="st">"stipe_mass"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># then create a new figure</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">ecklonia_sub</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">variable</span>, y <span class="op">=</span> <span class="va">value</span>, fill <span class="op">=</span> <span class="va">site</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_boxplot</span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"black"</span>, alpha <span class="op">=</span> <span class="fl">0.4</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">coord_flip</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>y <span class="op">=</span> <span class="st">"Stipe mass (kg)"</span>, x <span class="op">=</span> <span class="st">""</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>axis.text.y <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,</span>
<span>        axis.ticks.y <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div id="fig-ecklonia2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="07-t_tests_files/figure-html/fig-ecklonia2-1.svg" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;3: Boxplots showing the difference in stipe mass (kg) of the kelp <em>Ecklonia maxima</em> at two sites in False Bay.</figcaption></figure>
</div>
</div></div></div>
<p>Now we have a more interesting comparison at hand. The question I think of when I look at these data is “Are the stipe masses at Batsata Rock greater than at Boulders Beach?”. The hypothesis necessary to answer this question would look like this:</p>
<ul>
<li>
<em>H</em><sub>0</sub>: Stipe mass at Batsata Rock <strong>is not</strong> greater than at Boulders Beach.</li>
<li>
<em>H</em><sub>a</sub>: Stipe mass at Batsata Rock <strong>is</strong> greater than at Boulders Beach.</li>
</ul>
<p>Or more formally:</p>
<ul>
<li><span class="math inline">\(H_{0}: \bar{A} \leq \bar{B}\)</span></li>
<li>
<span class="math inline">\(H_{a}: \bar{A} &gt; \bar{B}\)</span>.</li>
</ul>
<p>Which test must we use for this hypothesis?</p>
</section><section id="choosing-a-test" class="level2" data-number="7.4"><h2 data-number="7.4" class="anchored" data-anchor-id="choosing-a-test">
<span class="header-section-number">7.4</span> Choosing a test</h2>
<p>Before we can pick the correct statistical test for our hypothesis, we need to be clear on what it is we are asking. Starting with the data being used is usually a good first step. As we may see in the above figure, we have two sample sets that we are comparing. Therefore, unsurprisingly, we will likely be using a <em>t</em>-test. But we’re not done yet. How is it that we are comparing these two sample sets? Remember from the examples above that there are multiple different ways to compare two sets of data. For our hypothesis we want to see if the stipe mass at Batsata Rock is <strong>greater than</strong> the stipe mass at Boulders Beach, not just that they are different. Because of this we will need a one-sided <em>t</em>-test. But wait, there’s more! We’ve zeroed in on which sort of test would be appropriate for our hypothesis, but before we run it we need to check our assumptions.</p>
</section><section id="checking-assumptions" class="level2" data-number="7.5"><h2 data-number="7.5" class="anchored" data-anchor-id="checking-assumptions">
<span class="header-section-number">7.5</span> Checking assumptions</h2>
<p>In case we forgot, here are the assumptions for a <em>t</em>-test:</p>
<ul>
<li>the dependent variable must be <strong>continuous</strong>,</li>
<li>the observations in the groups being compared are <strong>independent</strong> of each other,</li>
<li>the data are <strong>normally distributed</strong>, and</li>
<li>that the data are <strong>homoscedastic</strong>, and in particular, that there are no outliers.</li>
</ul>
<p>We know that the first two assumptions are met because our data are measurements of mass at two different sites. Before we can run our one-sided <em>t</em>-test we must meet the last two assumptions. Lucky us, we have a function tat will do that automagically.</p>
<p>Please refer to <a href="../../BCB744/basic_stats/06-assumptions.html">Chapter 6</a> to see what to do if the assumptions fail.</p>
<div class="cell">
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">ecklonia_sub</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">site</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">summarise</span><span class="op">(</span>stipe_mass_var <span class="op">=</span> <span class="fu">two_assum</span><span class="op">(</span><span class="va">value</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>            stipe_mass_norm <span class="op">=</span> <span class="fu">two_assum</span><span class="op">(</span><span class="va">value</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 3
  site           stipe_mass_var stipe_mass_norm
  &lt;chr&gt;                   &lt;dbl&gt;           &lt;dbl&gt;
1 Batsata Rock             2.00           0.813
2 Boulders Beach           2.64           0.527</code></pre>
</div>
</div>
<p>Lovely. The variances are equal and the data are normal. On to the next step.</p>
</section><section id="running-an-analysis" class="level2" data-number="7.6"><h2 data-number="7.6" class="anchored" data-anchor-id="running-an-analysis">
<span class="header-section-number">7.6</span> Running an analysis</h2>
<p>With our assumptions checked, we may now analyse our data. We’ll see below how to do this with both of the functions we’ve learned in this chapter for comparing means of two sample sets.</p>
<div class="cell">
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="va">value</span> <span class="op">~</span> <span class="va">site</span>, data <span class="op">=</span> <span class="va">ecklonia_sub</span>, var.equal <span class="op">=</span> <span class="cn">TRUE</span>, alternative <span class="op">=</span> <span class="st">"greater"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Two Sample t-test

data:  value by site
t = 1.8741, df = 24, p-value = 0.03657
alternative hypothesis: true difference in means between group Batsata Rock and group Boulders Beach is greater than 0
95 percent confidence interval:
 0.09752735        Inf
sample estimates:
  mean in group Batsata Rock mean in group Boulders Beach 
                    6.116154                     4.996154 </code></pre>
</div>
</div>
</section><section id="interpreting-the-results" class="level2" data-number="7.7"><h2 data-number="7.7" class="anchored" data-anchor-id="interpreting-the-results">
<span class="header-section-number">7.7</span> Interpreting the results</h2>
<p>We may reject the null hypothesis that the stipe mass of kelps at Batsata Rock is not greater than at Boulders Beach if our <em>t</em>-test returns a <em>p</em>-value <span class="math inline">\(\leq\)</span> 0.05. We must also pay attention to some of the other results from our <em>t</em>-test, specifically the <em>t</em>-value (<code>t</code>) and the degrees of freedom (<code>df</code>) as these are also needed when we are writing up our results. From all of the information above, we may accept the alternative hypothesis. But how do we write that up?</p>
</section><section id="drawing-conclusions" class="level2" data-number="7.8"><h2 data-number="7.8" class="anchored" data-anchor-id="drawing-conclusions">
<span class="header-section-number">7.8</span> Drawing conclusions</h2>
<p>There are many ways to present ones findings. Style, without <em>too much</em> flourish, is encouraged as long as certain necessary pieces of information are provided. The sentence below is a very minimalist example of how one may conclude this mini research project. A more thorough explanation would be desirable.</p>
<blockquote class="blockquote">
<p>The stipe mass (kg) of the kelp <em>Ecklonia maxima</em> was found to be significantly greater at Batsata Rock than at Boulders Beach (<em>p</em> = 0.03, <em>t</em> = 1.87, df = 24).</p>
</blockquote>
</section><section id="going-further" class="level2" data-number="7.9"><h2 data-number="7.9" class="anchored" data-anchor-id="going-further">
<span class="header-section-number">7.9</span> Going further</h2>
<p>But why though? As is often the case in life, and science is no exception, answers to our questions just create even more questions! Why would the mass of kelp stipes at one locations in the same body of water and only a kilometre or so apart be significantly different? It looks like we are going to need to design a new experiment… Masters thesis anyone?</p>
</section></section><section id="conclusion" class="level1" data-number="8"><h1 data-number="8">
<span class="header-section-number">8</span> Conclusion</h1>
<p><em>t</em>-tests are one of the first classes of inferential statistics students typically lerarn in a course on biostatistics. They are suitable for situations where you have two groups of data to compare and to establish if the difference between their means is zero. Lesson learned here are generalisable to more complex analysis.</p>


<!-- -->

</section><div id="quarto-appendix" class="default"><section class="quarto-appendix-contents"><h2 class="anchored quarto-appendix-heading">Reuse</h2><div id="quarto-reuse" class="quarto-appendix-contents"><div><a rel="license" href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</a></div></div></section><section class="quarto-appendix-contents"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{smit2021,
  author = {Smit, AJ},
  title = {7. *T*-Tests},
  date = {2021-01-01},
  url = {https://tangledbank.netlify.app/BCB744/basic_stats/07-t_tests.html},
  langid = {en}
}
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-smit2021" class="csl-entry quarto-appendix-citeas" role="listitem">
Smit A (2021) 7. *t*-tests. <a href="https://tangledbank.netlify.app/BCB744/basic_stats/07-t_tests.html">https://tangledbank.netlify.app/BCB744/basic_stats/07-t_tests.html.
</a>
</div></div></section></div></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><script src="https://utteranc.es/client.js" repo="ajsmit/tangled_bank" issue-term="pathname" theme="github-light" crossorigin="anonymous" async="">
</script><nav class="page-navigation column-body"><div class="nav-page nav-page-previous">
      <a href="../../BCB744/basic_stats/06-assumptions.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">6. Assumptions for parametric statistics</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../../BCB744/basic_stats/08-anova.html" class="pagination-link">
        <span class="nav-page-text">8. Analysis of Variance (ANOVA)</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb43" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> "2021-01-01"</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "7. *t*-tests"</span></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a><span class="an">subtitle:</span><span class="co"> "Comparing the means of two groups"</span></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggthemes)</span>
<span id="cb43-16"><a href="#cb43-16" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb43-17"><a href="#cb43-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-20"><a href="#cb43-20" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb43-21"><a href="#cb43-21" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb43-22"><a href="#cb43-22" aria-hidden="true" tabindex="-1"></a>two_assum <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb43-23"><a href="#cb43-23" aria-hidden="true" tabindex="-1"></a>  x_var <span class="ot">&lt;-</span> <span class="fu">var</span>(x)</span>
<span id="cb43-24"><a href="#cb43-24" aria-hidden="true" tabindex="-1"></a>  x_norm <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">shapiro.test</span>(x)[<span class="dv">2</span>])</span>
<span id="cb43-25"><a href="#cb43-25" aria-hidden="true" tabindex="-1"></a>  result <span class="ot">&lt;-</span> <span class="fu">c</span>(x_var, x_norm)</span>
<span id="cb43-26"><a href="#cb43-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(result)</span>
<span id="cb43-27"><a href="#cb43-27" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb43-28"><a href="#cb43-28" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb43-29"><a href="#cb43-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-30"><a href="#cb43-30" aria-hidden="true" tabindex="-1"></a>::: {.callout-note appearance="simple"}</span>
<span id="cb43-31"><a href="#cb43-31" aria-hidden="true" tabindex="-1"></a><span class="fu">## In this Chapter</span></span>
<span id="cb43-32"><a href="#cb43-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-33"><a href="#cb43-33" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>One-sample *t*-tests</span>
<span id="cb43-34"><a href="#cb43-34" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Two-sample s *t*-tests</span>
<span id="cb43-35"><a href="#cb43-35" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Paired *t*-tests</span>
<span id="cb43-36"><a href="#cb43-36" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Comparison of proportions</span>
<span id="cb43-37"><a href="#cb43-37" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb43-38"><a href="#cb43-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-39"><a href="#cb43-39" aria-hidden="true" tabindex="-1"></a>::: {.callout-note appearance="simple"}</span>
<span id="cb43-40"><a href="#cb43-40" aria-hidden="true" tabindex="-1"></a><span class="fu">## Cheatsheet</span></span>
<span id="cb43-41"><a href="#cb43-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-42"><a href="#cb43-42" aria-hidden="true" tabindex="-1"></a>Find here a <span class="co">[</span><span class="ot">Cheatsheet</span><span class="co">](../../docs/Methods_cheatsheet_v1.pdf)</span> on statistical methods.</span>
<span id="cb43-43"><a href="#cb43-43" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb43-44"><a href="#cb43-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-45"><a href="#cb43-45" aria-hidden="true" tabindex="-1"></a>::: {.callout-important appearance="simple"}</span>
<span id="cb43-46"><a href="#cb43-46" aria-hidden="true" tabindex="-1"></a><span class="fu">## Tasks to complete in this Chapter</span></span>
<span id="cb43-47"><a href="#cb43-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-48"><a href="#cb43-48" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Task E 1-6</span>
<span id="cb43-49"><a href="#cb43-49" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb43-50"><a href="#cb43-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-51"><a href="#cb43-51" aria-hidden="true" tabindex="-1"></a><span class="fu"># At a glance</span></span>
<span id="cb43-52"><a href="#cb43-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-53"><a href="#cb43-53" aria-hidden="true" tabindex="-1"></a>Student's *t*-tests are used to compare the *means of two groups* to determine if there is a significant difference between them. These are the expectations about your data:</span>
<span id="cb43-54"><a href="#cb43-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-55"><a href="#cb43-55" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Continuous dependant variable** The dependent variable should be measured on a *continuous scale* (e.g., height, mass, concentration).</span>
<span id="cb43-56"><a href="#cb43-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-57"><a href="#cb43-57" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Categorical independent variable** The independent variable has two independent groups being compared, so we expect a *factor variable with two groups* (e.g. fertiliser levels of high and low, vegetation types of grassland and forest, herbivory levels of moderate and intense). The observations within each group should not affect the other group's observations. There are two types of *t*-tests depending on whether the samples are independent or paired (related):</span>
<span id="cb43-58"><a href="#cb43-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-59"><a href="#cb43-59" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>**Independent sample *t*-test** Appropriate when the groups consist of different individuals or observations.</span>
<span id="cb43-60"><a href="#cb43-60" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>**Paired sample *t*-test**: Appropriate when the groups are related, such as before-and-after measurements or matched pairs of individuals.</span>
<span id="cb43-61"><a href="#cb43-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-62"><a href="#cb43-62" aria-hidden="true" tabindex="-1"></a>Other assumptions to be aware of with regards to the dependent variable:</span>
<span id="cb43-63"><a href="#cb43-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-64"><a href="#cb43-64" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Normal distribution** The data in each group should follow a normal distribution or be approximately normally distributed for you to use the Student's *t*-test, `t.test()`. If the assumption of normality is not met, as, for example, determined with the `shapiro.test()`, you may consider using a non-parametric alternative such as the Wilcoxon signed-rank test, `wilcox.test()`, as a replacement for a one-sample *t*-test or the Mann-Whitney test, also with `wilcox.test()` (but note how to set the function arguments), in stead of a two-sample *t*-test. This assumption can be relaxed for large sample sizes due to the <span class="co">[</span><span class="ot">Central Limit Theorem</span><span class="co">](04-distributions.qmd#sec-normal)</span>.</span>
<span id="cb43-65"><a href="#cb43-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-66"><a href="#cb43-66" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Homoscedasticity** The variances of the two groups should be approximately equal. If this assumption is not met, you can use Welch's *t*-test in stead of Student's *t*-test, as the former does not require variances to be equal. The default setting for `t.test()` is actually Welch's *t*-test; to perform a Student's *t*-test (one- or two-sample *t*-test) you need to set the argument <span class="in">`var.equal = TRUE`</span>.</span>
<span id="cb43-67"><a href="#cb43-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-68"><a href="#cb43-68" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Random sampling** The data should be obtained through random sampling or random assignment, ensuring that each observation has an equal chance of being included in the sample.</span>
<span id="cb43-69"><a href="#cb43-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-70"><a href="#cb43-70" aria-hidden="true" tabindex="-1"></a><span class="fu"># Introduction to *t*-tests</span></span>
<span id="cb43-71"><a href="#cb43-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-72"><a href="#cb43-72" aria-hidden="true" tabindex="-1"></a>The simplest experiment that makes any scientific sense is one where data are collected to represent two groups---maybe a treatment compared to a control. For example, "does adding manure to some plants have a measurable effect on their growth compared to the situation where nothing was added that might affect the plants' growth?" To answer this very basic question one often uses a ***t*-test**. </span>
<span id="cb43-73"><a href="#cb43-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-74"><a href="#cb43-74" aria-hidden="true" tabindex="-1"></a>The most commonly used *t*-test is **Student's *t*-test**, a statistical hypothesis test used to determine whether two samples of data are significantly different from each other. It was introduced by William Gosset, who wrote under the pseudonym 'Student,' in 1908. This is a parametric test, and as already indicated, it assumes the data are normally distributed and that the variances of the two samples being compared are equal.</span>
<span id="cb43-75"><a href="#cb43-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-76"><a href="#cb43-76" aria-hidden="true" tabindex="-1"></a>Now it becomes interesting. There are several flavours of *t*-tests, depending on the nature of our samples and the type of question being asked, but all of them involve comparing two samples. Specifically, *the comparison involves the sample means*, and as such, they test whether or not the central tendencies of two samples differ. Here are the variations:</span>
<span id="cb43-77"><a href="#cb43-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-78"><a href="#cb43-78" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**One-sample *t*-tests:** only one sample set of data that we wish to compare against a known population mean:</span>
<span id="cb43-79"><a href="#cb43-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-80"><a href="#cb43-80" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>one-sided one-sample *t*-tests</span>
<span id="cb43-81"><a href="#cb43-81" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>two-sided one-sample *t*-tests</span>
<span id="cb43-82"><a href="#cb43-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-83"><a href="#cb43-83" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Two-sample (or independent sample) *t*-tests:** the means of two groups are compared against each other:</span>
<span id="cb43-84"><a href="#cb43-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-85"><a href="#cb43-85" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>one-sided two-sample *t*-tests</span>
<span id="cb43-86"><a href="#cb43-86" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>two-sided two-sample *t*-tests</span>
<span id="cb43-87"><a href="#cb43-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-88"><a href="#cb43-88" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Paired sample *t*-tests:** two samples that are 'matched' or, as the name indicates, *paired*, i.e. they are not independent of one another:</span>
<span id="cb43-89"><a href="#cb43-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-90"><a href="#cb43-90" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>one-sided</span>
<span id="cb43-91"><a href="#cb43-91" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>two-sided</span>
<span id="cb43-92"><a href="#cb43-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-93"><a href="#cb43-93" aria-hidden="true" tabindex="-1"></a>Let's go into detail into each of these variations of *t*-tests.</span>
<span id="cb43-94"><a href="#cb43-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-95"><a href="#cb43-95" aria-hidden="true" tabindex="-1"></a><span class="fu"># One-sample *t*-tests</span></span>
<span id="cb43-96"><a href="#cb43-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-97"><a href="#cb43-97" aria-hidden="true" tabindex="-1"></a><span class="fu">## Two-sided one-sample *t*-test</span></span>
<span id="cb43-98"><a href="#cb43-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-99"><a href="#cb43-99" aria-hidden="true" tabindex="-1"></a>::: {.callout-note}</span>
<span id="cb43-100"><a href="#cb43-100" aria-hidden="true" tabindex="-1"></a><span class="fu">## Hypothesis for two-sided one-sample *t*-test</span></span>
<span id="cb43-101"><a href="#cb43-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-102"><a href="#cb43-102" aria-hidden="true" tabindex="-1"></a>$H_{0}: \bar{x} = \mu_{0}$ and $H_{a}: \bar{x} \ne \mu_{0}$</span>
<span id="cb43-103"><a href="#cb43-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-104"><a href="#cb43-104" aria-hidden="true" tabindex="-1"></a>This is the same as:</span>
<span id="cb43-105"><a href="#cb43-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-106"><a href="#cb43-106" aria-hidden="true" tabindex="-1"></a>$H_{0}: \bar{x} - \mu_{0} = 0$ and $H_{a}: \bar{x} - \mu_{0} \ne 0$</span>
<span id="cb43-107"><a href="#cb43-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-108"><a href="#cb43-108" aria-hidden="true" tabindex="-1"></a>Here $\bar{x}$ is the population mean and $\mu_{0}$ the hypothesised mean to which $\bar{x}$ is being compared. In this example we have a two-sided one-sample *t*-test.</span>
<span id="cb43-109"><a href="#cb43-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-110"><a href="#cb43-110" aria-hidden="true" tabindex="-1"></a>As stated above, $H_{0}$ does not make a distinction between whether it expects $\bar{x}$ to be $\lt$ or $\gt$ $\mu_{0}$.</span>
<span id="cb43-111"><a href="#cb43-111" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb43-112"><a href="#cb43-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-113"><a href="#cb43-113" aria-hidden="true" tabindex="-1"></a>Generally when we use a *t*-test it will be a two-sample *t*-test (see below). Occasionally, however, we may have only one set of observations (random samples taken to represent a population) whose mean, $\bar{x}$, we wish to compare against a known population mean, $\mu_{0}$, which had been established *a priori* (@eq-onesample). In R's `t.test()` function, the default setting is for a **two-sided one-sample *t*-test**---that is, *we don't care if our* $H_{a}$ *is significantly less than* $\mu_{0}$ *or if it is significantly greater than* $\mu_{0}$.</span>
<span id="cb43-114"><a href="#cb43-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-115"><a href="#cb43-115" aria-hidden="true" tabindex="-1"></a>::: {.column-margin}</span>
<span id="cb43-116"><a href="#cb43-116" aria-hidden="true" tabindex="-1"></a>**The one-sample *t*-test:**</span>
<span id="cb43-117"><a href="#cb43-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-118"><a href="#cb43-118" aria-hidden="true" tabindex="-1"></a>$$t = \frac{\overline{x} - \mu}{s / \sqrt{n}}$$ {#eq-onesample}</span>
<span id="cb43-119"><a href="#cb43-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-120"><a href="#cb43-120" aria-hidden="true" tabindex="-1"></a>where $t$ is the calculated $t$-value, $\overline{x}$ is the sample mean, $\mu$ is the hypothesised population mean, $s$ is the sample standard deviation, and $n$ the sample size.</span>
<span id="cb43-121"><a href="#cb43-121" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb43-122"><a href="#cb43-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-125"><a href="#cb43-125" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb43-126"><a href="#cb43-126" aria-hidden="true" tabindex="-1"></a><span class="co"># create a single sample of random normal data</span></span>
<span id="cb43-127"><a href="#cb43-127" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">666</span>)</span>
<span id="cb43-128"><a href="#cb43-128" aria-hidden="true" tabindex="-1"></a>r_one <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">dat =</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">20</span>, <span class="at">mean =</span> <span class="dv">20</span>, <span class="at">sd =</span> <span class="dv">5</span>),</span>
<span id="cb43-129"><a href="#cb43-129" aria-hidden="true" tabindex="-1"></a>                    <span class="at">sample =</span> <span class="st">"A"</span>)</span>
<span id="cb43-130"><a href="#cb43-130" aria-hidden="true" tabindex="-1"></a><span class="in">```</span> </span>
<span id="cb43-131"><a href="#cb43-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-132"><a href="#cb43-132" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- ```{r} --&gt;</span></span>
<span id="cb43-133"><a href="#cb43-133" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- ## check normality --&gt;</span></span>
<span id="cb43-134"><a href="#cb43-134" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- shapiro.test(r_one$dat) --&gt;</span></span>
<span id="cb43-135"><a href="#cb43-135" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- ``` --&gt;</span></span>
<span id="cb43-136"><a href="#cb43-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-139"><a href="#cb43-139" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb43-140"><a href="#cb43-140" aria-hidden="true" tabindex="-1"></a><span class="co"># compare random data against a population mean of 20</span></span>
<span id="cb43-141"><a href="#cb43-141" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(r_one<span class="sc">$</span>dat, <span class="at">mu =</span> <span class="dv">20</span>)</span>
<span id="cb43-142"><a href="#cb43-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-143"><a href="#cb43-143" aria-hidden="true" tabindex="-1"></a><span class="co"># compare random data against a population mean of 30</span></span>
<span id="cb43-144"><a href="#cb43-144" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(r_one<span class="sc">$</span>dat, <span class="at">mu =</span> <span class="dv">30</span>)</span>
<span id="cb43-145"><a href="#cb43-145" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb43-146"><a href="#cb43-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-147"><a href="#cb43-147" aria-hidden="true" tabindex="-1"></a>What do the results of these two different tests show? Let's visualise these data to get a better understanding (@fig-boxplot1).</span>
<span id="cb43-148"><a href="#cb43-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-151"><a href="#cb43-151" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb43-152"><a href="#cb43-152" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Boxplot of random normal data with. A hypothetical population mean of 20 is shown as a blue line, with the red line showing a mean of 30."</span></span>
<span id="cb43-153"><a href="#cb43-153" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-boxplot1</span></span>
<span id="cb43-154"><a href="#cb43-154" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 1</span></span>
<span id="cb43-155"><a href="#cb43-155" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: margin</span></span>
<span id="cb43-156"><a href="#cb43-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-157"><a href="#cb43-157" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> r_one, <span class="fu">aes</span>(<span class="at">y =</span> dat, <span class="at">x =</span> sample)) <span class="sc">+</span></span>
<span id="cb43-158"><a href="#cb43-158" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">fill =</span> <span class="st">"indianred"</span>, <span class="at">notch =</span> <span class="cn">TRUE</span>,</span>
<span id="cb43-159"><a href="#cb43-159" aria-hidden="true" tabindex="-1"></a>               <span class="at">alpha =</span> <span class="fl">0.3</span>, <span class="at">colour =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb43-160"><a href="#cb43-160" aria-hidden="true" tabindex="-1"></a>  <span class="co"># population  mean (mu) = 20</span></span>
<span id="cb43-161"><a href="#cb43-161" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">20</span>, <span class="at">colour =</span> <span class="st">"dodgerblue2"</span>, </span>
<span id="cb43-162"><a href="#cb43-162" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="fl">0.9</span>) <span class="sc">+</span></span>
<span id="cb43-163"><a href="#cb43-163" aria-hidden="true" tabindex="-1"></a>  <span class="co"># population  mean (mu) = 30</span></span>
<span id="cb43-164"><a href="#cb43-164" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">30</span>, <span class="at">colour =</span> <span class="st">"indianred2"</span>, </span>
<span id="cb43-165"><a href="#cb43-165" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="fl">0.9</span>) <span class="sc">+</span></span>
<span id="cb43-166"><a href="#cb43-166" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Value"</span>, <span class="at">x =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb43-167"><a href="#cb43-167" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb43-168"><a href="#cb43-168" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_pubclean</span>()</span>
<span id="cb43-169"><a href="#cb43-169" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb43-170"><a href="#cb43-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-171"><a href="#cb43-171" aria-hidden="true" tabindex="-1"></a>The boxplot shows the distribution of our random data against two potential population means. Does this help now to illustrate the results of our one-sample *t*-tests?</span>
<span id="cb43-172"><a href="#cb43-172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-173"><a href="#cb43-173" aria-hidden="true" tabindex="-1"></a><span class="fu">## One-sided one-sample *t*-tests</span></span>
<span id="cb43-174"><a href="#cb43-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-175"><a href="#cb43-175" aria-hidden="true" tabindex="-1"></a>::: {.callout-note}</span>
<span id="cb43-176"><a href="#cb43-176" aria-hidden="true" tabindex="-1"></a><span class="fu">## Hypothesis for one-sided one-sample *t*-test</span></span>
<span id="cb43-177"><a href="#cb43-177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-178"><a href="#cb43-178" aria-hidden="true" tabindex="-1"></a>For example, when we are concerned that our sample mean, $\bar{x}$, should be less than the *a priori* established value, $\mu_{0}$:</span>
<span id="cb43-179"><a href="#cb43-179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-180"><a href="#cb43-180" aria-hidden="true" tabindex="-1"></a>$H_{0}: \bar{x} \ge \mu_{0}$ and $H_{a}: \bar{x} \lt \mu_{0}$</span>
<span id="cb43-181"><a href="#cb43-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-182"><a href="#cb43-182" aria-hidden="true" tabindex="-1"></a>Only one of the two options is shown.</span>
<span id="cb43-183"><a href="#cb43-183" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb43-184"><a href="#cb43-184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-185"><a href="#cb43-185" aria-hidden="true" tabindex="-1"></a>Remember that a normal distribution has two tails. As indicated already, when we are testing for significance we are generally looking for a result that sits in the far end of either of these tails. Occasionally, however, we may want to know if the result is specifically in one of the two tails. Explicitly the leading or trailing tail. For example, is the mean value of our sample population, $\bar{x}$, *significantly greater than the value* $\mu_{0}$? *Or, is* $\bar{x}$ *less than the value* $\mu_{0}$? This *t*-test is called a **one-sided one-sample *t*-tests**. To specify this in R we must add an argument as seen below:</span>
<span id="cb43-186"><a href="#cb43-186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-189"><a href="#cb43-189" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb43-190"><a href="#cb43-190" aria-hidden="true" tabindex="-1"></a><span class="co"># check against the trailing tail</span></span>
<span id="cb43-191"><a href="#cb43-191" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(r_one<span class="sc">$</span>dat, <span class="at">mu =</span> <span class="dv">30</span>, <span class="at">alternative =</span> <span class="st">"less"</span>)</span>
<span id="cb43-192"><a href="#cb43-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-193"><a href="#cb43-193" aria-hidden="true" tabindex="-1"></a><span class="co"># check against the leading tail</span></span>
<span id="cb43-194"><a href="#cb43-194" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(r_one<span class="sc">$</span>dat, <span class="at">mu =</span> <span class="dv">30</span>, <span class="at">alternative =</span> <span class="st">"greater"</span>)</span>
<span id="cb43-195"><a href="#cb43-195" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb43-196"><a href="#cb43-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-197"><a href="#cb43-197" aria-hidden="true" tabindex="-1"></a>Are these the results we would have expected? Why does the second test not return a significant result?</span>
<span id="cb43-198"><a href="#cb43-198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-199"><a href="#cb43-199" aria-hidden="true" tabindex="-1"></a>::: callout-important</span>
<span id="cb43-200"><a href="#cb43-200" aria-hidden="true" tabindex="-1"></a><span class="fu">## Task E</span></span>
<span id="cb43-201"><a href="#cb43-201" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Create a visualisation to graphically demonstrate the outcome of this *t*-test.</span>
<span id="cb43-202"><a href="#cb43-202" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb43-203"><a href="#cb43-203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-204"><a href="#cb43-204" aria-hidden="true" tabindex="-1"></a><span class="fu"># Two-sample *t*-tests</span></span>
<span id="cb43-205"><a href="#cb43-205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-206"><a href="#cb43-206" aria-hidden="true" tabindex="-1"></a><span class="fu">## Two-sided two-sample *t*-test</span></span>
<span id="cb43-207"><a href="#cb43-207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-208"><a href="#cb43-208" aria-hidden="true" tabindex="-1"></a>::: {.callout-note}</span>
<span id="cb43-209"><a href="#cb43-209" aria-hidden="true" tabindex="-1"></a><span class="fu">## Hypothesis for two-sided two-sample *t*-test</span></span>
<span id="cb43-210"><a href="#cb43-210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-211"><a href="#cb43-211" aria-hidden="true" tabindex="-1"></a>$H_{0}: \bar{A} = \bar{B}$ and $H_{a}: \bar{A} \ne \bar{B}$</span>
<span id="cb43-212"><a href="#cb43-212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-213"><a href="#cb43-213" aria-hidden="true" tabindex="-1"></a>where $\bar{A}$ is the population mean of the first sample and $\bar{B}$ the population mean of the second sample. In this example we have a two-sided two-sample *t*-test, which is the default in R's <span class="in">`t.test()`</span> function.</span>
<span id="cb43-214"><a href="#cb43-214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-215"><a href="#cb43-215" aria-hidden="true" tabindex="-1"></a>As stated above, $H_{0}$ does not make a distinction between whether it expects the difference between $\bar{A}$ and $\bar{B}$ to be greater than or less than 0.</span>
<span id="cb43-216"><a href="#cb43-216" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb43-217"><a href="#cb43-217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-218"><a href="#cb43-218" aria-hidden="true" tabindex="-1"></a>A two-sample *t*-test is used when we have samples from two different (independent) populations whose means, $\bar{A}$ and $\bar{B}$, we would like to compare against one another. Sometimes it is called an independent sample *t*-test. Specifically, it tests whether the *difference between the means of two samples is zero*. Note that again *we make no distinction between whether it is more interesting that the difference is greater than zero or less zero*---as long as there is a difference between $\bar{A}$ and $\bar{B}$. This test is called a **two-sided two sample *t*-test** and it is the most common use of a *t*-test.</span>
<span id="cb43-219"><a href="#cb43-219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-220"><a href="#cb43-220" aria-hidden="true" tabindex="-1"></a>There are two varieties of *t*-tests. In the case of samples whose variances do not differ, we perform a **Student's *t*-test**. @eq-tstat shows how to calculate the *t*-statistic for Student's *t*-test. The other case is if we have unequal variances in $\bar{A}$ and $\bar{B}$ (established with the Levene's test for equality of variances; see [Chapter 6](06-assumptions.qmd#sec-homogeneity)); here, we perform **Welch's *t*-test** as written in @eq-welch. Welch's *t*-test is the default in R's <span class="in">`t.test()`</span> function.</span>
<span id="cb43-221"><a href="#cb43-221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-222"><a href="#cb43-222" aria-hidden="true" tabindex="-1"></a>::: {.column-margin}</span>
<span id="cb43-223"><a href="#cb43-223" aria-hidden="true" tabindex="-1"></a>**Student's *t*-test:**</span>
<span id="cb43-224"><a href="#cb43-224" aria-hidden="true" tabindex="-1"></a>$$t=\frac{\bar{A}-\bar{B}}{\sqrt{\frac{S^{2}}{n}+\frac{S^{2}}{m}}}$$ {#eq-tstat}</span>
<span id="cb43-225"><a href="#cb43-225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-226"><a href="#cb43-226" aria-hidden="true" tabindex="-1"></a>$\bar{A}$ and $\bar{B}$ are the means for groups $A$ and $B$, respectively; $n$ and $m$ are the sample sizes of the two sets of samples, respectively; and $S^{2}$ is the pooled variance, which is calculated as per @eq-pooledvar:</span>
<span id="cb43-227"><a href="#cb43-227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-228"><a href="#cb43-228" aria-hidden="true" tabindex="-1"></a>$$S^{2}=\frac{(n-1)S_{A}^{2}+(m-1)S_{B}^{2} }{n+m-2}$$ {#eq-pooledvar}</span>
<span id="cb43-229"><a href="#cb43-229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-230"><a href="#cb43-230" aria-hidden="true" tabindex="-1"></a>The degrees of freedom, *d.f.*, in the equation for the shared variance is $n_{A}+m_{B}-2$.</span>
<span id="cb43-231"><a href="#cb43-231" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb43-232"><a href="#cb43-232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-233"><a href="#cb43-233" aria-hidden="true" tabindex="-1"></a>::: {.column-margin}</span>
<span id="cb43-234"><a href="#cb43-234" aria-hidden="true" tabindex="-1"></a>**Welch's *t*-test:**</span>
<span id="cb43-235"><a href="#cb43-235" aria-hidden="true" tabindex="-1"></a>$$t=\frac{\bar{A}-\bar{B}}{\sqrt{\frac{S^{2}_{A}}{n}+\frac{S^{2}_{B}}{m}}}$$ {#eq-welch}</span>
<span id="cb43-236"><a href="#cb43-236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-237"><a href="#cb43-237" aria-hidden="true" tabindex="-1"></a>Here, $S_{A}$ and $S_{B}$ are the variances of groups $A$ and $B$, respectively (see Section X). The *d.f.* to use with Welch's *t*-test is obtained using the Welch--Satterthwaite equation (@eq-satterthwaite):</span>
<span id="cb43-238"><a href="#cb43-238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-239"><a href="#cb43-239" aria-hidden="true" tabindex="-1"></a>$$d.f. = \frac{\left( \frac{S^{2}_{A}}{n}+\frac{S^{2}_{B}}{m} \right)^{2}}{\left( \frac{S^{4}_{A}}{n-1} + \frac{S^{4}_{B}}{m-1} \right)}$$ {#eq-satterthwaite}</span>
<span id="cb43-240"><a href="#cb43-240" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb43-241"><a href="#cb43-241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-242"><a href="#cb43-242" aria-hidden="true" tabindex="-1"></a>What do we do with this *t*-statistic? In the olden days we had to calculate the *t*-statistics and the *d.f.* by hand. These two values, the *d.f.* and *t*-value had to be read off a table of pre-calculated *t*-values, probabilities and degrees of freedom [as in here](https://home.ubalt.edu/ntsbarsh/Business-stat/StatistialTables.pdf). Luckily, the *t*-test function nowadays does this all automagically. But if you are feeling nostalgic over times that you have sadly never experienced, please calculate the *t*-statistic and the *d.f.* yourself and give the table a go. In fact, an excessive later in this Chapter will give you an opportunity to do so.</span>
<span id="cb43-243"><a href="#cb43-243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-244"><a href="#cb43-244" aria-hidden="true" tabindex="-1"></a>Back to the present day and the wonders of modern technology. Let's generate some new random normal data and test to see if the data belonging to the two groups differ significantly from one-another. First, we apply the *t*-test function as usual:</span>
<span id="cb43-245"><a href="#cb43-245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-248"><a href="#cb43-248" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb43-249"><a href="#cb43-249" aria-hidden="true" tabindex="-1"></a><span class="co"># random normal data</span></span>
<span id="cb43-250"><a href="#cb43-250" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">666</span>)</span>
<span id="cb43-251"><a href="#cb43-251" aria-hidden="true" tabindex="-1"></a>r_two <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">dat =</span> <span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">20</span>, <span class="at">mean =</span> <span class="dv">4</span>, <span class="at">sd =</span> <span class="dv">1</span>),</span>
<span id="cb43-252"><a href="#cb43-252" aria-hidden="true" tabindex="-1"></a>                            <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">20</span>, <span class="at">mean =</span> <span class="dv">5</span>, <span class="at">sd =</span> <span class="dv">1</span>)),</span>
<span id="cb43-253"><a href="#cb43-253" aria-hidden="true" tabindex="-1"></a>                    <span class="at">sample =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"A"</span>, <span class="dv">20</span>), <span class="fu">rep</span>(<span class="st">"B"</span>, <span class="dv">20</span>)))</span>
<span id="cb43-254"><a href="#cb43-254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-255"><a href="#cb43-255" aria-hidden="true" tabindex="-1"></a><span class="co"># perform t-test</span></span>
<span id="cb43-256"><a href="#cb43-256" aria-hidden="true" tabindex="-1"></a><span class="co"># note how we set the `var.equal` argument to TRUE because we know </span></span>
<span id="cb43-257"><a href="#cb43-257" aria-hidden="true" tabindex="-1"></a><span class="co"># our data has the same SD (they are simulated as such!)</span></span>
<span id="cb43-258"><a href="#cb43-258" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(dat <span class="sc">~</span> sample, <span class="at">data =</span> r_two, <span class="at">var.equal =</span> <span class="cn">TRUE</span>)</span>
<span id="cb43-259"><a href="#cb43-259" aria-hidden="true" tabindex="-1"></a><span class="co"># if the variances are not equal, simply set `var.equal` to false</span></span>
<span id="cb43-260"><a href="#cb43-260" aria-hidden="true" tabindex="-1"></a><span class="co"># and a Welch's t-test will be performed</span></span>
<span id="cb43-261"><a href="#cb43-261" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb43-262"><a href="#cb43-262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-263"><a href="#cb43-263" aria-hidden="true" tabindex="-1"></a>The first argument we see in <span class="in">`t.test()`</span> is <span class="in">`dat ~ sample`</span>. Usually in R when we see a <span class="in">`~`</span> (tilde) we are creating what is known as a formula. A formula tells R how it should look for interactions between data and factors. For example <span class="in">`Y ~ X`</span> reads: $Y$ as a function of $X$. In our code above we see <span class="in">`dat ~ sample`</span>. This means we are telling R that the *t*-test we want it to perform is when the `dat` column is a function of the `sample` column. In plain English we are dividing up the `dat` column into the two different samples we have, and then running a *t*-test on these samples. Another way of stating this is that the value of <span class="in">`dat`</span> depends on the grouping it belong to (<span class="in">`A`</span> or <span class="in">`B`</span>). We will see this same formula notation cropping up later under ANOVAs, linear models, etc.</span>
<span id="cb43-264"><a href="#cb43-264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-265"><a href="#cb43-265" aria-hidden="true" tabindex="-1"></a><span class="in">```{r t-test-plot3, echo=FALSE, include=FALSE, eval=FALSE}</span></span>
<span id="cb43-266"><a href="#cb43-266" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(beeswarm)</span>
<span id="cb43-267"><a href="#cb43-267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-268"><a href="#cb43-268" aria-hidden="true" tabindex="-1"></a><span class="co"># Create random data</span></span>
<span id="cb43-269"><a href="#cb43-269" aria-hidden="true" tabindex="-1"></a>r_norm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">dat =</span> <span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">20</span>, <span class="at">mean =</span> <span class="dv">4</span>, <span class="at">sd =</span> <span class="dv">1</span>),</span>
<span id="cb43-270"><a href="#cb43-270" aria-hidden="true" tabindex="-1"></a>                            <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">20</span>, <span class="at">mean =</span> <span class="dv">5</span>, <span class="at">sd =</span> <span class="dv">1</span>)),</span>
<span id="cb43-271"><a href="#cb43-271" aria-hidden="true" tabindex="-1"></a>                    <span class="at">sample =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"A"</span>, <span class="dv">20</span>), <span class="fu">rep</span>(<span class="st">"B"</span>, <span class="dv">20</span>)))</span>
<span id="cb43-272"><a href="#cb43-272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-273"><a href="#cb43-273" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a swarm</span></span>
<span id="cb43-274"><a href="#cb43-274" aria-hidden="true" tabindex="-1"></a>r_norm_swarm <span class="ot">&lt;-</span> <span class="fu">beeswarm</span>(dat <span class="sc">~</span> sample, </span>
<span id="cb43-275"><a href="#cb43-275" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> r_norm, <span class="at">method =</span> <span class="st">'swarm'</span>, </span>
<span id="cb43-276"><a href="#cb43-276" aria-hidden="true" tabindex="-1"></a>            <span class="at">do.plot =</span> F, <span class="at">pwcol =</span> sample)[, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">6</span>)]</span>
<span id="cb43-277"><a href="#cb43-277" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(r_norm_swarm) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"x"</span>, <span class="st">"y"</span>, <span class="st">"colour"</span>, <span class="st">"sample"</span>) </span>
<span id="cb43-278"><a href="#cb43-278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-279"><a href="#cb43-279" aria-hidden="true" tabindex="-1"></a>beeswarm.plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(r_norm_swarm, <span class="fu">aes</span>(x, y))</span>
<span id="cb43-280"><a href="#cb43-280" aria-hidden="true" tabindex="-1"></a>beeswarm.plot2 <span class="ot">&lt;-</span> beeswarm.plot <span class="sc">+</span> <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(x, y,</span>
<span id="cb43-281"><a href="#cb43-281" aria-hidden="true" tabindex="-1"></a>  <span class="at">group =</span> <span class="fu">round</span>(x, <span class="dv">1</span>)), <span class="at">outlier.shape =</span> <span class="cn">NA</span>)</span>
<span id="cb43-282"><a href="#cb43-282" aria-hidden="true" tabindex="-1"></a>beeswarm.plot3 <span class="ot">&lt;-</span> beeswarm.plot2 <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb43-283"><a href="#cb43-283" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>), </span>
<span id="cb43-284"><a href="#cb43-284" aria-hidden="true" tabindex="-1"></a>         <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Sample A"</span>, <span class="st">"SampleB"</span>), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.5</span>))</span>
<span id="cb43-285"><a href="#cb43-285" aria-hidden="true" tabindex="-1"></a>beeswarm.plot3</span>
<span id="cb43-286"><a href="#cb43-286" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb43-287"><a href="#cb43-287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-288"><a href="#cb43-288" aria-hidden="true" tabindex="-1"></a>::: callout-important</span>
<span id="cb43-289"><a href="#cb43-289" aria-hidden="true" tabindex="-1"></a><span class="fu">## Task E</span></span>
<span id="cb43-290"><a href="#cb43-290" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Create a visualisation to graphically demonstrate the outcome of this *t*-test.</span>
<span id="cb43-291"><a href="#cb43-291" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb43-292"><a href="#cb43-292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-293"><a href="#cb43-293" aria-hidden="true" tabindex="-1"></a><span class="fu">## One-sided two-sample *t*-test</span></span>
<span id="cb43-294"><a href="#cb43-294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-295"><a href="#cb43-295" aria-hidden="true" tabindex="-1"></a>::: {.callout-note}</span>
<span id="cb43-296"><a href="#cb43-296" aria-hidden="true" tabindex="-1"></a><span class="fu">## Hypothesis for one-sided two-sample *t*-test</span></span>
<span id="cb43-297"><a href="#cb43-297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-298"><a href="#cb43-298" aria-hidden="true" tabindex="-1"></a>For example, when we are concerned that the sample mean of the first population, $\bar{A}$, should be greater than that of the second, $\bar{B}$:</span>
<span id="cb43-299"><a href="#cb43-299" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-300"><a href="#cb43-300" aria-hidden="true" tabindex="-1"></a>$H_{0}: \bar{A} \le \bar{B}$ and $H_{a}: \bar{A} \gt \bar{B}$</span>
<span id="cb43-301"><a href="#cb43-301" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-302"><a href="#cb43-302" aria-hidden="true" tabindex="-1"></a>Only one of the two options is shown.</span>
<span id="cb43-303"><a href="#cb43-303" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb43-304"><a href="#cb43-304" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-305"><a href="#cb43-305" aria-hidden="true" tabindex="-1"></a>Just as with the one-sample *t*-tests above, we may also specify which tail of the distribution we are interested in when we compare the means of our two samples. This is a **one-sided two-sample *t*-test**, and here too we have the Student's *t*-test and Welch's *t*-test varieties. We do so by providing the same arguments as previously:</span>
<span id="cb43-306"><a href="#cb43-306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-309"><a href="#cb43-309" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb43-310"><a href="#cb43-310" aria-hidden="true" tabindex="-1"></a><span class="co"># is the mean of sample B smaller than that of sample A?</span></span>
<span id="cb43-311"><a href="#cb43-311" aria-hidden="true" tabindex="-1"></a><span class="fu">compare_means</span>(dat <span class="sc">~</span> sample, <span class="at">data =</span> r_two, <span class="at">method =</span> <span class="st">"t.test"</span>, <span class="at">var.equal =</span> <span class="cn">TRUE</span>, <span class="at">alternative =</span> <span class="st">"less"</span>)</span>
<span id="cb43-312"><a href="#cb43-312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-313"><a href="#cb43-313" aria-hidden="true" tabindex="-1"></a><span class="co"># is the mean of sample B greater than that of sample A?</span></span>
<span id="cb43-314"><a href="#cb43-314" aria-hidden="true" tabindex="-1"></a><span class="fu">compare_means</span>(dat <span class="sc">~</span> sample, <span class="at">data =</span> r_two, <span class="at">method =</span> <span class="st">"t.test"</span>, <span class="at">var.equal =</span> <span class="cn">TRUE</span>, <span class="at">alternative =</span> <span class="st">"greater"</span>)</span>
<span id="cb43-315"><a href="#cb43-315" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb43-316"><a href="#cb43-316" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-317"><a href="#cb43-317" aria-hidden="true" tabindex="-1"></a>What do these results show? Is this surprising?</span>
<span id="cb43-318"><a href="#cb43-318" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-319"><a href="#cb43-319" aria-hidden="true" tabindex="-1"></a>::: callout-important</span>
<span id="cb43-320"><a href="#cb43-320" aria-hidden="true" tabindex="-1"></a><span class="fu">## Task E</span></span>
<span id="cb43-321"><a href="#cb43-321" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>Repeat the above analyses using the old-fashioned <span class="in">`t.test()`</span> function.</span>
<span id="cb43-322"><a href="#cb43-322" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>Repeat the above analysis using the even more old-fashioned @eq-tstat. Show the code and talk us through the step you followed to read the *p*-values off the table of *t*-statistics.</span>
<span id="cb43-323"><a href="#cb43-323" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb43-324"><a href="#cb43-324" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-325"><a href="#cb43-325" aria-hidden="true" tabindex="-1"></a><span class="fu"># Paired *t*-tests</span></span>
<span id="cb43-326"><a href="#cb43-326" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-327"><a href="#cb43-327" aria-hidden="true" tabindex="-1"></a>::: {.callout-note}</span>
<span id="cb43-328"><a href="#cb43-328" aria-hidden="true" tabindex="-1"></a><span class="fu">## Hypothesis for two-sided paired *t*-test</span></span>
<span id="cb43-329"><a href="#cb43-329" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-330"><a href="#cb43-330" aria-hidden="true" tabindex="-1"></a>$H_{0}: \bar{d} = 0$ and $H_{a}: \bar{d} \ne 0$</span>
<span id="cb43-331"><a href="#cb43-331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-332"><a href="#cb43-332" aria-hidden="true" tabindex="-1"></a>where $\bar{d}$ is the mean population difference based on the matched pairs.</span>
<span id="cb43-333"><a href="#cb43-333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-334"><a href="#cb43-334" aria-hidden="true" tabindex="-1"></a>Again, here $H_{0}$ does not consider if differences are greater than or less than 0---a difference in either direction is significant. One-sided versions of the hypothesis can be stated as well.</span>
<span id="cb43-335"><a href="#cb43-335" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb43-336"><a href="#cb43-336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-337"><a href="#cb43-337" aria-hidden="true" tabindex="-1"></a>::: {.column-margin}</span>
<span id="cb43-338"><a href="#cb43-338" aria-hidden="true" tabindex="-1"></a>**Paired *t*-test:**</span>
<span id="cb43-339"><a href="#cb43-339" aria-hidden="true" tabindex="-1"></a>$$t = \frac{\bar{d}}{s_d/\sqrt{n}}$$</span>
<span id="cb43-340"><a href="#cb43-340" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-341"><a href="#cb43-341" aria-hidden="true" tabindex="-1"></a>where $\bar{d}$ is the sample mean of the differences between paired observations, $s_d$ is the sample standard deviation of the differences, and $n$ is the number of pairs. The resulting $t$-statistic is then compared to the appropriate $t$-distribution with $n-1$ degrees of freedom to determine the $p$-value.</span>
<span id="cb43-342"><a href="#cb43-342" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb43-343"><a href="#cb43-343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-344"><a href="#cb43-344" aria-hidden="true" tabindex="-1"></a>Paired *t*-tests are done when comparing matched samples, and in other words, when our second assumption of *t*-tests is violated: the observations are independent of one another---in paired samples, clearly they are not independent. This test is also sometimes called a dependent sample *t*-test or a repeated measures *t*-test.</span>
<span id="cb43-345"><a href="#cb43-345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-346"><a href="#cb43-346" aria-hidden="true" tabindex="-1"></a>For example, we design a survey to determine if, in a group of 20 people, individuals' right arms differ in length from that of their left arms. For person A, we measure her right arm and her left arm. For person B we measure his right arm and his left arm. So we go all the way to person 20. A right arm belonging with one individual is always matched against a left arm in the same individual. The samples are paired so we use a paired *t*-test.</span>
<span id="cb43-347"><a href="#cb43-347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-348"><a href="#cb43-348" aria-hidden="true" tabindex="-1"></a>Another example: we follow the growth of a sample of 20 piglets over three weeks to see if they weigh more after three weeks than they did at the start of the assessment period. We measure the first piglet, named Halal, at the start of the three week period and again after. We do the same for the second piglet, Kosher. And so it goes. Each piglet has a paired set of measurements, one before matched with one after. In both these examples the data in the two groups (left arm and right arm; or before and after) are not independent, so we need to account for this in the analysis. In practice, how do we perform such a *t*-test? Who can think of a dataset we've used in the past that we would use a paired *t*-test for?</span>
<span id="cb43-349"><a href="#cb43-349" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-352"><a href="#cb43-352" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb43-353"><a href="#cb43-353" aria-hidden="true" tabindex="-1"></a><span class="fu">compare_means</span>(dat <span class="sc">~</span> sample, <span class="at">data =</span> r_two, <span class="at">method =</span> <span class="st">"t.test"</span>, <span class="at">paired =</span> <span class="cn">TRUE</span>)</span>
<span id="cb43-354"><a href="#cb43-354" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb43-355"><a href="#cb43-355" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-356"><a href="#cb43-356" aria-hidden="true" tabindex="-1"></a>::: callout-important</span>
<span id="cb43-357"><a href="#cb43-357" aria-hidden="true" tabindex="-1"></a><span class="fu">## Task E</span></span>
<span id="cb43-358"><a href="#cb43-358" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span>Divide the class into two groups. In each group, collect your own data that are suitable for analysis with a paired *t*-test. State your hypothesis. Test it. Discuss.</span>
<span id="cb43-359"><a href="#cb43-359" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb43-360"><a href="#cb43-360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-361"><a href="#cb43-361" aria-hidden="true" tabindex="-1"></a><span class="fu"># Is there a difference between two proportions?</span></span>
<span id="cb43-362"><a href="#cb43-362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-363"><a href="#cb43-363" aria-hidden="true" tabindex="-1"></a>All of the tests we covered above are designed to deal with continuous data, such as fish lengths or chlorophyll content. If we want to compare proportions (probabilities of success) of different samples against each other, or some known population mean, we need <span class="in">`prop.test()`</span>. Let's create a dummy dataset to get a better idea of how this function works. Below we create some data showing the result of placing two different subjects, Jack and Jill, in separate sealed rooms for two hours (120 minutes). Once every minute a mosquito is let into the room before being extracted again. The columns <span class="in">`yes`</span> and <span class="in">`no`</span> show if the mosquito bit the subject during that one minute. Who says science can't be fun!</span>
<span id="cb43-364"><a href="#cb43-364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-367"><a href="#cb43-367" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb43-368"><a href="#cb43-368" aria-hidden="true" tabindex="-1"></a>mosquito <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">70</span>, <span class="dv">85</span>, <span class="dv">50</span>, <span class="dv">35</span>), <span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb43-369"><a href="#cb43-369" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(mosquito) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"yes"</span>, <span class="st">"no"</span>)</span>
<span id="cb43-370"><a href="#cb43-370" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(mosquito) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Jack"</span>, <span class="st">"Jill"</span>)</span>
<span id="cb43-371"><a href="#cb43-371" aria-hidden="true" tabindex="-1"></a>mosquito</span>
<span id="cb43-372"><a href="#cb43-372" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb43-373"><a href="#cb43-373" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-374"><a href="#cb43-374" aria-hidden="true" tabindex="-1"></a><span class="fu">## One-sample and two-sample tests</span></span>
<span id="cb43-375"><a href="#cb43-375" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-376"><a href="#cb43-376" aria-hidden="true" tabindex="-1"></a>As with *t*-tests, proportion tests may also be based on one sample, or two. If we have only one sample we must specify the total number of trials as well as what the expected population probability of success is. Because these are individual values, and not matrices, we will show what this would look like without using any objects but will rather give each argument within <span class="in">`prop.test()`</span> a single exact value. In the arguments within <span class="in">`prop.test()`</span>, <span class="in">`x`</span> denotes the number of successes recorded, <span class="in">`n`</span> shows the total number of individual trials performed, and <span class="in">`p`</span> is the expected probability. It is easiest to consider this as though it were a series of 100 coin tosses.</span>
<span id="cb43-377"><a href="#cb43-377" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-380"><a href="#cb43-380" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb43-381"><a href="#cb43-381" aria-hidden="true" tabindex="-1"></a><span class="co"># When the probability matches the population</span></span>
<span id="cb43-382"><a href="#cb43-382" aria-hidden="true" tabindex="-1"></a><span class="fu">prop.test</span>(<span class="at">x =</span> <span class="dv">45</span>, <span class="at">n =</span> <span class="dv">100</span>, <span class="at">p =</span> <span class="fl">0.5</span>)</span>
<span id="cb43-383"><a href="#cb43-383" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-384"><a href="#cb43-384" aria-hidden="true" tabindex="-1"></a><span class="co"># When it doesn't</span></span>
<span id="cb43-385"><a href="#cb43-385" aria-hidden="true" tabindex="-1"></a><span class="fu">prop.test</span>(<span class="at">x =</span> <span class="dv">33</span>, <span class="at">n =</span> <span class="dv">100</span>, <span class="at">p =</span> <span class="fl">0.5</span>)</span>
<span id="cb43-386"><a href="#cb43-386" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb43-387"><a href="#cb43-387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-388"><a href="#cb43-388" aria-hidden="true" tabindex="-1"></a>If we have two samples that we would like to compare against one another we enter them into the function as follows:</span>
<span id="cb43-389"><a href="#cb43-389" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-392"><a href="#cb43-392" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb43-393"><a href="#cb43-393" aria-hidden="true" tabindex="-1"></a><span class="co"># NB: Note that the `mosquito` data are a matrix, NOT a data.frame</span></span>
<span id="cb43-394"><a href="#cb43-394" aria-hidden="true" tabindex="-1"></a><span class="fu">prop.test</span>(mosquito)</span>
<span id="cb43-395"><a href="#cb43-395" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb43-396"><a href="#cb43-396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-397"><a href="#cb43-397" aria-hidden="true" tabindex="-1"></a>Do mosquito's bite Jack and Jill at different proportions?</span>
<span id="cb43-398"><a href="#cb43-398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-399"><a href="#cb43-399" aria-hidden="true" tabindex="-1"></a>::: callout-important</span>
<span id="cb43-400"><a href="#cb43-400" aria-hidden="true" tabindex="-1"></a><span class="fu">## Task E</span></span>
<span id="cb43-401"><a href="#cb43-401" aria-hidden="true" tabindex="-1"></a><span class="ss">6. </span>Divide the class into two groups, Group A and Group B. In each group, collect data on 100 coin tosses. The intention is to compare the coin tosses across Groups A and B. State your hypothesis. Test it. Discuss.</span>
<span id="cb43-402"><a href="#cb43-402" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb43-403"><a href="#cb43-403" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-404"><a href="#cb43-404" aria-hidden="true" tabindex="-1"></a><span class="fu">## One-sided and two-sided tests</span></span>
<span id="cb43-405"><a href="#cb43-405" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-406"><a href="#cb43-406" aria-hidden="true" tabindex="-1"></a>As with all other tests that compare values, proportion tests may be specified as either one or two-sided. Just to be clear, the default setting for <span class="in">`prop.test()`</span>, like everything else, is a two-sided test. See code below to confirm that the results are identical with or without the added argument:</span>
<span id="cb43-407"><a href="#cb43-407" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-410"><a href="#cb43-410" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb43-411"><a href="#cb43-411" aria-hidden="true" tabindex="-1"></a><span class="co"># Default</span></span>
<span id="cb43-412"><a href="#cb43-412" aria-hidden="true" tabindex="-1"></a><span class="fu">prop.test</span>(mosquito)</span>
<span id="cb43-413"><a href="#cb43-413" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-414"><a href="#cb43-414" aria-hidden="true" tabindex="-1"></a><span class="co"># Explicitly state two-sided test</span></span>
<span id="cb43-415"><a href="#cb43-415" aria-hidden="true" tabindex="-1"></a><span class="fu">prop.test</span>(mosquito, <span class="at">alternative =</span> <span class="st">"two.sided"</span>)</span>
<span id="cb43-416"><a href="#cb43-416" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb43-417"><a href="#cb43-417" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-418"><a href="#cb43-418" aria-hidden="true" tabindex="-1"></a>Should we want to specify only one of the tails to be considered, we do so precisely the same as with t-tests. Below are examples of what this code would look like:</span>
<span id="cb43-419"><a href="#cb43-419" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-422"><a href="#cb43-422" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb43-423"><a href="#cb43-423" aria-hidden="true" tabindex="-1"></a><span class="co"># Jack is bit less than Jill</span></span>
<span id="cb43-424"><a href="#cb43-424" aria-hidden="true" tabindex="-1"></a><span class="fu">prop.test</span>(mosquito, <span class="at">alternative =</span> <span class="st">"less"</span>)</span>
<span id="cb43-425"><a href="#cb43-425" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-426"><a href="#cb43-426" aria-hidden="true" tabindex="-1"></a><span class="co"># Jack is bit more than Jill</span></span>
<span id="cb43-427"><a href="#cb43-427" aria-hidden="true" tabindex="-1"></a><span class="fu">prop.test</span>(mosquito, <span class="at">alternative =</span> <span class="st">"greater"</span>)</span>
<span id="cb43-428"><a href="#cb43-428" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb43-429"><a href="#cb43-429" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-430"><a href="#cb43-430" aria-hidden="true" tabindex="-1"></a>Do these results differ from the two-sided test? What is different?</span>
<span id="cb43-431"><a href="#cb43-431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-432"><a href="#cb43-432" aria-hidden="true" tabindex="-1"></a><span class="fu"># A *t*-test workflow</span></span>
<span id="cb43-433"><a href="#cb43-433" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-434"><a href="#cb43-434" aria-hidden="true" tabindex="-1"></a>Now that we have seen how to compare the means of two sample sets of data, let's see what that complete workflow would look like in R. For this example we will use the <span class="in">`ecklonia`</span> data from <span class="co">[</span><span class="ot">Intro R Workshop: Data Manipulation, Analysis and Graphing</span><span class="co">](https://robwschlegel.github.io/Intro_R_Workshop/)</span>.</span>
<span id="cb43-435"><a href="#cb43-435" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-436"><a href="#cb43-436" aria-hidden="true" tabindex="-1"></a><span class="fu">## Loading data</span></span>
<span id="cb43-437"><a href="#cb43-437" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-438"><a href="#cb43-438" aria-hidden="true" tabindex="-1"></a>Before we can run any analyses we will need to load our data. We are also going to convert these data from their wide format into a long format because this is more useful for the rest of our workflow.</span>
<span id="cb43-439"><a href="#cb43-439" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-442"><a href="#cb43-442" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb43-443"><a href="#cb43-443" aria-hidden="true" tabindex="-1"></a>ecklonia <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"../../data/ecklonia.csv"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb43-444"><a href="#cb43-444" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(<span class="at">key =</span> <span class="st">"variable"</span>, <span class="at">value =</span> <span class="st">"value"</span>, <span class="sc">-</span>species, <span class="sc">-</span>site, <span class="sc">-</span>ID)</span>
<span id="cb43-445"><a href="#cb43-445" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb43-446"><a href="#cb43-446" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-447"><a href="#cb43-447" aria-hidden="true" tabindex="-1"></a><span class="fu">## Visualising data</span></span>
<span id="cb43-448"><a href="#cb43-448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-449"><a href="#cb43-449" aria-hidden="true" tabindex="-1"></a>With our data loaded, let's visualise them in order to ensure that these are indeed the data we are after (@fig-ecklonia1). Visualising the data will also help us to formulate a hypothesis.</span>
<span id="cb43-450"><a href="#cb43-450" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-453"><a href="#cb43-453" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb43-454"><a href="#cb43-454" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Boxplots showing differences in morphometric properties of the kelp _Ecklonia maxima_ at two sites in False Bay."</span></span>
<span id="cb43-455"><a href="#cb43-455" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-ecklonia1</span></span>
<span id="cb43-456"><a href="#cb43-456" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: margin</span></span>
<span id="cb43-457"><a href="#cb43-457" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-458"><a href="#cb43-458" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> ecklonia, <span class="fu">aes</span>(<span class="at">x =</span> variable, <span class="at">y =</span> value, <span class="at">fill =</span> site)) <span class="sc">+</span></span>
<span id="cb43-459"><a href="#cb43-459" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">colour =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="st">"dodgerblue4"</span>, <span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb43-460"><a href="#cb43-460" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb43-461"><a href="#cb43-461" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb43-462"><a href="#cb43-462" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb43-463"><a href="#cb43-463" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-464"><a href="#cb43-464" aria-hidden="true" tabindex="-1"></a>The first thing we should notice from the figure above is that our different measurements are on very different scales. This makes comparing all of our data visually rather challenging. Even given this complication, one should readily be able to make out that the measurement values at Batsata Rock appear to be greater than at Boulders Beach. Within the framework of the scientific process, that is what we would call an 'observation', and is the first step towards formulating a hypothesis. The next step is to refine our observation into a hypothesis. By what measurement are the kelps greater at one site than the other?</span>
<span id="cb43-465"><a href="#cb43-465" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-466"><a href="#cb43-466" aria-hidden="true" tabindex="-1"></a><span class="fu">## Formulating a hypothesis</span></span>
<span id="cb43-467"><a href="#cb43-467" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-468"><a href="#cb43-468" aria-hidden="true" tabindex="-1"></a>Looking at the figure above it appears that for almost all measurements of length, Batsata Rock far exceeds that of Boulders Beach however, the stipe masses between the two sites appear to be more similar. Let's pull out just this variable and create a new boxplot (@fig-ecklonia2).</span>
<span id="cb43-469"><a href="#cb43-469" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-472"><a href="#cb43-472" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb43-473"><a href="#cb43-473" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Boxplots showing the difference in stipe mass (kg) of the kelp _Ecklonia maxima_ at two sites in False Bay."</span></span>
<span id="cb43-474"><a href="#cb43-474" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-ecklonia2</span></span>
<span id="cb43-475"><a href="#cb43-475" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: margin</span></span>
<span id="cb43-476"><a href="#cb43-476" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-477"><a href="#cb43-477" aria-hidden="true" tabindex="-1"></a><span class="co"># filter the data</span></span>
<span id="cb43-478"><a href="#cb43-478" aria-hidden="true" tabindex="-1"></a>ecklonia_sub <span class="ot">&lt;-</span> ecklonia <span class="sc">%&gt;%</span> </span>
<span id="cb43-479"><a href="#cb43-479" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(variable <span class="sc">==</span> <span class="st">"stipe_mass"</span>)</span>
<span id="cb43-480"><a href="#cb43-480" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-481"><a href="#cb43-481" aria-hidden="true" tabindex="-1"></a><span class="co"># then create a new figure</span></span>
<span id="cb43-482"><a href="#cb43-482" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> ecklonia_sub, <span class="fu">aes</span>(<span class="at">x =</span> variable, <span class="at">y =</span> value, <span class="at">fill =</span> site)) <span class="sc">+</span></span>
<span id="cb43-483"><a href="#cb43-483" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">colour =</span> <span class="st">"black"</span>, <span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb43-484"><a href="#cb43-484" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb43-485"><a href="#cb43-485" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Stipe mass (kg)"</span>, <span class="at">x =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb43-486"><a href="#cb43-486" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb43-487"><a href="#cb43-487" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.y =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb43-488"><a href="#cb43-488" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb43-489"><a href="#cb43-489" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb43-490"><a href="#cb43-490" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-491"><a href="#cb43-491" aria-hidden="true" tabindex="-1"></a>Now we have a more interesting comparison at hand. The question I think of when I look at these data is "Are the stipe masses at Batsata Rock greater than at Boulders Beach?". The hypothesis necessary to answer this question would look like this:</span>
<span id="cb43-492"><a href="#cb43-492" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-493"><a href="#cb43-493" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>*H*~0~: Stipe mass at Batsata Rock **is not** greater than at Boulders Beach.</span>
<span id="cb43-494"><a href="#cb43-494" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>*H*~a~: Stipe mass at Batsata Rock **is** greater than at Boulders Beach.</span>
<span id="cb43-495"><a href="#cb43-495" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-496"><a href="#cb43-496" aria-hidden="true" tabindex="-1"></a>Or more formally:</span>
<span id="cb43-497"><a href="#cb43-497" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-498"><a href="#cb43-498" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$H_{0}: \bar{A} \leq \bar{B}$</span>
<span id="cb43-499"><a href="#cb43-499" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$H_{a}: \bar{A} &gt; \bar{B}$.</span>
<span id="cb43-500"><a href="#cb43-500" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-501"><a href="#cb43-501" aria-hidden="true" tabindex="-1"></a>Which test must we use for this hypothesis?</span>
<span id="cb43-502"><a href="#cb43-502" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-503"><a href="#cb43-503" aria-hidden="true" tabindex="-1"></a><span class="fu">## Choosing a test</span></span>
<span id="cb43-504"><a href="#cb43-504" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-505"><a href="#cb43-505" aria-hidden="true" tabindex="-1"></a>Before we can pick the correct statistical test for our hypothesis, we need to be clear on what it is we are asking. Starting with the data being used is usually a good first step. As we may see in the above figure, we have two sample sets that we are comparing. Therefore, unsurprisingly, we will likely be using a *t*-test. But we're not done yet. How is it that we are comparing these two sample sets? Remember from the examples above that there are multiple different ways to compare two sets of data. For our hypothesis we want to see if the stipe mass at Batsata Rock is **greater than** the stipe mass at Boulders Beach, not just that they are different. Because of this we will need a one-sided *t*-test. But wait, there's more! We've zeroed in on which sort of test would be appropriate for our hypothesis, but before we run it we need to check our assumptions.</span>
<span id="cb43-506"><a href="#cb43-506" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-507"><a href="#cb43-507" aria-hidden="true" tabindex="-1"></a><span class="fu">## Checking assumptions</span></span>
<span id="cb43-508"><a href="#cb43-508" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-509"><a href="#cb43-509" aria-hidden="true" tabindex="-1"></a>In case we forgot, here are the assumptions for a *t*-test:</span>
<span id="cb43-510"><a href="#cb43-510" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-511"><a href="#cb43-511" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>the dependent variable must be **continuous**,</span>
<span id="cb43-512"><a href="#cb43-512" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>the observations in the groups being compared are **independent** of each other,</span>
<span id="cb43-513"><a href="#cb43-513" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>the data are **normally distributed**, and</span>
<span id="cb43-514"><a href="#cb43-514" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>that the data are **homoscedastic**, and in particular, that there are no outliers.</span>
<span id="cb43-515"><a href="#cb43-515" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-516"><a href="#cb43-516" aria-hidden="true" tabindex="-1"></a>We know that the first two assumptions are met because our data are measurements of mass at two different sites. Before we can run our one-sided *t*-test we must meet the last two assumptions. Lucky us, we have a function tat will do that automagically.</span>
<span id="cb43-517"><a href="#cb43-517" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-518"><a href="#cb43-518" aria-hidden="true" tabindex="-1"></a>Please refer to <span class="co">[</span><span class="ot">Chapter 6</span><span class="co">](06-assumptions.qmd)</span> to see what to do if the assumptions fail.</span>
<span id="cb43-519"><a href="#cb43-519" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-522"><a href="#cb43-522" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb43-523"><a href="#cb43-523" aria-hidden="true" tabindex="-1"></a>ecklonia_sub <span class="sc">%&gt;%</span> </span>
<span id="cb43-524"><a href="#cb43-524" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(site) <span class="sc">%&gt;%</span> </span>
<span id="cb43-525"><a href="#cb43-525" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">stipe_mass_var =</span> <span class="fu">two_assum</span>(value)[<span class="dv">1</span>],</span>
<span id="cb43-526"><a href="#cb43-526" aria-hidden="true" tabindex="-1"></a>            <span class="at">stipe_mass_norm =</span> <span class="fu">two_assum</span>(value)[<span class="dv">2</span>])</span>
<span id="cb43-527"><a href="#cb43-527" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb43-528"><a href="#cb43-528" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-529"><a href="#cb43-529" aria-hidden="true" tabindex="-1"></a>Lovely. The variances are equal and the data are normal. On to the next step.</span>
<span id="cb43-530"><a href="#cb43-530" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-531"><a href="#cb43-531" aria-hidden="true" tabindex="-1"></a><span class="fu">## Running an analysis</span></span>
<span id="cb43-532"><a href="#cb43-532" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-533"><a href="#cb43-533" aria-hidden="true" tabindex="-1"></a>With our assumptions checked, we may now analyse our data. We'll see below how to do this with both of the functions we've learned in this chapter for comparing means of two sample sets.</span>
<span id="cb43-534"><a href="#cb43-534" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-537"><a href="#cb43-537" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb43-538"><a href="#cb43-538" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(value <span class="sc">~</span> site, <span class="at">data =</span> ecklonia_sub, <span class="at">var.equal =</span> <span class="cn">TRUE</span>, <span class="at">alternative =</span> <span class="st">"greater"</span>)</span>
<span id="cb43-539"><a href="#cb43-539" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb43-540"><a href="#cb43-540" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-541"><a href="#cb43-541" aria-hidden="true" tabindex="-1"></a><span class="fu">## Interpreting the results</span></span>
<span id="cb43-542"><a href="#cb43-542" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-543"><a href="#cb43-543" aria-hidden="true" tabindex="-1"></a>We may reject the null hypothesis that the stipe mass of kelps at Batsata Rock is not greater than at Boulders Beach if our *t*-test returns a *p*-value $\leq$ 0.05. We must also pay attention to some of the other results from our *t*-test, specifically the *t*-value (<span class="in">`t`</span>) and the degrees of freedom (<span class="in">`df`</span>) as these are also needed when we are writing up our results. From all of the information above, we may accept the alternative hypothesis. But how do we write that up?</span>
<span id="cb43-544"><a href="#cb43-544" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-545"><a href="#cb43-545" aria-hidden="true" tabindex="-1"></a><span class="fu">## Drawing conclusions</span></span>
<span id="cb43-546"><a href="#cb43-546" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-547"><a href="#cb43-547" aria-hidden="true" tabindex="-1"></a>There are many ways to present ones findings. Style, without *too much* flourish, is encouraged as long as certain necessary pieces of information are provided. The sentence below is a very minimalist example of how one may conclude this mini research project. A more thorough explanation would be desirable.</span>
<span id="cb43-548"><a href="#cb43-548" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-549"><a href="#cb43-549" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; The stipe mass (kg) of the kelp *Ecklonia maxima* was found to be significantly greater at Batsata Rock than at Boulders Beach (*p* = 0.03, *t* = 1.87, df = 24).</span></span>
<span id="cb43-550"><a href="#cb43-550" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-551"><a href="#cb43-551" aria-hidden="true" tabindex="-1"></a><span class="fu">## Going further</span></span>
<span id="cb43-552"><a href="#cb43-552" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-553"><a href="#cb43-553" aria-hidden="true" tabindex="-1"></a>But why though? As is often the case in life, and science is no exception, answers to our questions just create even more questions! Why would the mass of kelp stipes at one locations in the same body of water and only a kilometre or so apart be significantly different? It looks like we are going to need to design a new experiment... Masters thesis anyone?</span>
<span id="cb43-554"><a href="#cb43-554" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-555"><a href="#cb43-555" aria-hidden="true" tabindex="-1"></a><span class="fu"># Conclusion</span></span>
<span id="cb43-556"><a href="#cb43-556" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-557"><a href="#cb43-557" aria-hidden="true" tabindex="-1"></a>*t*-tests are one of the first classes of inferential statistics students typically lerarn in a course on biostatistics. They are suitable for situations where you have two groups of data to compare and to establish if the difference between their means is zero. Lesson learned here are generalisable to more complex analysis.</span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">© 2023, AJ Smit</div>   
    <div class="nav-footer-center"><div class="cookie-consent-footer"><a href="#" id="open_preferences_center">Cookie Preferences</a></div></div>
    <div class="nav-footer-right">This page is built with <a href="https://quarto.org/">Quarto</a>.</div>
  </div>
</footer>


<script src="../../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>