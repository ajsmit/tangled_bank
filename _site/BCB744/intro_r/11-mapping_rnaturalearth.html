<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.27">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="Smit, A. J.">
<meta name="dcterms.date" content="2021-01-01">
<title>11. Mapping with Natural Earth – The Tangled Bank</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../BCB744/intro_r/12-mapping_quakes.html" rel="next">
<link href="../../BCB744/intro_r/10-mapping_style.html" rel="prev">
<link href="../../images/favicon.ico" rel="icon">
<script src="../../site_libs/cookie-consent/cookie-consent.js"></script>
<link href="../../site_libs/cookie-consent/cookie-consent.css" rel="stylesheet">
<script src="../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-8b4baf804e461d9b72633f0de59a0cac.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-37d9842ca13b32c9c58adfc4ed5d9451.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script src="../../site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="../../site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="../../site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-SCYH68M489"></script><script type="text/plain" cookie-consent="tracking">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-SCYH68M489', { 'anonymize_ip': true});
</script><script type="text/javascript" charset="UTF-8">
document.addEventListener('DOMContentLoaded', function () {
cookieconsent.run({
  "notice_banner_type":"headline",
  "consent_type":"express",
  "palette":"light",
  "language":"en",
  "page_load_consent_levels":["strictly-necessary"],
  "notice_banner_reject_button_hide":false,
  "preferences_center_close_button_hide":false,
  "website_name":""
  ,
"language":"en"
  });
});
</script><style>html{ scroll-behavior: smooth; }</style>
<script async="" src="https://hypothes.is/embed.js"></script><script>
  window.document.addEventListener("DOMContentLoaded", function (_event) {
    document.body.classList.add('hypothesis-enabled');
  });
</script><link rel="stylesheet" href="../../styles/styles.css">
<meta property="og:title" content="11. Mapping with Natural Earth – The Tangled Bank">
<meta property="og:description" content="UWC’s Biodiversity &amp; Conservation Biology Department Pages For BDC223, BDC334, BCB743, and BCB744.">
<meta property="og:image" content="http://tangledbank.netlify.app/BCB744/intro_r/data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==">
<meta property="og:site_name" content="The Tangled Bank">
</head>
<body class="nav-sidebar floating nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="navbar navbar-expand-lg " data-bs-theme="dark"><div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">The Tangled Bank</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
<li class="nav-item">
    <a class="nav-link active" href="../../index.html" aria-current="page"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-vignettes" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Vignettes</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-vignettes">
<li>
    <a class="dropdown-item" href="../../vignettes/netCDF_dates.html">
 <span class="dropdown-text">Dates From netCDF Files: Two Approaches</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../vignettes/prep_NOAA_OISST.html">
 <span class="dropdown-text">Downloading and Prep: ERDDAP</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../vignettes/chl_ERDDAP.html">
 <span class="dropdown-text">Retrieving Chlorophyll-a Data from ERDDAP Servers</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../vignettes/alt_method.html">
 <span class="dropdown-text">Downloading and Prep: Python + CDO</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../vignettes/gridded_data.html">
 <span class="dropdown-text">Detecting Events in Gridded Data</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../vignettes/regridding.html">
 <span class="dropdown-text">Regridding gridded data</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../vignettes/MHW_MCS_horizonplots.html">
 <span class="dropdown-text">Displaying MHWs and MCSs as Horizon Plots</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../vignettes/heatwaveR_issues.html">
 <span class="dropdown-text">heatwaveR Issues</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../vignettes/chl_sightings.html">
 <span class="dropdown-text">Plotting the Whale Sightings and Chlorophyll-<em>a</em> Concentrations</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../vignettes/chl_localisation.html">
 <span class="dropdown-text">Spatial Localisation, Subsetting, and Aggregation of the Chlorophyll-<em>a</em> Data</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../vignettes/elem_ts_methods.html">
 <span class="dropdown-text">Wavelet Analysis of Diatom Time Series</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../vignettes/buffer_data_extract.html">
 <span class="dropdown-text">Extracting gridded data within a buffer</span></a>
  </li>  
    </ul>
</li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-high-performance-computing" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">High-Performance Computing</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-high-performance-computing">
<li>
    <a class="dropdown-item" href="../../vignettes/README_Lengau.html">
 <span class="dropdown-text">Using Lengau</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../vignettes/PBSPro_users.html">
 <span class="dropdown-text">PBSPro user and job management</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../vignettes/README_tmux.html">
 <span class="dropdown-text">Using tmux</span></a>
  </li>  
    </ul>
</li>
  <li class="nav-item">
    <a class="nav-link" href="../../blog.html"> 
<span class="menu-text">Tangled Bank Blog</span></a>
  </li>  
</ul>
<ul class="navbar-nav navbar-nav-scroll ms-auto">
<li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-blogroll" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Blogroll</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-blogroll">
<li>
    <a class="dropdown-item" href="https://www.r-bloggers.com">
 <span class="dropdown-text">R-bloggers</span></a>
  </li>  
    </ul>
</li>
  <li class="nav-item compact">
    <a class="nav-link" href="../../blog.xml"> <i class="bi bi-rss" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-bi-github" role="link" data-bs-toggle="dropdown" aria-expanded="false">
      <i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-bi-github">
<li>
    <a class="dropdown-item" href="https://github.com/ajsmit/tangled_bank">
 <span class="dropdown-text">Source Code</span></a>
  </li>  
    </ul>
</li>
</ul>
</div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
      </div> <!-- /container-fluid -->
    </nav><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../BCB744/BCB744_index.html">BCB744: Introduction to R, &amp; Biostatistics</a></li><li class="breadcrumb-item"><a href="../../BCB744/intro_r/11-mapping_rnaturalearth.html">11. Mapping with Natural Earth</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="../../index.html" class="sidebar-logo-link">
      <img src="../../images/my_tree_hex.png" alt="" class="sidebar-logo light-content py-0 d-lg-inline d-none"><img src="../../images/my_tree_hex.png" alt="" class="sidebar-logo dark-content py-0 d-lg-inline d-none"></a>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Home</span></a>
  </div>
</li>
        <li class="sidebar-item">
 <span class="menu-text">☘☘☘</span>
  </li>
        <li class="sidebar-item">
 <span class="menu-text">UNDERGRADUATE</span>
  </li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false">
 <span class="menu-text">BDC223: Plant Ecophysiology</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BDC223/BDC223_index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><strong>About</strong></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BDC223/L00-introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introductory Lecture</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BDC223/L01-worldmapper.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lecture 1: the Limits to Life</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BDC223/L02-SA_V.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lecture 2: Surface Area to Volume (SA:V) Ratio</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BDC223/L03-climate.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lecture 3: Earth’s Climate</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BDC223/L04-carbon_cycle.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lecture 4: Climate Change (Carbon Cycle)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BDC223/L05-light.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lecture 5: Light</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BDC223/L06-pigments_photosynthesis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lecture 6: Pigments &amp; Photosynthesis</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BDC223/L07-chromatic_adaptation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lecture 7: Chromatic Adaptation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BDC223/L08a-nutrient_uptake.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lecture 8a: Nutrient Uptake</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BDC223/L08b-nutrients_michaelis_menten.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lecture 8b: Nutrient Uptake</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BDC223/L09-plant_stress.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lecture 3: Plant Stress</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BDC223/Lab1_SA_V.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lab 1: Surface Area to Volume (SA/V) Ratios in Biology</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BDC223/Lab2_misc_calcs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lab 2: Miscellaneous Calculations</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BDC223/Lab3_PI_curves.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lab 3: PI Curves — Jassby &amp; Platt</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BDC223/Lab4_nitrogen_uptake.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lab 4: Uptake Kinetics — Michaelis-Menten</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BDC223/BDC223_FAQ.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">FAQ</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false">
 <span class="menu-text">BDC334: Biogeography &amp; Global Ecology</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BDC334/BDC334_syllabus.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><strong>About</strong></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BDC334/BDC334-Lecture-Transcripts.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="my-highlight">BCB334 Lecture Transcript</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BDC334/Lec-01-introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lecture 1: Introductory Lecture</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BDC334/Lec-02-ecosystems.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lecture 2. Overview of Ecosystems</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BDC334/Lec-03-gradients.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lecture 3. Ecological Gradients</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BDC334/Lec-04-biodiversity.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lecture 4: Biodiversity Concepts</span></a>
  </div>
</li>
          <li class="sidebar-item">
 <span class="menu-text">Lecture 5: Multivariate Data</span>
  </li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BDC334/Lec-06-unified-ecology.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lecture 6: Unified Ecology</span></a>
  </div>
</li>
          <li class="sidebar-item">
 <span class="menu-text">Lecture 7: Threats to Biodiversity</span>
  </li>
          <li class="sidebar-item">
 <span class="menu-text">Lecture 8: Nature's Contribution to People</span>
  </li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/IKS_Conservation.pdf" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lecture 9: Indigenous Knowledge Systems and Conservation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BDC334/Lab-01-introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lab 1. Ecological Data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BDC334/Lab-02a-r_rstudio.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lab 2a. Introduction to R and RStudio</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BDC334/Lab-02b-env_dist.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lab 2b. Environmental Distance</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BDC334/Lab-03-biodiversity.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lab 3. Quantifying Biodiversity</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BDC334/Lab-04-biodiversity.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lab 4. Species Distribution Patterns</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BDC334/BDC334_AI_Tutor.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="my-highlight">BCB334 AI Tutor</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../pages/Transboundary_systems.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Transboundary Systems</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item">
 <span class="menu-text">☘☘☘</span>
  </li>
        <li class="sidebar-item">
 <span class="menu-text">HONOURS CORE</span>
  </li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">BCB744: Introduction to R, &amp; Biostatistics</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BCB744/BCB744_index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><strong>About</strong></span></a>
  </div>
</li>
          <li class="px-0"><hr class="sidebar-divider hi "></li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BCB744/intro_r/01-RStudio.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">1. R and RStudio</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BCB744/intro_r/02-working-with-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">2. Working with Data and Code</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BCB744/intro_r/03-quarto.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">3. R Markdown and Quarto</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BCB744/intro_r/04-data-in-R.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">4. Data Classes and Structures</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BCB744/intro_r/05-workflow.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">5. R Workflows</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BCB744/intro_r/06-graphics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">6. Graphics with <strong>ggplot2</strong></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BCB744/intro_r/07-faceting.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">7. Faceting Figures</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BCB744/intro_r/08-brewing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">8. Brewing Colours</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BCB744/intro_r/09-mapping.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">9. Mapping with <strong>ggplot2</strong></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BCB744/intro_r/10-mapping_style.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">10. Mapping with Style</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BCB744/intro_r/11-mapping_rnaturalearth.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">11. Mapping with Natural Earth</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BCB744/intro_r/12-mapping_quakes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">12. The Fiji Earthquake Data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BCB744/intro_r/13-tidy.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">13. Tidy Data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BCB744/intro_r/14-tidier.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">14. Tidier Data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BCB744/intro_r/15-tidiest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">15. Tidiest Data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BCB744/intro_r/16-recap.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">16. Synthesis</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BCB744/assessments/BCB744_Intro_R_Self-Assessment.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="my-highlight">Intro R Self-Assessment</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BCB744/assessments/BCB744_Intro_R_Example_1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">BCB744 Intro R Example 1</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BCB744/assessments/BCB744_Intro_R_Example_2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">BCB744 Intro R Example 2</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../self-assessment_v1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Self-Assessment Form</span></a>
  </div>
</li>
          <li class="px-0"><hr class="sidebar-divider hi "></li>
          <li class="sidebar-item">
 <span class="menu-text">1. Introduction to Statistics</span>
  </li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BCB744/basic_stats/02-summarise-and-describe.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">2. Data Summaries &amp; Descriptions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BCB744/basic_stats/03-visualise.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">3. Statistical Figures</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BCB744/basic_stats/04-distributions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">4. Data Distributions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BCB744/basic_stats/05-inference.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">5. Statistical Inference</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BCB744/basic_stats/06-assumptions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">6. Assumptions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BCB744/basic_stats/07-t_tests.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">7. <em>t</em>-Tests</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BCB744/basic_stats/08-anova.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">8. ANOVA</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BCB744/basic_stats/09-regressions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">9. Simple Linear Regressions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BCB744/basic_stats/10-correlations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">10. Correlations</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BCB744/basic_stats/11-decision_guide.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">11. Parametric Tests</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BCB744/basic_stats/12-glance.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">12. Non-Parametric Tests</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BCB744/basic_stats/13-confidence.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">13. Confidence Intervals</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BCB744/basic_stats/14-transformations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">14. Data Transformations</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BCB744/assessments/BCB744_Biostatistics_Self-Assessment.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="my-highlight">Biostatistics Self-Assessment</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BCB744/assessments/BCB744_BioStats_Example_1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">BCB744 BioStats 2025 Example 1</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item">
 <span class="menu-text">☘☘☘</span>
  </li>
        <li class="sidebar-item">
 <span class="menu-text">HONOURS ELECTIVES</span>
  </li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false">
 <span class="menu-text">BCB743: Quantitative Ecology</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BCB743/BCB743_index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><strong>About</strong></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BCB743/review.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">1-4: Review Concepts fo Biodiversity</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BCB743/correlations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">5: Correlations &amp; Associations</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BCB743/ordination.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">7: Intro to Ordination</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BCB743/PCA.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">8a: Principal Components Analysis</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BCB743/PCA_examples.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">8b: PCA: Additional Examples</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BCB743/PCA_SDG_example.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">8c: PCA: WHO SDG Example</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BCB743/CA.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">9a: Correspondence Analysis</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BCB743/DCA.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">9b: Detrended Correspondence Analysis</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BCB743/PCoA.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">10: Principal Coordinates Analysis</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BCB743/nMDS.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">11a: Non-metric Multidimensional Scaling</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BCB743/nMDS_diatoms.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">11b: nMDS: PERMANOVA (Diatoms) Example</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BCB743/unconstrained-summary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">12: Unconstrained Ordination Summary</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BCB743/constrained_ordination.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">13a: Distance-Based Redundancy Analysis</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BCB743/two_oceans_appendices.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">13b: db-RDA: Seaweeds Example</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BCB743/cluster_analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">14: Cluster Analysis</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BCB743/model_building.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">15: Model Building</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BCB743/deep_dive.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">16a: Deep Dive Into Gradients</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BCB743/multiple_regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">16b: Multiple Regression</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item">
 <span class="menu-text">AI &amp; POLICY</span>
  </li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/Combined Faculty AI Policy 15082025.pdf" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Faculty of Natural Sciences AI Policy</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../AI/BCB_AI_Workshop_Sep_2025.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">BCB AI Workshop</span></a>
  </div>
</li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item">
 <span class="menu-text">☘☘☘︎</span>
  </li>
        <li class="sidebar-item">
 <span class="menu-text">SUPPORT</span>
  </li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false">
 <span class="menu-text">Web Resources</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../resources/general_resources_web.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">R Resources</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../resources/ecology_resources_web.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Quantitative Ecology Resources</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../resources/spatial_resources_web.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Spatial R Resources</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item">
 <span class="menu-text">☘☘☘︎</span>
  </li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">On this page</h2>
   
  <ul>
<li>
<a href="#orientation-what-you-are-here-to-learn" id="toc-orientation-what-you-are-here-to-learn" class="nav-link active" data-scroll-target="#orientation-what-you-are-here-to-learn"><span class="header-section-number">1</span> Orientation: What You Are Here to Learn</a>
  <ul class="collapse">
<li><a href="#learning-goals" id="toc-learning-goals" class="nav-link" data-scroll-target="#learning-goals"><span class="header-section-number">1.1</span> Learning goals</a></li>
  <li><a href="#workflow-overview" id="toc-workflow-overview" class="nav-link" data-scroll-target="#workflow-overview"><span class="header-section-number">1.2</span> Workflow overview</a></li>
  <li><a href="#web-resources-for-spatial-work-in-r" id="toc-web-resources-for-spatial-work-in-r" class="nav-link" data-scroll-target="#web-resources-for-spatial-work-in-r"><span class="header-section-number">1.3</span> Web resources for spatial work in R</a></li>
  <li><a href="#what-to-aspire-to" id="toc-what-to-aspire-to" class="nav-link" data-scroll-target="#what-to-aspire-to"><span class="header-section-number">1.4</span> What to Aspire to</a></li>
  </ul>
</li>
  <li><a href="#the-sf-package" id="toc-the-sf-package" class="nav-link" data-scroll-target="#the-sf-package"><span class="header-section-number">2</span> The <strong>sf</strong> Package</a></li>
  <li><a href="#maps-with-rnaturalearth" id="toc-maps-with-rnaturalearth" class="nav-link" data-scroll-target="#maps-with-rnaturalearth"><span class="header-section-number">3</span> Maps With <strong>rnaturalearth</strong></a></li>
  <li>
<a href="#install-packages-and-set-things-up" id="toc-install-packages-and-set-things-up" class="nav-link" data-scroll-target="#install-packages-and-set-things-up"><span class="header-section-number">4</span> Install Packages and Set Things Up</a>
  <ul class="collapse">
<li><a href="#define-a-working-extent" id="toc-define-a-working-extent" class="nav-link" data-scroll-target="#define-a-working-extent"><span class="header-section-number">4.1</span> Define a working extent</a></li>
  </ul>
</li>
  <li>
<a href="#create-and-inspect-an-sf-object" id="toc-create-and-inspect-an-sf-object" class="nav-link" data-scroll-target="#create-and-inspect-an-sf-object"><span class="header-section-number">5</span> Create and Inspect an <code>sf</code> Object</a>
  <ul class="collapse">
<li><a href="#load-features-from-natural-earth" id="toc-load-features-from-natural-earth" class="nav-link" data-scroll-target="#load-features-from-natural-earth"><span class="header-section-number">5.1</span> Load features from Natural Earth</a></li>
  <li><a href="#inspect-the-geometry-and-crs" id="toc-inspect-the-geometry-and-crs" class="nav-link" data-scroll-target="#inspect-the-geometry-and-crs"><span class="header-section-number">5.2</span> Inspect the geometry and CRS</a></li>
  <li><a href="#plot-quickly-in-base-r" id="toc-plot-quickly-in-base-r" class="nav-link" data-scroll-target="#plot-quickly-in-base-r"><span class="header-section-number">5.3</span> Plot quickly in base R</a></li>
  <li><a href="#dissolve-and-crop-features-geometry-changes" id="toc-dissolve-and-crop-features-geometry-changes" class="nav-link" data-scroll-target="#dissolve-and-crop-features-geometry-changes"><span class="header-section-number">5.4</span> Dissolve and crop features (geometry changes)</a></li>
  <li><a href="#buffering-and-geometry-assumptions" id="toc-buffering-and-geometry-assumptions" class="nav-link" data-scroll-target="#buffering-and-geometry-assumptions"><span class="header-section-number">5.5</span> Buffering and geometry assumptions</a></li>
  </ul>
</li>
  <li><a href="#a-reusable-workflow" id="toc-a-reusable-workflow" class="nav-link" data-scroll-target="#a-reusable-workflow"><span class="header-section-number">6</span> A Reusable Workflow</a></li>
  <li><a href="#example" id="toc-example" class="nav-link" data-scroll-target="#example"><span class="header-section-number">7</span> Example</a></li>
  </ul><div class="toc-actions"><ul><li><a href="https://github.com/ajsmit/tangled_bank/edit/main/BCB744/intro_r/11-mapping_rnaturalearth.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/ajsmit/tangled_bank/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../BCB744/BCB744_index.html">BCB744: Introduction to R, &amp; Biostatistics</a></li><li class="breadcrumb-item"><a href="../../BCB744/intro_r/11-mapping_rnaturalearth.html">11. Mapping with Natural Earth</a></li></ol></nav><div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">11. Mapping with Natural Earth</h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
</div>


<div class="quarto-title-meta-author">
  <div class="quarto-title-meta-heading">Author</div>
  <div class="quarto-title-meta-heading">Affiliation</div>
  
    <div class="quarto-title-meta-contents">
    <p class="author"><a href="https://tangledbank.netlify.app">Smit, A. J.</a> <a href="https://orcid.org/0000-0002-3799-6126" class="quarto-title-author-orcid"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg=="></a></p>
  </div>
  <div class="quarto-title-meta-contents">
        <p class="affiliation">
            <a href="https://uwc.ac.za">
            University of the Western Cape
            </a>
          </p>
      </div>
  </div>

<div class="quarto-title-meta">

      
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">January 1, 2021</p>
    </div>
  </div>
  
    
  </div>
  


</header><div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><a href="../../images/thesaurus.jpg" class="lightbox" data-gallery="quarto-lightbox-gallery-1" title="A reminder that names and classifications matter."><img src="../../images/thesaurus.jpg" class="img-fluid figure-img" style="width:75.0%" alt="A reminder that names and classifications matter."></a></p>
<figcaption>A reminder that names and classifications matter.</figcaption></figure>
</div>
<blockquote class="blockquote">
<p>“<em>In the beginning there was nothing, which exploded.</em>”</p>
<p>— Terry Pratchett</p>
</blockquote>
<blockquote class="blockquote">
<p>“<em>Biology is the study of complicated things that have the appearance of having been designed with a purpose.</em>”</p>
<p>— Richard Dawkins</p>
</blockquote>
<section id="orientation-what-you-are-here-to-learn" class="level1" data-number="1"><h1 data-number="1">
<span class="header-section-number">1</span> Orientation: What You Are Here to Learn</h1>
<p>Up to now, your maps have likely been <em>drawn</em> rather than <em>reasoned about</em>. This chapter shifts you from decorative mapping to spatial reasoning with data structures that carry geometry, scale, and assumptions. The goal is to make them more defensible.</p>
<section id="learning-goals" class="level2" data-number="1.1"><h2 data-number="1.1" class="anchored" data-anchor-id="learning-goals">
<span class="header-section-number">1.1</span> Learning goals</h2>
<p>By the end of this chapter you should be able to:</p>
<ol type="1">
<li>Explain what an <code>sf</code> object is (features, attributes, geometry column, CRS).</li>
<li>Subset and transform spatial features without losing geometry.</li>
<li>Produce layered maps in base R and <strong>ggplot2</strong> with explicit spatial choices.</li>
</ol></section><section id="workflow-overview" class="level2" data-number="1.2"><h2 data-number="1.2" class="anchored" data-anchor-id="workflow-overview">
<span class="header-section-number">1.2</span> Workflow overview</h2>
<p>When you are working independently, aim for this repeatable sequence:</p>
<ol type="1">
<li>Load data and inspect the geometry and CRS.</li>
<li>Subset features (rows) and attributes (columns) intentionally.</li>
<li>Crop or transform geometry only when you mean to.</li>
<li>Plot in base R or <strong>ggplot2</strong>, then refine.</li>
</ol></section><section id="web-resources-for-spatial-work-in-r" class="level2" data-number="1.3"><h2 data-number="1.3" class="anchored" data-anchor-id="web-resources-for-spatial-work-in-r">
<span class="header-section-number">1.3</span> Web resources for spatial work in R</h2>
<p>These are reference texts, not required reading. Use them as technical back-up when you get stuck or want to go deeper.</p>
<div class="callout callout-style-simple callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Web resources about spatial methods in R
</div>
</div>
<div class="callout-body-container callout-body">
<table class="table">
<thead><tr class="header">
<th style="text-align: left;">Author</th>
<th style="text-align: left;">Title</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><strong>Spatial R</strong></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Edzer Pebesma</td>
<td style="text-align: left;"><a href="https://r-spatial.github.io/sf/index.html">Simple Features for R</a></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Edzer Pebesma, Roger Bivand</td>
<td style="text-align: left;"><a href="https://r-spatial.org/book/">Spatial Data Science with applications in R</a></td>
</tr>
<tr class="even">
<td style="text-align: left;">Robin Lovelace et al.</td>
<td style="text-align: left;"><a href="https://geocompr.robinlovelace.net/index.html">Geocomputation with R</a></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Manuel Gimond</td>
<td style="text-align: left;"><a href="https://mgimond.github.io/Spatial/index.html">Intro to GIS and Spatial Analysis</a></td>
</tr>
<tr class="even">
<td style="text-align: left;">Wasser et al.</td>
<td style="text-align: left;"><a href="https://datacarpentry.org/r-raster-vector-geospatial/">Introduction to Geospatial Raster and Vector Data with R</a></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Taro Mieno</td>
<td style="text-align: left;"><a href="https://tmieno2.github.io/R-as-GIS-for-Economists/">R as GIS for Economists</a></td>
</tr>
</tbody>
</table>
</div>
</div>
</section><section id="what-to-aspire-to" class="level2" data-number="1.4"><h2 data-number="1.4" class="anchored" data-anchor-id="what-to-aspire-to">
<span class="header-section-number">1.4</span> What to Aspire to</h2>
<p>Please see the snooty maps at <a href="https://bedeffinianrowedavies.com/intermediatertutorials/makingmaps">Making Static Maps in R</a>. The skills you acquire in this module should eventually allow you to do similar maps.</p>
</section></section><section id="the-sf-package" class="level1" data-number="2"><h1 data-number="2">
<span class="header-section-number">2</span> The <strong>sf</strong> Package</h1>
<p>At this point you need data structures that carry geometry and behave sensibly under spatial operations. The <a href="https://r-spatial.github.io/sf/"><strong>sf</strong></a> package provides exactly that, and it has become the <em>de facto</em> tool for many mapping applications, replacing older packages such as <strong>sp</strong>. It provides classes for storing and manipulating simple feature geometries and functions for working with spatial data. <em>Simple features</em> refer to a standardised way of encoding vector data — points, lines, and polygons — used widely in GIS.</p>
<p>The <strong>sf</strong> package was created to provide a fast and efficient way to work with vector data in R. It integrates with other <strong>tidyverse</strong> packages, such as <strong>dplyr</strong> and <strong>ggplot2</strong>, allowing for seamless processing and visualisation of spatial data. The package provides a variety of functions for data import, transformation, manipulation, and analysis, making it a valuable tool for working with spatial data in R.</p>
<p>In addition to its core functionality, the <strong>sf</strong> package also provides a set of methods for converting between different data representations, such as data frames, matrices, and lists, making it a versatile tool for working with spatial data in a variety of formats.</p>
<p>While <strong>sf</strong> works with vector data, raster data require the well-known but older <a href="https://rspatial.org/raster/pkg/index.html"><strong>raster</strong></a> package, or its modern replacements <a href="https://rspatial.org/pkg/index.html"><strong>terra</strong></a>, <a href="https://r-spatial.github.io/stars/"><strong>stars</strong></a>. I will not work with raster data in this chapter.</p>
</section><section id="maps-with-rnaturalearth" class="level1" data-number="3"><h1 data-number="3">
<span class="header-section-number">3</span> Maps With <strong>rnaturalearth</strong>
</h1>
<p><a href="https://www.naturalearthdata.com/">Natural Earth</a> is a public domain map dataset that provides high-quality, general-purpose base maps for the world at various scales. It is an ideal stepping stone when <code>map_data()</code> and hand-drawn polygons become too crude or too brittle for serious work. It was designed to be a visually pleasing alternative to other public domain datasets, and its creators aim to provide the data in a form that is useful for a wide range of applications, to make it easy to use and integrate with other data.</p>
<p>The dataset includes a variety of geographic features, including coastlines, rivers, lakes, and political boundaries, as well as cultural features like cities, roads, and railways. The data are available in several formats, including vector and raster, and they can be used with a variety of software, including GIS and mapping applications. Within R we can access these map layers using the <a href="https://cran.r-project.org/web/packages/rnaturalearth/vignettes/rnaturalearth.html"><strong>rnaturalearth</strong></a> package.</p>
<p>One of the key benefits of Natural Earth is its public domain status, which means that anyone can use, distribute the data without restrictions or licensing fees. This makes it an ideal choice for individuals who need high-quality base maps for their projects but may not have the resources or expertise to create them from scratch. I am not convinced that students actually read this. The first person to send me a WhatsApp mentioning the phrase “Know your maps” will get a Lindt chocolate.</p>
<p>In addition to its public domain status, Natural Earth is regularly updated with new data to ensure that the maps remain accurate and up to date. This makes it a valuable resource for anyone who needs reliable geographic data.</p>
</section><section id="install-packages-and-set-things-up" class="level1" data-number="4"><h1 data-number="4">
<span class="header-section-number">4</span> Install Packages and Set Things Up</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="co"># install.packages("rnaturalearth", "rnaturalearthdata", "sf")</span></span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="fu">library</span>(sf)</span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="fu">library</span>(rnaturalearth)</span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="fu">library</span>(rnaturalearthdata)</span>
<span id="cb1-6"><a href="#cb1-6"></a></span>
<span id="cb1-7"><a href="#cb1-7"></a><span class="co"># for the buffer to work as I expect, switch off</span></span>
<span id="cb1-8"><a href="#cb1-8"></a><span class="co"># the functions for spherical geometry:</span></span>
<span id="cb1-9"><a href="#cb1-9"></a><span class="fu">sf_use_s2</span>(<span class="cn">FALSE</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="callout callout-style-simple callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Warning</span>Geometry assumptions and <code>sf_use_s2()</code>
</div>
</div>
<div class="callout-body-container callout-body">
<p>The <code>s2</code> engine treats the Earth as a sphere. Some operations — notably buffering — behave differently under spherical versus planar assumptions. Turning <code>s2</code> off can be useful for small regional maps, but it does <strong>not</strong> make distances in degrees suddenly meaningful. If you need accurate distances, use a projected CRS and keep <code>s2</code> on.</p>
</div>
</div>
<section id="define-a-working-extent" class="level2" data-number="4.1"><h2 data-number="4.1" class="anchored" data-anchor-id="define-a-working-extent">
<span class="header-section-number">4.1</span> Define a working extent</h2>
<p>First, I define the extent of the map region:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="co"># the full map extent:</span></span>
<span id="cb2-2"><a href="#cb2-2"></a>xmin <span class="ot">&lt;-</span> <span class="dv">12</span>; ymin <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">36.5</span>; xmax <span class="ot">&lt;-</span> <span class="fl">40.5</span>; ymax <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">10</span></span>
<span id="cb2-3"><a href="#cb2-3"></a>xlim <span class="ot">&lt;-</span> <span class="fu">c</span>(xmin, xmax); ylim <span class="ot">&lt;-</span> <span class="fu">c</span>(ymin, ymax)</span>
<span id="cb2-4"><a href="#cb2-4"></a></span>
<span id="cb2-5"><a href="#cb2-5"></a><span class="co"># make a bounding box for cropping:</span></span>
<span id="cb2-6"><a href="#cb2-6"></a>bbox <span class="ot">&lt;-</span> <span class="fu">st_bbox</span>(<span class="fu">c</span>(<span class="at">xmin =</span> xmin, <span class="at">ymin =</span> ymin,</span>
<span id="cb2-7"><a href="#cb2-7"></a>  <span class="at">xmax =</span> xmax, <span class="at">ymax =</span> ymax))</span>
<span id="cb2-8"><a href="#cb2-8"></a></span>
<span id="cb2-9"><a href="#cb2-9"></a><span class="co"># might be useful for zooming into a smaller region (False Bay and </span></span>
<span id="cb2-10"><a href="#cb2-10"></a><span class="co"># the Cape Peninsula):</span></span>
<span id="cb2-11"><a href="#cb2-11"></a>xlim_zoom <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">17.8</span>, <span class="dv">19</span>); ylim_zoom <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">34.5</span>, <span class="sc">-</span><span class="fl">33.2</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Choosing bounds is a cartographic decision. If you clip too tightly you can hide relevant context; if you clip too loosely you dilute the focus of the map. Cropping can also cut features that cross the boundary (and cuase complications, which are very difficult to rectify), so use it deliberately.</p>
</section></section><section id="create-and-inspect-an-sf-object" class="level1" data-number="5"><h1 data-number="5">
<span class="header-section-number">5</span> Create and Inspect an <code>sf</code> Object</h1>
<p>Before we draw anything, we will load a spatial object, then <em>inspect</em> it. This is the point where your thinking should shift from “plots” to “features with geometry”.</p>
<section id="load-features-from-natural-earth" class="level2" data-number="5.1"><h2 data-number="5.1" class="anchored" data-anchor-id="load-features-from-natural-earth">
<span class="header-section-number">5.1</span> Load features from Natural Earth</h2>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="co"># load the countries:</span></span>
<span id="cb3-2"><a href="#cb3-2"></a>safrica_countries <span class="ot">&lt;-</span> <span class="fu">ne_countries</span>(<span class="at">returnclass =</span> <span class="st">'sf'</span>,</span>
<span id="cb3-3"><a href="#cb3-3"></a>  <span class="at">continent =</span> <span class="st">"Africa"</span>,</span>
<span id="cb3-4"><a href="#cb3-4"></a>  <span class="at">country =</span> <span class="fu">c</span>(<span class="st">"South Africa"</span>, <span class="st">"Mozambique"</span>,</span>
<span id="cb3-5"><a href="#cb3-5"></a>    <span class="st">"Namibia"</span>, <span class="st">"Zimbabwe"</span>, <span class="st">"Botswana"</span>,</span>
<span id="cb3-6"><a href="#cb3-6"></a>    <span class="st">"Lesotho"</span>, <span class="st">"Eswatini"</span>),</span>
<span id="cb3-7"><a href="#cb3-7"></a>  <span class="at">scale =</span> <span class="st">"large"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The object now contains <em>features</em> (rows) with <em>attributes</em> (columns) plus a geometry column that stores the spatial shapes. That geometry persists unless you explicitly alter it.</p>
</section><section id="inspect-the-geometry-and-crs" class="level2" data-number="5.2"><h2 data-number="5.2" class="anchored" data-anchor-id="inspect-the-geometry-and-crs">
<span class="header-section-number">5.2</span> Inspect the geometry and CRS</h2>
<p>Pause here and check what makes this different from a normal tibble.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="fu">class</span>(safrica_countries)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt; [1] "sf"         "data.frame"</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="co"># safrica_countries</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="callout callout-style-simple callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>The <code>sf</code> Class
</div>
</div>
<div class="callout-body-container callout-body">
<p><code>sf</code> indicates that the object is of class <em>simple features</em>. In <strong>sf</strong> language, what would be called columns (variables) in normal <strong>tidyverse</strong> speak becomes known as <em>attributes</em> — these are the properties of the map <em>features</em>. The geometry column stores the shapes; the CRS stores the spatial reference system.</p>
</div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="co"># Run this on your PC... the output is too voluminous for here</span></span>
<span id="cb7-2"><a href="#cb7-2"></a><span class="fu">glimpse</span>(safrica_countries)</span>
<span id="cb7-3"><a href="#cb7-3"></a><span class="fu">st_crs</span>(safrica_countries)</span>
<span id="cb7-4"><a href="#cb7-4"></a><span class="fu">unique</span>(<span class="fu">st_geometry_type</span>(safrica_countries))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The CRS tells you how the coordinates should be interpreted. You do not need to manipulate CRS yet, but you do need to be aware that distance and area calculations depend on it.</p>
<p>As you can see, it is a <code>data.frame</code> and <code>tbl</code> (tibble), amongst other classes, and so you can apply many of the <strong>tidyverse</strong> functions to it, including <code>select()</code>, <code><a href="https://rdrr.io/r/stats/filter.html">filter()</a></code>, <code>summarise()</code> and so on. These verbs act on <em>attributes</em> unless you explicitly change geometry with <strong>sf</strong> functions.</p>
</section><section id="plot-quickly-in-base-r" class="level2" data-number="5.3"><h2 data-number="5.3" class="anchored" data-anchor-id="plot-quickly-in-base-r">
<span class="header-section-number">5.3</span> Plot quickly in base R</h2>
<p>Let us plot the entire <code>safrica_countries</code> object to see all the attributes of all of the features. This kind of figure is called a choropleth map:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="fu">plot</span>(safrica_countries)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div id="fig-plot-safrica-countries" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-plot-safrica-countries-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="11-mapping_rnaturalearth_files/figure-html/fig-plot-safrica-countries-1.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-2" title="Figure&nbsp;1: Southern Africa countries shown as a base R choropleth."><img src="11-mapping_rnaturalearth_files/figure-html/fig-plot-safrica-countries-1.svg" class="img-fluid figure-img" style="width:75.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-plot-safrica-countries-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Southern Africa countries shown as a base R choropleth.
</figcaption></figure>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Attributes vs features (select vs filter)
</div>
</div>
<div class="callout-body-container callout-body">
<p>Use <code>select()</code> to choose <em>attributes</em> (columns). Use <code><a href="https://rdrr.io/r/stats/filter.html">filter()</a></code> to choose <em>features</em> (rows). Neither operation recalculates geometry; the shapes persist unless you explicitly transform them.</p>
</div>
</div>
<p>You probably do not want to plot all of them. Let us select one:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="fu">plot</span>(safrica_countries[<span class="st">"sovereignt"</span>])</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div id="fig-plot-safrica-countries-sovereignt" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-plot-safrica-countries-sovereignt-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="11-mapping_rnaturalearth_files/figure-html/fig-plot-safrica-countries-sovereignt-1.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-3" title="Figure&nbsp;2: Southern Africa countries shaded by sovereignty."><img src="11-mapping_rnaturalearth_files/figure-html/fig-plot-safrica-countries-sovereignt-1.svg" class="img-fluid figure-img" style="width:75.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-plot-safrica-countries-sovereignt-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: Southern Africa countries shaded by sovereignty.
</figcaption></figure>
</div>
</div>
</div>
<p>You might achieve the same in a more familiar way:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a>safrica_countries <span class="sc">|&gt;</span> </span>
<span id="cb10-2"><a href="#cb10-2"></a>  <span class="fu">select</span>(sovereignt) <span class="sc">|&gt;</span> </span>
<span id="cb10-3"><a href="#cb10-3"></a>  <span class="fu">plot</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div id="fig-safrica-countries" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-safrica-countries-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="11-mapping_rnaturalearth_files/figure-html/fig-safrica-countries-1.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-4" title="Figure&nbsp;3: Southern Africa countries shaded by sovereignty (select)."><img src="11-mapping_rnaturalearth_files/figure-html/fig-safrica-countries-1.svg" class="img-fluid figure-img" style="width:75.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-safrica-countries-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3: Southern Africa countries shaded by sovereignty (select).
</figcaption></figure>
</div>
</div>
</div>
<p>Or you may want to plot the estimate of the population size, which is contained in the attribute <code>pop_est</code>:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a>safrica_countries <span class="sc">|&gt;</span> </span>
<span id="cb11-2"><a href="#cb11-2"></a>  <span class="fu">select</span>(pop_est) <span class="sc">|&gt;</span> </span>
<span id="cb11-3"><a href="#cb11-3"></a>  <span class="fu">plot</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div id="fig-safrica-countries-2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-safrica-countries-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="11-mapping_rnaturalearth_files/figure-html/fig-safrica-countries-2-1.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-5" title="Figure&nbsp;4: Southern Africa countries shaded by population estimate."><img src="11-mapping_rnaturalearth_files/figure-html/fig-safrica-countries-2-1.svg" class="img-fluid figure-img" style="width:75.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-safrica-countries-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4: Southern Africa countries shaded by population estimate.
</figcaption></figure>
</div>
</div>
</div>
<p>The names of the countries are in the rows of the <code>safrica_countries</code> object, and so they become accessible with <code><a href="https://rdrr.io/r/stats/filter.html">filter()</a></code>. Let us only plot some attribute for South Africa:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a>safrica_countries <span class="sc">|&gt;</span> </span>
<span id="cb12-2"><a href="#cb12-2"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(sovereignt <span class="sc">==</span> <span class="st">"South Africa"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb12-3"><a href="#cb12-3"></a>  <span class="fu">select</span>(sovereignt) <span class="sc">|&gt;</span> </span>
<span id="cb12-4"><a href="#cb12-4"></a>  <span class="fu">plot</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div id="fig-safrica-countries-3" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-safrica-countries-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="11-mapping_rnaturalearth_files/figure-html/fig-safrica-countries-3-1.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-6" title="Figure&nbsp;5: South Africa feature only (sovereignty filtered)."><img src="11-mapping_rnaturalearth_files/figure-html/fig-safrica-countries-3-1.svg" class="img-fluid figure-img" style="width:75.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-safrica-countries-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5: South Africa feature only (sovereignty filtered).
</figcaption></figure>
</div>
</div>
</div>
</section><section id="dissolve-and-crop-features-geometry-changes" class="level2" data-number="5.4"><h2 data-number="5.4" class="anchored" data-anchor-id="dissolve-and-crop-features-geometry-changes">
<span class="header-section-number">5.4</span> Dissolve and crop features (geometry changes)</h2>
<p>The following sequence is dense, so here is the logic before the code:</p>
<ol type="1">
<li>
<code>group_by(continent)</code> groups features so that later operations can dissolve borders.</li>
<li>
<code>summarise()</code> collapses grouped features into a single geometry per group.</li>
<li>
<code>st_crop(bbox)</code> clips the geometry to your bounding box. This can <em>cut</em> features at the boundary.</li>
<li>
<code>st_combine()</code> merges the pieces into a single multipart feature.</li>
</ol>
<p>Cropping is a geometric operation, but sometimes it may be used as a visual zoom. Features that fall partly inside the box will be clipped.</p>
<p>You can continue to add additional operations to create a new map:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a>safrica_countries_new <span class="ot">&lt;-</span> safrica_countries <span class="sc">|&gt;</span> </span>
<span id="cb13-2"><a href="#cb13-2"></a>  <span class="fu">group_by</span>(continent) <span class="sc">|&gt;</span> </span>
<span id="cb13-3"><a href="#cb13-3"></a>  <span class="fu">summarise</span>() <span class="sc">|&gt;</span> </span>
<span id="cb13-4"><a href="#cb13-4"></a>  <span class="fu">st_crop</span>(bbox) <span class="sc">|&gt;</span></span>
<span id="cb13-5"><a href="#cb13-5"></a>  <span class="fu">st_combine</span>()</span>
<span id="cb13-6"><a href="#cb13-6"></a></span>
<span id="cb13-7"><a href="#cb13-7"></a><span class="fu">plot</span>(safrica_countries_new)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div id="fig-safrica-countries-new-safrica-countries" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-safrica-countries-new-safrica-countries-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="11-mapping_rnaturalearth_files/figure-html/fig-safrica-countries-new-safrica-countries-1.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-7" title="Figure&nbsp;6: Dissolved and cropped Southern Africa geometry."><img src="11-mapping_rnaturalearth_files/figure-html/fig-safrica-countries-new-safrica-countries-1.svg" class="img-fluid figure-img" style="width:75.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-safrica-countries-new-safrica-countries-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6: Dissolved and cropped Southern Africa geometry.
</figcaption></figure>
</div>
</div>
</div>
<p>So far you have relied on the base R plot function made for simple features. You can also plot the map in <strong>ggplot2</strong> using <code>ggplot()</code>, which treats geometry as data rather than annotation. Here, <code>geom_sf()</code> draws the features and <code>coord_sf()</code> manages the spatial coordinates and aspect ratio. This is why <code>coord_sf()</code> is preferred to <code>coord_cartesian()</code> for maps.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb14-2"><a href="#cb14-2"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> safrica_countries,</span>
<span id="cb14-3"><a href="#cb14-3"></a>    <span class="at">colour =</span> <span class="st">"indianred"</span>, <span class="at">fill =</span> <span class="st">"beige"</span>) <span class="sc">+</span></span>
<span id="cb14-4"><a href="#cb14-4"></a>  <span class="fu">coord_sf</span>(<span class="at">xlim =</span> xlim,</span>
<span id="cb14-5"><a href="#cb14-5"></a>           <span class="at">ylim =</span> ylim)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div id="fig-ggplot" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-ggplot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="11-mapping_rnaturalearth_files/figure-html/fig-ggplot-1.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-8" title="Figure&nbsp;7: Southern Africa map drawn with ggplot2 and geom_sf."><img src="11-mapping_rnaturalearth_files/figure-html/fig-ggplot-1.svg" class="img-fluid figure-img" style="width:75.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ggplot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7: Southern Africa map drawn with ggplot2 and geom_sf.
</figcaption></figure>
</div>
</div>
</div>
</section><section id="buffering-and-geometry-assumptions" class="level2" data-number="5.5"><h2 data-number="5.5" class="anchored" data-anchor-id="buffering-and-geometry-assumptions">
<span class="header-section-number">5.5</span> Buffering and geometry assumptions</h2>
<p>Now you can layer another feature. This is also where geometry assumptions matter: buffering in degrees is only a rough approximation for local maps.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a>buffer <span class="ot">&lt;-</span> safrica_countries_new <span class="sc">%&gt;%</span></span>
<span id="cb15-2"><a href="#cb15-2"></a>  <span class="fu">st_buffer</span>(<span class="fl">0.4</span>)</span>
<span id="cb15-3"><a href="#cb15-3"></a></span>
<span id="cb15-4"><a href="#cb15-4"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb15-5"><a href="#cb15-5"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> buffer, <span class="at">fill =</span> <span class="st">"lightblue"</span>, <span class="at">col =</span> <span class="st">"transparent"</span>) <span class="sc">+</span></span>
<span id="cb15-6"><a href="#cb15-6"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> safrica_countries, <span class="at">colour =</span> <span class="st">"indianred"</span>, <span class="at">fill =</span> <span class="st">"beige"</span>) <span class="sc">+</span></span>
<span id="cb15-7"><a href="#cb15-7"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div id="fig-buffer-safrica-countries-new" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-buffer-safrica-countries-new-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="11-mapping_rnaturalearth_files/figure-html/fig-buffer-safrica-countries-new-1.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-9" title="Figure&nbsp;8: Buffered Southern Africa geometry overlaid on the original map."><img src="11-mapping_rnaturalearth_files/figure-html/fig-buffer-safrica-countries-new-1.svg" class="img-fluid figure-img" style="width:75.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-buffer-safrica-countries-new-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;8: Buffered Southern Africa geometry overlaid on the original map.
</figcaption></figure>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Warning</span>Distances are not degrees
</div>
</div>
<div class="callout-body-container callout-body">
<p>If a buffer value “looks right” in degrees, that is an accident of scale. For accurate distances, project your data first and buffer in metres.</p>
</div>
</div>
</section></section><section id="a-reusable-workflow" class="level1" data-number="6"><h1 data-number="6">
<span class="header-section-number">6</span> A Reusable Workflow</h1>
<p>When you start from scratch, use this quick recipe:</p>
<ol type="1">
<li>Load spatial data and check <code>st_crs()</code> and geometry types.</li>
<li>Filter features (rows) and select attributes (columns) deliberately.</li>
<li>Crop or transform geometry only when you intend to change shape.</li>
<li>Plot with <code><a href="https://rdrr.io/r/graphics/plot.default.html">plot()</a></code> or <strong>ggplot2</strong>; add layers and styling last.</li>
</ol>
<div class="callout callout-style-simple callout-caution callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Caution</span>Common pitfalls to watch for
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>Buffering or measuring in degrees instead of projected units.</li>
<li>Cropping after styling, which hides clipped features or labels.</li>
<li>Assuming <code>select()</code> or <code>summarise()</code> recalculates geometry.</li>
<li>Using <code>coord_cartesian()</code> for maps and silently distorting aspect ratio.</li>
<li>Treating Natural Earth borders as definitive boundaries when precision matters.</li>
</ul>
</div>
</div>
</section><section id="example" class="level1" data-number="7"><h1 data-number="7">
<span class="header-section-number">7</span> Example</h1>
<p>Here are examples that use the built-in <a href="../../BCB744/intro_r/12-mapping_quakes.html">Fiji earthquake data</a> or the <a href="../../pages/kaggle_earthquakes.html">Kaggle earthquake data</a>.</p>


<!-- -->

</section><div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-reuse"><h2 class="anchored quarto-appendix-heading">Reuse</h2><div class="quarto-appendix-contents"><div><a rel="license" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a></div></div></section><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{smit,_a._j.2021,
  author = {Smit, A. J.,},
  title = {11. {Mapping} with {Natural} {Earth}},
  date = {2021-01-01},
  url = {http://tangledbank.netlify.app/BCB744/intro_r/11-mapping_rnaturalearth.html},
  langid = {en}
}
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-smit,_a._j.2021" class="csl-entry quarto-appendix-citeas" role="listitem">
Smit, A. J. (2021) 11. Mapping with Natural Earth. <a href="http://tangledbank.netlify.app/BCB744/intro_r/11-mapping_rnaturalearth.html">http://tangledbank.netlify.app/BCB744/intro_r/11-mapping_rnaturalearth.html.
</a>
</div></div></section></div></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
    const viewSource = window.document.getElementById('quarto-view-source') ||
                       window.document.getElementById('quarto-code-tools-source');
    if (viewSource) {
      const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
      viewSource.addEventListener("click", function(e) {
        if (sourceUrl) {
          // rstudio viewer pane
          if (/\bcapabilities=\b/.test(window.location)) {
            window.open(sourceUrl);
          } else {
            window.location.href = sourceUrl;
          }
        } else {
          const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
          modal.show();
        }
        return false;
      });
    }
    function toggleCodeHandler(show) {
      return function(e) {
        const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
        for (let i=0; i<detailsSrc.length; i++) {
          const details = detailsSrc[i].parentElement;
          if (show) {
            details.open = true;
          } else {
            details.removeAttribute("open");
          }
        }
        const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
        const fromCls = show ? "hidden" : "unhidden";
        const toCls = show ? "unhidden" : "hidden";
        for (let i=0; i<cellCodeDivs.length; i++) {
          const codeDiv = cellCodeDivs[i];
          if (codeDiv.classList.contains(fromCls)) {
            codeDiv.classList.remove(fromCls);
            codeDiv.classList.add(toCls);
          } 
        }
        return false;
      }
    }
    const hideAllCode = window.document.getElementById("quarto-hide-all-code");
    if (hideAllCode) {
      hideAllCode.addEventListener("click", toggleCodeHandler(false));
    }
    const showAllCode = window.document.getElementById("quarto-show-all-code");
    if (showAllCode) {
      showAllCode.addEventListener("click", toggleCodeHandler(true));
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("http:\/\/tangledbank\.netlify\.app");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
            // target, if specified
            link.setAttribute("target", "_blank");
            if (link.getAttribute("rel") === null) {
              link.setAttribute("rel", "noopener");
            }
            // default icon
            link.classList.add("external");
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="../../BCB744/intro_r/10-mapping_style.html" class="pagination-link" aria-label="10. Mapping with Style">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">10. Mapping with Style</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../../BCB744/intro_r/12-mapping_quakes.html" class="pagination-link" aria-label="12. The Fiji Earthquake Data">
        <span class="nav-page-text">12. The Fiji Earthquake Data</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb16" data-shortcodes="false"><pre class="sourceCode numberSource markdown number-lines code-with-copy"><code class="sourceCode markdown"><span id="cb16-1"><a href="#cb16-1"></a><span class="co">---</span></span>
<span id="cb16-2"><a href="#cb16-2"></a><span class="an">date:</span><span class="co"> "2021-01-01"</span></span>
<span id="cb16-3"><a href="#cb16-3"></a><span class="an">title:</span><span class="co"> "11. Mapping with Natural Earth"</span></span>
<span id="cb16-4"><a href="#cb16-4"></a><span class="co">---</span></span>
<span id="cb16-5"><a href="#cb16-5"></a></span>
<span id="cb16-6"><a href="#cb16-6"></a><span class="in">```{r code-brewing-opts, echo=FALSE}</span></span>
<span id="cb16-7"><a href="#cb16-7"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(</span>
<span id="cb16-8"><a href="#cb16-8"></a>  <span class="at">comment =</span> <span class="st">"R&gt;"</span>, </span>
<span id="cb16-9"><a href="#cb16-9"></a>  <span class="at">warning =</span> <span class="cn">FALSE</span>, </span>
<span id="cb16-10"><a href="#cb16-10"></a>  <span class="at">message =</span> <span class="cn">FALSE</span>,</span>
<span id="cb16-11"><a href="#cb16-11"></a>  <span class="at">fig.width =</span> <span class="fl">4.5</span>,</span>
<span id="cb16-12"><a href="#cb16-12"></a>  <span class="at">fig.height =</span> <span class="fl">2.625</span>,</span>
<span id="cb16-13"><a href="#cb16-13"></a>  <span class="at">out.width =</span> <span class="st">"75%"</span>,</span>
<span id="cb16-14"><a href="#cb16-14"></a>  <span class="at">fig.asp =</span> <span class="cn">NULL</span>, <span class="co"># control via width/height</span></span>
<span id="cb16-15"><a href="#cb16-15"></a>  <span class="at">dpi =</span> <span class="dv">300</span></span>
<span id="cb16-16"><a href="#cb16-16"></a>)</span>
<span id="cb16-17"><a href="#cb16-17"></a></span>
<span id="cb16-18"><a href="#cb16-18"></a>ggplot2<span class="sc">::</span><span class="fu">theme_set</span>(</span>
<span id="cb16-19"><a href="#cb16-19"></a>  ggplot2<span class="sc">::</span><span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">8</span>)</span>
<span id="cb16-20"><a href="#cb16-20"></a>)</span>
<span id="cb16-21"><a href="#cb16-21"></a>ggplot2<span class="sc">::</span><span class="fu">theme_set</span>(</span>
<span id="cb16-22"><a href="#cb16-22"></a>  ggplot2<span class="sc">::</span><span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">8</span>)</span>
<span id="cb16-23"><a href="#cb16-23"></a>)</span>
<span id="cb16-24"><a href="#cb16-24"></a><span class="in">```</span></span>
<span id="cb16-25"><a href="#cb16-25"></a></span>
<span id="cb16-26"><a href="#cb16-26"></a><span class="al">![A reminder that names and classifications matter.](../../images/thesaurus.jpg)</span>{width=75%}</span>
<span id="cb16-27"><a href="#cb16-27"></a></span>
<span id="cb16-28"><a href="#cb16-28"></a></span>
<span id="cb16-29"><a href="#cb16-29"></a><span class="at">&gt; "*In the beginning there was nothing, which exploded.*"</span></span>
<span id="cb16-30"><a href="#cb16-30"></a><span class="at">&gt;</span></span>
<span id="cb16-31"><a href="#cb16-31"></a><span class="at">&gt; --- Terry Pratchett</span></span>
<span id="cb16-32"><a href="#cb16-32"></a></span>
<span id="cb16-33"><a href="#cb16-33"></a><span class="at">&gt; "*Biology is the study of complicated things that have the appearance of having been designed with a purpose.*"</span></span>
<span id="cb16-34"><a href="#cb16-34"></a><span class="at">&gt;</span></span>
<span id="cb16-35"><a href="#cb16-35"></a><span class="at">&gt; --- Richard Dawkins</span></span>
<span id="cb16-36"><a href="#cb16-36"></a></span>
<span id="cb16-37"><a href="#cb16-37"></a><span class="fu"># Orientation: What You Are Here to Learn</span></span>
<span id="cb16-38"><a href="#cb16-38"></a></span>
<span id="cb16-39"><a href="#cb16-39"></a>Up to now, your maps have likely been *drawn* rather than *reasoned about*. This chapter shifts you from decorative mapping to spatial reasoning with data structures that carry geometry, scale, and assumptions. The goal is to make them more defensible.</span>
<span id="cb16-40"><a href="#cb16-40"></a></span>
<span id="cb16-41"><a href="#cb16-41"></a><span class="fu">## Learning goals</span></span>
<span id="cb16-42"><a href="#cb16-42"></a>By the end of this chapter you should be able to:</span>
<span id="cb16-43"><a href="#cb16-43"></a></span>
<span id="cb16-44"><a href="#cb16-44"></a><span class="ss">1. </span>Explain what an <span class="in">`sf`</span> object is (features, attributes, geometry column, CRS).</span>
<span id="cb16-45"><a href="#cb16-45"></a><span class="ss">2. </span>Subset and transform spatial features without losing geometry.</span>
<span id="cb16-46"><a href="#cb16-46"></a><span class="ss">3. </span>Produce layered maps in base R and **ggplot2** with explicit spatial choices.</span>
<span id="cb16-47"><a href="#cb16-47"></a></span>
<span id="cb16-48"><a href="#cb16-48"></a><span class="fu">## Workflow overview</span></span>
<span id="cb16-49"><a href="#cb16-49"></a>When you are working independently, aim for this repeatable sequence:</span>
<span id="cb16-50"><a href="#cb16-50"></a></span>
<span id="cb16-51"><a href="#cb16-51"></a><span class="ss">1. </span>Load data and inspect the geometry and CRS.</span>
<span id="cb16-52"><a href="#cb16-52"></a><span class="ss">2. </span>Subset features (rows) and attributes (columns) intentionally.</span>
<span id="cb16-53"><a href="#cb16-53"></a><span class="ss">3. </span>Crop or transform geometry only when you mean to.</span>
<span id="cb16-54"><a href="#cb16-54"></a><span class="ss">4. </span>Plot in base R or **ggplot2**, then refine.</span>
<span id="cb16-55"><a href="#cb16-55"></a></span>
<span id="cb16-56"><a href="#cb16-56"></a><span class="fu">## Web resources for spatial work in R</span></span>
<span id="cb16-57"><a href="#cb16-57"></a>These are reference texts, not required reading. Use them as technical back-up when you get stuck or want to go deeper.</span>
<span id="cb16-58"><a href="#cb16-58"></a></span>
<span id="cb16-59"><a href="#cb16-59"></a>::: {.callout-note appearance="simple"}</span>
<span id="cb16-60"><a href="#cb16-60"></a><span class="fu">## Web resources about spatial methods in R</span></span>
<span id="cb16-61"><a href="#cb16-61"></a><span class="pp">|</span> Author                      <span class="pp">|</span> Title                                                                                                             <span class="pp">|</span></span>
<span id="cb16-62"><a href="#cb16-62"></a><span class="pp">|:---------------------------|:------------------------------------------------------------------------------------------------------------------|</span></span>
<span id="cb16-63"><a href="#cb16-63"></a><span class="pp">|</span> **Spatial R**               <span class="pp">|</span>                                                                                                                   <span class="pp">|</span></span>
<span id="cb16-64"><a href="#cb16-64"></a><span class="pp">|</span> Edzer Pebesma               <span class="pp">|</span> <span class="co">[</span><span class="ot">Simple Features for R</span><span class="co">](https://r-spatial.github.io/sf/index.html)</span>                                                <span class="pp">|</span></span>
<span id="cb16-65"><a href="#cb16-65"></a><span class="pp">|</span> Edzer Pebesma, Roger Bivand <span class="pp">|</span> <span class="co">[</span><span class="ot">Spatial Data Science with applications in R</span><span class="co">](https://r-spatial.org/book/)</span>                                        <span class="pp">|</span></span>
<span id="cb16-66"><a href="#cb16-66"></a><span class="pp">|</span> Robin Lovelace et al.       <span class="pp">|</span> <span class="co">[</span><span class="ot">Geocomputation with R</span><span class="co">](https://geocompr.robinlovelace.net/index.html)</span>                                            <span class="pp">|</span></span>
<span id="cb16-67"><a href="#cb16-67"></a><span class="pp">|</span> Manuel Gimond               <span class="pp">|</span> <span class="co">[</span><span class="ot">Intro to GIS and Spatial Analysis</span><span class="co">](https://mgimond.github.io/Spatial/index.html)</span>                                 <span class="pp">|</span></span>
<span id="cb16-68"><a href="#cb16-68"></a><span class="pp">|</span> Wasser et al.               <span class="pp">|</span> <span class="co">[</span><span class="ot">Introduction to Geospatial Raster and Vector Data with R</span><span class="co">](https://datacarpentry.org/r-raster-vector-geospatial/)</span> <span class="pp">|</span></span>
<span id="cb16-69"><a href="#cb16-69"></a><span class="pp">|</span> Taro Mieno                  <span class="pp">|</span> <span class="co">[</span><span class="ot">R as GIS for Economists</span><span class="co">](https://tmieno2.github.io/R-as-GIS-for-Economists/)</span>                                     <span class="pp">|</span></span>
<span id="cb16-70"><a href="#cb16-70"></a>:::</span>
<span id="cb16-71"><a href="#cb16-71"></a></span>
<span id="cb16-72"><a href="#cb16-72"></a></span>
<span id="cb16-73"><a href="#cb16-73"></a></span>
<span id="cb16-74"><a href="#cb16-74"></a><span class="in">```{r code-ggmap-opts, echo=FALSE}</span></span>
<span id="cb16-75"><a href="#cb16-75"></a><span class="co">#| eval: true</span></span>
<span id="cb16-76"><a href="#cb16-76"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(</span>
<span id="cb16-77"><a href="#cb16-77"></a>  <span class="at">comment =</span> <span class="st">"R&gt;"</span>, </span>
<span id="cb16-78"><a href="#cb16-78"></a>  <span class="at">warning =</span> <span class="cn">FALSE</span>, </span>
<span id="cb16-79"><a href="#cb16-79"></a>  <span class="at">message =</span> <span class="cn">FALSE</span></span>
<span id="cb16-80"><a href="#cb16-80"></a>)</span>
<span id="cb16-81"><a href="#cb16-81"></a><span class="in">```</span></span>
<span id="cb16-82"><a href="#cb16-82"></a></span>
<span id="cb16-83"><a href="#cb16-83"></a><span class="fu">## What to Aspire to</span></span>
<span id="cb16-84"><a href="#cb16-84"></a></span>
<span id="cb16-85"><a href="#cb16-85"></a>Please see the snooty maps at <span class="co">[</span><span class="ot">Making Static Maps in R</span><span class="co">](https://bedeffinianrowedavies.com/intermediatertutorials/makingmaps)</span>. The skills you acquire in this module should eventually allow you to do similar maps.</span>
<span id="cb16-86"><a href="#cb16-86"></a></span>
<span id="cb16-87"><a href="#cb16-87"></a><span class="fu"># The **sf** Package</span></span>
<span id="cb16-88"><a href="#cb16-88"></a></span>
<span id="cb16-89"><a href="#cb16-89"></a>At this point you need data structures that carry geometry and behave sensibly under spatial operations. The <span class="co">[</span><span class="ot">**sf**</span><span class="co">](https://r-spatial.github.io/sf/)</span> package provides exactly that, and it has become the *de facto* tool for many mapping applications, replacing older packages such as **sp**. It provides classes for storing and manipulating simple feature geometries and functions for working with spatial data. *Simple features* refer to a standardised way of encoding vector data --- points, lines, and polygons --- used widely in GIS.</span>
<span id="cb16-90"><a href="#cb16-90"></a></span>
<span id="cb16-91"><a href="#cb16-91"></a>The **sf** package was created to provide a fast and efficient way to work with vector data in R. It integrates with other **tidyverse** packages, such as **dplyr** and **ggplot2**, allowing for seamless processing and visualisation of spatial data. The package provides a variety of functions for data import, transformation, manipulation, and analysis, making it a valuable tool for working with spatial data in R.</span>
<span id="cb16-92"><a href="#cb16-92"></a></span>
<span id="cb16-93"><a href="#cb16-93"></a>In addition to its core functionality, the **sf** package also provides a set of methods for converting between different data representations, such as data frames, matrices, and lists, making it a versatile tool for working with spatial data in a variety of formats.</span>
<span id="cb16-94"><a href="#cb16-94"></a></span>
<span id="cb16-95"><a href="#cb16-95"></a>While **sf** works with vector data, raster data require the well-known but older [**raster**](https://rspatial.org/raster/pkg/index.html) package, or its modern replacements [**terra**](https://rspatial.org/pkg/index.html), [**stars**](https://r-spatial.github.io/stars/). I will not work with raster data in this chapter.</span>
<span id="cb16-96"><a href="#cb16-96"></a></span>
<span id="cb16-97"><a href="#cb16-97"></a><span class="fu"># Maps With **rnaturalearth**</span></span>
<span id="cb16-98"><a href="#cb16-98"></a></span>
<span id="cb16-99"><a href="#cb16-99"></a><span class="co">[</span><span class="ot">Natural Earth</span><span class="co">](https://www.naturalearthdata.com/)</span> is a public domain map dataset that provides high-quality, general-purpose base maps for the world at various scales. It is an ideal stepping stone when <span class="in">`map_data()`</span> and hand-drawn polygons become too crude or too brittle for serious work. It was designed to be a visually pleasing alternative to other public domain datasets, and its creators aim to provide the data in a form that is useful for a wide range of applications, to make it easy to use and integrate with other data.</span>
<span id="cb16-100"><a href="#cb16-100"></a></span>
<span id="cb16-101"><a href="#cb16-101"></a>The dataset includes a variety of geographic features, including coastlines, rivers, lakes, and political boundaries, as well as cultural features like cities, roads, and railways. The data are available in several formats, including vector and raster, and they can be used with a variety of software, including GIS and mapping applications. Within R we can access these map layers using the <span class="co">[</span><span class="ot">**rnaturalearth**</span><span class="co">](https://cran.r-project.org/web/packages/rnaturalearth/vignettes/rnaturalearth.html)</span> package.</span>
<span id="cb16-102"><a href="#cb16-102"></a></span>
<span id="cb16-103"><a href="#cb16-103"></a>One of the key benefits of Natural Earth is its public domain status, which means that anyone can use, distribute the data without restrictions or licensing fees. This makes it an ideal choice for individuals who need high-quality base maps for their projects but may not have the resources or expertise to create them from scratch. I am not convinced that students actually read this. The first person to send me a WhatsApp mentioning the phrase "Know your maps" will get a Lindt chocolate.</span>
<span id="cb16-104"><a href="#cb16-104"></a></span>
<span id="cb16-105"><a href="#cb16-105"></a>In addition to its public domain status, Natural Earth is regularly updated with new data to ensure that the maps remain accurate and up to date. This makes it a valuable resource for anyone who needs reliable geographic data.</span>
<span id="cb16-106"><a href="#cb16-106"></a></span>
<span id="cb16-107"><a href="#cb16-107"></a><span class="fu"># Install Packages and Set Things Up</span></span>
<span id="cb16-108"><a href="#cb16-108"></a></span>
<span id="cb16-109"><a href="#cb16-109"></a><span class="in">```{r code-library-tidyverse}</span></span>
<span id="cb16-110"><a href="#cb16-110"></a><span class="co">#| eval: true</span></span>
<span id="cb16-111"><a href="#cb16-111"></a><span class="co">#| message: false</span></span>
<span id="cb16-112"><a href="#cb16-112"></a><span class="co">#| warning: false</span></span>
<span id="cb16-113"><a href="#cb16-113"></a><span class="co"># install.packages("rnaturalearth", "rnaturalearthdata", "sf")</span></span>
<span id="cb16-114"><a href="#cb16-114"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb16-115"><a href="#cb16-115"></a><span class="fu">library</span>(sf)</span>
<span id="cb16-116"><a href="#cb16-116"></a><span class="fu">library</span>(rnaturalearth)</span>
<span id="cb16-117"><a href="#cb16-117"></a><span class="fu">library</span>(rnaturalearthdata)</span>
<span id="cb16-118"><a href="#cb16-118"></a></span>
<span id="cb16-119"><a href="#cb16-119"></a><span class="co"># for the buffer to work as I expect, switch off</span></span>
<span id="cb16-120"><a href="#cb16-120"></a><span class="co"># the functions for spherical geometry:</span></span>
<span id="cb16-121"><a href="#cb16-121"></a><span class="fu">sf_use_s2</span>(<span class="cn">FALSE</span>)</span>
<span id="cb16-122"><a href="#cb16-122"></a><span class="in">```</span></span>
<span id="cb16-123"><a href="#cb16-123"></a></span>
<span id="cb16-124"><a href="#cb16-124"></a>::: {.callout-warning appearance="simple"}</span>
<span id="cb16-125"><a href="#cb16-125"></a><span class="fu">## Geometry assumptions and `sf_use_s2()`</span></span>
<span id="cb16-126"><a href="#cb16-126"></a>The <span class="in">`s2`</span> engine treats the Earth as a sphere. Some operations --- notably buffering --- behave differently under spherical versus planar assumptions. Turning <span class="in">`s2`</span> off can be useful for small regional maps, but it does **not** make distances in degrees suddenly meaningful. If you need accurate distances, use a projected CRS and keep <span class="in">`s2`</span> on.</span>
<span id="cb16-127"><a href="#cb16-127"></a>:::</span>
<span id="cb16-128"><a href="#cb16-128"></a></span>
<span id="cb16-129"><a href="#cb16-129"></a><span class="fu">## Define a working extent</span></span>
<span id="cb16-130"><a href="#cb16-130"></a>First, I define the extent of the map region:</span>
<span id="cb16-131"><a href="#cb16-131"></a></span>
<span id="cb16-132"><a href="#cb16-132"></a><span class="in">```{r code-xmin-ymin-xmax-ymax}</span></span>
<span id="cb16-133"><a href="#cb16-133"></a><span class="co">#| eval: true</span></span>
<span id="cb16-134"><a href="#cb16-134"></a><span class="co"># the full map extent:</span></span>
<span id="cb16-135"><a href="#cb16-135"></a>xmin <span class="ot">&lt;-</span> <span class="dv">12</span>; ymin <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">36.5</span>; xmax <span class="ot">&lt;-</span> <span class="fl">40.5</span>; ymax <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">10</span></span>
<span id="cb16-136"><a href="#cb16-136"></a>xlim <span class="ot">&lt;-</span> <span class="fu">c</span>(xmin, xmax); ylim <span class="ot">&lt;-</span> <span class="fu">c</span>(ymin, ymax)</span>
<span id="cb16-137"><a href="#cb16-137"></a></span>
<span id="cb16-138"><a href="#cb16-138"></a><span class="co"># make a bounding box for cropping:</span></span>
<span id="cb16-139"><a href="#cb16-139"></a>bbox <span class="ot">&lt;-</span> <span class="fu">st_bbox</span>(<span class="fu">c</span>(<span class="at">xmin =</span> xmin, <span class="at">ymin =</span> ymin,</span>
<span id="cb16-140"><a href="#cb16-140"></a>  <span class="at">xmax =</span> xmax, <span class="at">ymax =</span> ymax))</span>
<span id="cb16-141"><a href="#cb16-141"></a></span>
<span id="cb16-142"><a href="#cb16-142"></a><span class="co"># might be useful for zooming into a smaller region (False Bay and </span></span>
<span id="cb16-143"><a href="#cb16-143"></a><span class="co"># the Cape Peninsula):</span></span>
<span id="cb16-144"><a href="#cb16-144"></a>xlim_zoom <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">17.8</span>, <span class="dv">19</span>); ylim_zoom <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">34.5</span>, <span class="sc">-</span><span class="fl">33.2</span>)</span>
<span id="cb16-145"><a href="#cb16-145"></a><span class="in">```</span></span>
<span id="cb16-146"><a href="#cb16-146"></a></span>
<span id="cb16-147"><a href="#cb16-147"></a>Choosing bounds is a cartographic decision. If you clip too tightly you can hide relevant context; if you clip too loosely you dilute the focus of the map. Cropping can also cut features that cross the boundary (and cuase complications, which are very difficult to rectify), so use it deliberately.</span>
<span id="cb16-148"><a href="#cb16-148"></a></span>
<span id="cb16-149"><a href="#cb16-149"></a><span class="fu"># Create and Inspect an `sf` Object</span></span>
<span id="cb16-150"><a href="#cb16-150"></a></span>
<span id="cb16-151"><a href="#cb16-151"></a>Before we draw anything, we will load a spatial object, then *inspect* it. This is the point where your thinking should shift from "plots" to "features with geometry".</span>
<span id="cb16-152"><a href="#cb16-152"></a></span>
<span id="cb16-153"><a href="#cb16-153"></a><span class="fu">## Load features from Natural Earth</span></span>
<span id="cb16-154"><a href="#cb16-154"></a></span>
<span id="cb16-155"><a href="#cb16-155"></a><span class="in">```{r code-safrica-countries-ne-countries-returnclass-sf}</span></span>
<span id="cb16-156"><a href="#cb16-156"></a><span class="co">#| eval: true</span></span>
<span id="cb16-157"><a href="#cb16-157"></a><span class="co"># load the countries:</span></span>
<span id="cb16-158"><a href="#cb16-158"></a>safrica_countries <span class="ot">&lt;-</span> <span class="fu">ne_countries</span>(<span class="at">returnclass =</span> <span class="st">'sf'</span>,</span>
<span id="cb16-159"><a href="#cb16-159"></a>  <span class="at">continent =</span> <span class="st">"Africa"</span>,</span>
<span id="cb16-160"><a href="#cb16-160"></a>  <span class="at">country =</span> <span class="fu">c</span>(<span class="st">"South Africa"</span>, <span class="st">"Mozambique"</span>,</span>
<span id="cb16-161"><a href="#cb16-161"></a>    <span class="st">"Namibia"</span>, <span class="st">"Zimbabwe"</span>, <span class="st">"Botswana"</span>,</span>
<span id="cb16-162"><a href="#cb16-162"></a>    <span class="st">"Lesotho"</span>, <span class="st">"Eswatini"</span>),</span>
<span id="cb16-163"><a href="#cb16-163"></a>  <span class="at">scale =</span> <span class="st">"large"</span>)</span>
<span id="cb16-164"><a href="#cb16-164"></a><span class="in">```</span></span>
<span id="cb16-165"><a href="#cb16-165"></a></span>
<span id="cb16-166"><a href="#cb16-166"></a>The object now contains *features* (rows) with *attributes* (columns) plus a geometry column that stores the spatial shapes. That geometry persists unless you explicitly alter it.</span>
<span id="cb16-167"><a href="#cb16-167"></a></span>
<span id="cb16-168"><a href="#cb16-168"></a><span class="fu">## Inspect the geometry and CRS</span></span>
<span id="cb16-169"><a href="#cb16-169"></a>Pause here and check what makes this different from a normal tibble.</span>
<span id="cb16-170"><a href="#cb16-170"></a></span>
<span id="cb16-171"><a href="#cb16-171"></a><span class="in">```{r code-class-safrica-countries}</span></span>
<span id="cb16-172"><a href="#cb16-172"></a><span class="co">#| eval: true</span></span>
<span id="cb16-173"><a href="#cb16-173"></a><span class="fu">class</span>(safrica_countries)</span>
<span id="cb16-174"><a href="#cb16-174"></a><span class="co"># safrica_countries</span></span>
<span id="cb16-175"><a href="#cb16-175"></a><span class="in">```</span></span>
<span id="cb16-176"><a href="#cb16-176"></a></span>
<span id="cb16-177"><a href="#cb16-177"></a>::: {.callout-note appearance="simple"}</span>
<span id="cb16-178"><a href="#cb16-178"></a><span class="fu">## The `sf` Class</span></span>
<span id="cb16-179"><a href="#cb16-179"></a><span class="in">`sf`</span> indicates that the object is of class *simple features*. In **sf** language, what would be called columns (variables) in normal **tidyverse** speak becomes known as *attributes* --- these are the properties of the map *features*. The geometry column stores the shapes; the CRS stores the spatial reference system.</span>
<span id="cb16-180"><a href="#cb16-180"></a>:::</span>
<span id="cb16-181"><a href="#cb16-181"></a></span>
<span id="cb16-182"><a href="#cb16-182"></a><span class="in">```{r code-inspect-safrica-countries}</span></span>
<span id="cb16-183"><a href="#cb16-183"></a><span class="co">#| eval: false</span></span>
<span id="cb16-184"><a href="#cb16-184"></a></span>
<span id="cb16-185"><a href="#cb16-185"></a><span class="co"># Run this on your PC... the output is too voluminous for here</span></span>
<span id="cb16-186"><a href="#cb16-186"></a><span class="fu">glimpse</span>(safrica_countries)</span>
<span id="cb16-187"><a href="#cb16-187"></a><span class="fu">st_crs</span>(safrica_countries)</span>
<span id="cb16-188"><a href="#cb16-188"></a><span class="fu">unique</span>(<span class="fu">st_geometry_type</span>(safrica_countries))</span>
<span id="cb16-189"><a href="#cb16-189"></a><span class="in">```</span></span>
<span id="cb16-190"><a href="#cb16-190"></a></span>
<span id="cb16-191"><a href="#cb16-191"></a>The CRS tells you how the coordinates should be interpreted. You do not need to manipulate CRS yet, but you do need to be aware that distance and area calculations depend on it.</span>
<span id="cb16-192"><a href="#cb16-192"></a></span>
<span id="cb16-193"><a href="#cb16-193"></a>As you can see, it is a <span class="in">`data.frame`</span> and <span class="in">`tbl`</span> (tibble), amongst other classes, and so you can apply many of the **tidyverse** functions to it, including `select()`, `filter()`, `summarise()` and so on. These verbs act on *attributes* unless you explicitly change geometry with **sf** functions.</span>
<span id="cb16-194"><a href="#cb16-194"></a></span>
<span id="cb16-195"><a href="#cb16-195"></a><span class="fu">## Plot quickly in base R</span></span>
<span id="cb16-196"><a href="#cb16-196"></a>Let us plot the entire <span class="in">`safrica_countries`</span> object to see all the attributes of all of the features. This kind of figure is called a choropleth map:</span>
<span id="cb16-197"><a href="#cb16-197"></a></span>
<span id="cb16-198"><a href="#cb16-198"></a><span class="in">```{r fig-plot-safrica-countries}</span></span>
<span id="cb16-199"><a href="#cb16-199"></a><span class="co">#| fig-cap: "Southern Africa countries shown as a base R choropleth."</span></span>
<span id="cb16-200"><a href="#cb16-200"></a><span class="co">#| eval: true</span></span>
<span id="cb16-201"><a href="#cb16-201"></a><span class="fu">plot</span>(safrica_countries)</span>
<span id="cb16-202"><a href="#cb16-202"></a><span class="in">```</span></span>
<span id="cb16-203"><a href="#cb16-203"></a></span>
<span id="cb16-204"><a href="#cb16-204"></a>::: {.callout-tip appearance="simple"}</span>
<span id="cb16-205"><a href="#cb16-205"></a><span class="fu">## Attributes vs features (select vs filter)</span></span>
<span id="cb16-206"><a href="#cb16-206"></a>Use <span class="in">`select()`</span> to choose *attributes* (columns). Use `filter()` to choose *features* (rows). Neither operation recalculates geometry; the shapes persist unless you explicitly transform them.</span>
<span id="cb16-207"><a href="#cb16-207"></a>:::</span>
<span id="cb16-208"><a href="#cb16-208"></a></span>
<span id="cb16-209"><a href="#cb16-209"></a>You probably do not want to plot all of them. Let us select one:</span>
<span id="cb16-210"><a href="#cb16-210"></a></span>
<span id="cb16-211"><a href="#cb16-211"></a><span class="in">```{r fig-plot-safrica-countries-sovereignt}</span></span>
<span id="cb16-212"><a href="#cb16-212"></a><span class="co">#| fig-cap: "Southern Africa countries shaded by sovereignty."</span></span>
<span id="cb16-213"><a href="#cb16-213"></a><span class="co">#| eval: true</span></span>
<span id="cb16-214"><a href="#cb16-214"></a><span class="fu">plot</span>(safrica_countries[<span class="st">"sovereignt"</span>])</span>
<span id="cb16-215"><a href="#cb16-215"></a><span class="in">```</span></span>
<span id="cb16-216"><a href="#cb16-216"></a></span>
<span id="cb16-217"><a href="#cb16-217"></a>You might achieve the same in a more familiar way:</span>
<span id="cb16-218"><a href="#cb16-218"></a></span>
<span id="cb16-219"><a href="#cb16-219"></a><span class="in">```{r fig-safrica-countries}</span></span>
<span id="cb16-220"><a href="#cb16-220"></a><span class="co">#| fig-cap: "Southern Africa countries shaded by sovereignty (select)."</span></span>
<span id="cb16-221"><a href="#cb16-221"></a><span class="co">#| eval: true</span></span>
<span id="cb16-222"><a href="#cb16-222"></a>safrica_countries <span class="sc">|&gt;</span> </span>
<span id="cb16-223"><a href="#cb16-223"></a>  <span class="fu">select</span>(sovereignt) <span class="sc">|&gt;</span> </span>
<span id="cb16-224"><a href="#cb16-224"></a>  <span class="fu">plot</span>()</span>
<span id="cb16-225"><a href="#cb16-225"></a><span class="in">```</span></span>
<span id="cb16-226"><a href="#cb16-226"></a></span>
<span id="cb16-227"><a href="#cb16-227"></a>Or you may want to plot the estimate of the population size, which is contained in the attribute <span class="in">`pop_est`</span>:</span>
<span id="cb16-228"><a href="#cb16-228"></a></span>
<span id="cb16-229"><a href="#cb16-229"></a><span class="in">```{r fig-safrica-countries-2}</span></span>
<span id="cb16-230"><a href="#cb16-230"></a><span class="co">#| fig-cap: "Southern Africa countries shaded by population estimate."</span></span>
<span id="cb16-231"><a href="#cb16-231"></a><span class="co">#| eval: true</span></span>
<span id="cb16-232"><a href="#cb16-232"></a>safrica_countries <span class="sc">|&gt;</span> </span>
<span id="cb16-233"><a href="#cb16-233"></a>  <span class="fu">select</span>(pop_est) <span class="sc">|&gt;</span> </span>
<span id="cb16-234"><a href="#cb16-234"></a>  <span class="fu">plot</span>()</span>
<span id="cb16-235"><a href="#cb16-235"></a><span class="in">```</span></span>
<span id="cb16-236"><a href="#cb16-236"></a></span>
<span id="cb16-237"><a href="#cb16-237"></a>The names of the countries are in the rows of the <span class="in">`safrica_countries`</span> object, and so they become accessible with <span class="in">`filter()`</span>. Let us only plot some attribute for South Africa:</span>
<span id="cb16-238"><a href="#cb16-238"></a></span>
<span id="cb16-239"><a href="#cb16-239"></a><span class="in">```{r fig-safrica-countries-3}</span></span>
<span id="cb16-240"><a href="#cb16-240"></a><span class="co">#| fig-cap: "South Africa feature only (sovereignty filtered)."</span></span>
<span id="cb16-241"><a href="#cb16-241"></a><span class="co">#| eval: true</span></span>
<span id="cb16-242"><a href="#cb16-242"></a>safrica_countries <span class="sc">|&gt;</span> </span>
<span id="cb16-243"><a href="#cb16-243"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(sovereignt <span class="sc">==</span> <span class="st">"South Africa"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb16-244"><a href="#cb16-244"></a>  <span class="fu">select</span>(sovereignt) <span class="sc">|&gt;</span> </span>
<span id="cb16-245"><a href="#cb16-245"></a>  <span class="fu">plot</span>()</span>
<span id="cb16-246"><a href="#cb16-246"></a><span class="in">```</span></span>
<span id="cb16-247"><a href="#cb16-247"></a></span>
<span id="cb16-248"><a href="#cb16-248"></a><span class="fu">## Dissolve and crop features (geometry changes)</span></span>
<span id="cb16-249"><a href="#cb16-249"></a>The following sequence is dense, so here is the logic before the code:</span>
<span id="cb16-250"><a href="#cb16-250"></a></span>
<span id="cb16-251"><a href="#cb16-251"></a><span class="ss">1. </span><span class="in">`group_by(continent)`</span> groups features so that later operations can dissolve borders.</span>
<span id="cb16-252"><a href="#cb16-252"></a><span class="ss">2. </span><span class="in">`summarise()`</span> collapses grouped features into a single geometry per group.</span>
<span id="cb16-253"><a href="#cb16-253"></a><span class="ss">3. </span><span class="in">`st_crop(bbox)`</span> clips the geometry to your bounding box. This can *cut* features at the boundary.</span>
<span id="cb16-254"><a href="#cb16-254"></a><span class="ss">4. </span><span class="in">`st_combine()`</span> merges the pieces into a single multipart feature.</span>
<span id="cb16-255"><a href="#cb16-255"></a></span>
<span id="cb16-256"><a href="#cb16-256"></a>Cropping is a geometric operation, but sometimes it may be used as a visual zoom. Features that fall partly inside the box will be clipped.</span>
<span id="cb16-257"><a href="#cb16-257"></a></span>
<span id="cb16-258"><a href="#cb16-258"></a>You can continue to add additional operations to create a new map:</span>
<span id="cb16-259"><a href="#cb16-259"></a></span>
<span id="cb16-260"><a href="#cb16-260"></a><span class="in">```{r fig-safrica-countries-new-safrica-countries}</span></span>
<span id="cb16-261"><a href="#cb16-261"></a><span class="co">#| fig-cap: "Dissolved and cropped Southern Africa geometry."</span></span>
<span id="cb16-262"><a href="#cb16-262"></a><span class="co">#| eval: true</span></span>
<span id="cb16-263"><a href="#cb16-263"></a>safrica_countries_new <span class="ot">&lt;-</span> safrica_countries <span class="sc">|&gt;</span> </span>
<span id="cb16-264"><a href="#cb16-264"></a>  <span class="fu">group_by</span>(continent) <span class="sc">|&gt;</span> </span>
<span id="cb16-265"><a href="#cb16-265"></a>  <span class="fu">summarise</span>() <span class="sc">|&gt;</span> </span>
<span id="cb16-266"><a href="#cb16-266"></a>  <span class="fu">st_crop</span>(bbox) <span class="sc">|&gt;</span></span>
<span id="cb16-267"><a href="#cb16-267"></a>  <span class="fu">st_combine</span>()</span>
<span id="cb16-268"><a href="#cb16-268"></a></span>
<span id="cb16-269"><a href="#cb16-269"></a><span class="fu">plot</span>(safrica_countries_new)</span>
<span id="cb16-270"><a href="#cb16-270"></a><span class="in">```</span></span>
<span id="cb16-271"><a href="#cb16-271"></a></span>
<span id="cb16-272"><a href="#cb16-272"></a>So far you have relied on the base R plot function made for simple features. You can also plot the map in **ggplot2** using <span class="in">`ggplot()`</span>, which treats geometry as data rather than annotation. Here, <span class="in">`geom_sf()`</span> draws the features and <span class="in">`coord_sf()`</span> manages the spatial coordinates and aspect ratio. This is why <span class="in">`coord_sf()`</span> is preferred to <span class="in">`coord_cartesian()`</span> for maps.</span>
<span id="cb16-273"><a href="#cb16-273"></a></span>
<span id="cb16-274"><a href="#cb16-274"></a><span class="in">```{r fig-ggplot}</span></span>
<span id="cb16-275"><a href="#cb16-275"></a><span class="co">#| fig-cap: "Southern Africa map drawn with ggplot2 and geom_sf."</span></span>
<span id="cb16-276"><a href="#cb16-276"></a><span class="co">#| eval: true</span></span>
<span id="cb16-277"><a href="#cb16-277"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb16-278"><a href="#cb16-278"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> safrica_countries,</span>
<span id="cb16-279"><a href="#cb16-279"></a>    <span class="at">colour =</span> <span class="st">"indianred"</span>, <span class="at">fill =</span> <span class="st">"beige"</span>) <span class="sc">+</span></span>
<span id="cb16-280"><a href="#cb16-280"></a>  <span class="fu">coord_sf</span>(<span class="at">xlim =</span> xlim,</span>
<span id="cb16-281"><a href="#cb16-281"></a>           <span class="at">ylim =</span> ylim)</span>
<span id="cb16-282"><a href="#cb16-282"></a><span class="in">```</span></span>
<span id="cb16-283"><a href="#cb16-283"></a></span>
<span id="cb16-284"><a href="#cb16-284"></a><span class="fu">## Buffering and geometry assumptions</span></span>
<span id="cb16-285"><a href="#cb16-285"></a>Now you can layer another feature. This is also where geometry assumptions matter: buffering in degrees is only a rough approximation for local maps.</span>
<span id="cb16-286"><a href="#cb16-286"></a></span>
<span id="cb16-287"><a href="#cb16-287"></a><span class="in">```{r fig-buffer-safrica-countries-new}</span></span>
<span id="cb16-288"><a href="#cb16-288"></a><span class="co">#| fig-cap: "Buffered Southern Africa geometry overlaid on the original map."</span></span>
<span id="cb16-289"><a href="#cb16-289"></a><span class="co">#| eval: true</span></span>
<span id="cb16-290"><a href="#cb16-290"></a>buffer <span class="ot">&lt;-</span> safrica_countries_new <span class="sc">%&gt;%</span></span>
<span id="cb16-291"><a href="#cb16-291"></a>  <span class="fu">st_buffer</span>(<span class="fl">0.4</span>)</span>
<span id="cb16-292"><a href="#cb16-292"></a></span>
<span id="cb16-293"><a href="#cb16-293"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb16-294"><a href="#cb16-294"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> buffer, <span class="at">fill =</span> <span class="st">"lightblue"</span>, <span class="at">col =</span> <span class="st">"transparent"</span>) <span class="sc">+</span></span>
<span id="cb16-295"><a href="#cb16-295"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> safrica_countries, <span class="at">colour =</span> <span class="st">"indianred"</span>, <span class="at">fill =</span> <span class="st">"beige"</span>) <span class="sc">+</span></span>
<span id="cb16-296"><a href="#cb16-296"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb16-297"><a href="#cb16-297"></a><span class="in">```</span></span>
<span id="cb16-298"><a href="#cb16-298"></a></span>
<span id="cb16-299"><a href="#cb16-299"></a>::: {.callout-warning appearance="simple"}</span>
<span id="cb16-300"><a href="#cb16-300"></a><span class="fu">## Distances are not degrees</span></span>
<span id="cb16-301"><a href="#cb16-301"></a>If a buffer value "looks right" in degrees, that is an accident of scale. For accurate distances, project your data first and buffer in metres.</span>
<span id="cb16-302"><a href="#cb16-302"></a>:::</span>
<span id="cb16-303"><a href="#cb16-303"></a></span>
<span id="cb16-304"><a href="#cb16-304"></a><span class="fu"># A Reusable Workflow</span></span>
<span id="cb16-305"><a href="#cb16-305"></a>When you start from scratch, use this quick recipe:</span>
<span id="cb16-306"><a href="#cb16-306"></a></span>
<span id="cb16-307"><a href="#cb16-307"></a><span class="ss">1. </span>Load spatial data and check <span class="in">`st_crs()`</span> and geometry types.</span>
<span id="cb16-308"><a href="#cb16-308"></a><span class="ss">2. </span>Filter features (rows) and select attributes (columns) deliberately.</span>
<span id="cb16-309"><a href="#cb16-309"></a><span class="ss">3. </span>Crop or transform geometry only when you intend to change shape.</span>
<span id="cb16-310"><a href="#cb16-310"></a><span class="ss">4. </span>Plot with <span class="in">`plot()`</span> or **ggplot2**; add layers and styling last.</span>
<span id="cb16-311"><a href="#cb16-311"></a></span>
<span id="cb16-312"><a href="#cb16-312"></a>::: {.callout-caution appearance="simple"}</span>
<span id="cb16-313"><a href="#cb16-313"></a><span class="fu">## Common pitfalls to watch for</span></span>
<span id="cb16-314"><a href="#cb16-314"></a><span class="ss">- </span>Buffering or measuring in degrees instead of projected units.</span>
<span id="cb16-315"><a href="#cb16-315"></a><span class="ss">- </span>Cropping after styling, which hides clipped features or labels.</span>
<span id="cb16-316"><a href="#cb16-316"></a><span class="ss">- </span>Assuming <span class="in">`select()`</span> or <span class="in">`summarise()`</span> recalculates geometry.</span>
<span id="cb16-317"><a href="#cb16-317"></a><span class="ss">- </span>Using <span class="in">`coord_cartesian()`</span> for maps and silently distorting aspect ratio.</span>
<span id="cb16-318"><a href="#cb16-318"></a><span class="ss">- </span>Treating Natural Earth borders as definitive boundaries when precision matters.</span>
<span id="cb16-319"><a href="#cb16-319"></a>:::</span>
<span id="cb16-320"><a href="#cb16-320"></a></span>
<span id="cb16-321"><a href="#cb16-321"></a><span class="fu"># Example</span></span>
<span id="cb16-322"><a href="#cb16-322"></a></span>
<span id="cb16-323"><a href="#cb16-323"></a>Here are examples that use the built-in <span class="co">[</span><span class="ot">Fiji earthquake data</span><span class="co">](12-mapping_quakes.qmd)</span> or the <span class="co">[</span><span class="ot">Kaggle earthquake data</span><span class="co">](../../pages/kaggle_earthquakes.qmd)</span>.</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
<p>© 2026, AJ Smit</p>
</div>   
    <div class="nav-footer-center">

<div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/ajsmit/tangled_bank/edit/main/BCB744/intro_r/11-mapping_rnaturalearth.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/ajsmit/tangled_bank/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div><div class="cookie-consent-footer"><a href="#" id="open_preferences_center">Cookie Preferences</a></div></div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer><script>var lightboxQuarto = GLightbox({"closeEffect":"zoom","descPosition":"bottom","loop":false,"openEffect":"zoom","selector":".lightbox"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>


<script src="../../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>