<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.302">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="AJ Smit">
<meta name="dcterms.date" content="2021-01-01">
<title>The Tangled Bank - 3. Quantifying Biodiversity</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>

<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../BDC334/04-biodiversity2.html" rel="next">
<link href="../BDC334/02b-env_dist.html" rel="prev">
<link href="../images/favicon.ico" rel="icon">
<script src="../site_libs/cookie-consent/cookie-consent.js"></script>
<link href="../site_libs/cookie-consent/cookie-consent.css" rel="stylesheet">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-SCYH68M489"></script><script type="text/plain" cookie-consent="tracking">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-SCYH68M489', { 'anonymize_ip': true});
</script><script type="text/javascript" charset="UTF-8">
document.addEventListener('DOMContentLoaded', function () {
cookieconsent.run({
  "notice_banner_type":"simple",
  "consent_type":"implied",
  "palette":"light",
  "language":"en",
  "page_load_consent_levels":["strictly-necessary","functionality","tracking","targeting"],
  "notice_banner_reject_button_hide":false,
  "preferences_center_close_button_hide":false,
  "website_name":""
  });
});
</script><style>html{ scroll-behavior: smooth; }</style>
<script async="" src="https://hypothes.is/embed.js"></script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><link rel="stylesheet" href="../styles.css">
</head>
<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="navbar navbar-expand-lg navbar-dark "><div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">The Tangled Bank</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
<li class="nav-item">
    <a class="nav-link active" href="../index.html" rel="" target="" aria-current="page">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../about.html" rel="" target="">
 <span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-vignettes" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Vignettes</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-vignettes">
<li>
    <a class="dropdown-item" href="../vignettes/chl_ERDDAP.html" rel="" target="">
 <span class="dropdown-text">Retrieving Chlorophyll-a Data from ERDDAP Servers</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../vignettes/chl_sightings.html" rel="" target="">
 <span class="dropdown-text">Plotting the Whale Sightings and Chlorophyll-<em>a</em> Concentrations</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../vignettes/chl_localisation.html" rel="" target="">
 <span class="dropdown-text">Spatial Localisation, Subsetting, and Aggregation of the Chlorophyll-<em>a</em> Data</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../vignettes/prep_NOAA_OISST.html" rel="" target="">
 <span class="dropdown-text">Downloading and Prep: ERDDAP</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../vignettes/MHW_basic_detection.html" rel="" target="">
 <span class="dropdown-text">Basic Detection and Visualisation of Events</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../vignettes/gridded_data.html" rel="" target="">
 <span class="dropdown-text">Detecting Events in Gridded Data</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../vignettes/alt_method.html" rel="" target="">
 <span class="dropdown-text">Downloading and Prep: Python + CDO</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../vignettes/elem_ts_methods.html" rel="" target="">
 <span class="dropdown-text">Wavelet Analysis of Diatom Time Series</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../vignettes/MHW_MCS_horizonplots.html" rel="" target="">
 <span class="dropdown-text">Displaying MHWs and MCSs as horizon plots</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../vignettes/heatwaveR_issues.html" rel="" target="">
 <span class="dropdown-text">heatwaveR issues</span></a>
  </li>  
    </ul>
</li>
</ul>
<ul class="navbar-nav navbar-nav-scroll ms-auto">
<li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/ajsmit" rel="" target=""><i class="bi bi-twitter" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-bi-github" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
      <i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-bi-github">
<li>
    <a class="dropdown-item" href="https://github.com/ajsmit/tangled_bank" rel="" target="">
 <span class="dropdown-text">Source Code</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://bugs.com" rel="" target="">
 <span class="dropdown-text">Report a Bug</span></a>
  </li>  
    </ul>
</li>
</ul>
<div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../BDC334/BDC334_index.html">BDC334</a></li><li class="breadcrumb-item"><a href="../BDC334/03-biodiversity1.html">Lab 3: Quantifying Biodiversity</a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-center sidebar-header">
      <a href="../index.html" class="sidebar-logo-link">
      <img src="../images/hex_logo.png" alt="" class="sidebar-logo py-0 d-lg-inline d-none"></a>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
 <span class="menu-text">☘︎</span>
  </li>
        <li class="sidebar-item">
 <span class="menu-text">UNDERGRADUATE</span>
  </li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="false">
 <span class="menu-text">BDC223</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../pages/BDC223_FAQ.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">FAQ</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">BDC334</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../BDC334/BDC334_index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">BDC334: Macroecology and Global Biogeography</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../BDC334/01-introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lab 1: Ecological Data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../BDC334/02a-r_rstudio.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lab 2a: R and RStudio</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../BDC334/02b-env_dist.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lab 2b: Environmental Distance</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../BDC334/03-biodiversity1.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Lab 3: Quantifying Biodiversity</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../BDC334/04-biodiversity2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lab 4: Describing Biodiversity Patterns</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item">
 <span class="menu-text">☘</span>
  </li>
        <li class="sidebar-item">
 <span class="menu-text">HONOURS CORE</span>
  </li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false">
 <span class="menu-text">BCB744 (Intro R)</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../BCB744/BCB744_index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">BCB744: Introduction to R, and Biostatistics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../BCB744/intro_r/01-RStudio.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">1. R and RStudio</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../BCB744/intro_r/02-working-with-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">2. Working with data and code</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../BCB744/intro_r/03-workflow.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">3. R workflows</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../BCB744/intro_r/04-graphics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">4. Graphics with ggplot2</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../BCB744/intro_r/05-faceting.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">5. Faceting figures</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../BCB744/intro_r/06-brewing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">6. Brewing colours</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../BCB744/intro_r/07-mapping.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">7. Mapping with ggplot2</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../BCB744/intro_r/08-mapping_style.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">8. Mapping with style</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../BCB744/intro_r/09-mapping_rnaturalearth.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">9. Mapping with Natural Earth and the <strong>sf</strong> package</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../BCB744/intro_r/10-mapping_quakes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">10. The Fiji Earthquake Data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../BCB744/intro_r/11-tidy.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">11. Tidy data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../BCB744/intro_r/12-tidier.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">12. Tidier data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../BCB744/intro_r/13-tidiest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">13. Tidiest data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../BCB744/intro_r/14-recap.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">14. Recap</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../BCB744/intro_r/15-functions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">15. Functions by chapter</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../BCB744/intro_r/16-base_r.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">16. Base R primer</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../BCB744/intro_r/17-dates.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">17. Dates</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="false">
 <span class="menu-text">BCB744 (Biostatistics)</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../BCB744/basic_stats/01-data-in-R.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">1. Data classes and structures in R</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../BCB744/basic_stats/02-summarise-and-describe.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">2. Exploring with summaries and descriptions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../BCB744/basic_stats/03-visualise.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">3. Exploring with figures</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../BCB744/basic_stats/04-distributions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">4. Data distributions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../BCB744/basic_stats/05-inference.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">5. Statistical inference and hypothesis testing</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../BCB744/basic_stats/06-assumptions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">6. Assumptions for parametric statistics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../BCB744/basic_stats/07-t_tests.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">7. <em>t</em>-tests</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../BCB744/basic_stats/08-anova.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">8. Analysis of Variance (ANOVA)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../BCB744/basic_stats/09-regressions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">9. Simple linear regressions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../BCB744/basic_stats/10-correlations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">10. Correlations</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../BCB744/basic_stats/11-glance.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">11. Non-parametric statistical tests at a glance</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../BCB744/basic_stats/12-confidence.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">12. Confidence intervals</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item">
 <span class="menu-text">☘</span>
  </li>
        <li class="sidebar-item">
 <span class="menu-text">HONOURS ELECTIVES</span>
  </li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="false">
 <span class="menu-text">BCB743</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../BCB743/BCB743_index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">BCB743: Quantitative Ecology</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../BCB743/00-review.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">1-4. Review Biogeography and Global Ecology</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../BCB743/05-correlations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">5. Correlations and Associations</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../BCB743/06-deep_dive.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">6. Deep Dive into Gradients</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../BCB743/07-ordination.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">7. Ordination</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../BCB743/08-PCA.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">8a. Principal Component Analysis (PCA)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../BCB743/08-PCA_examples.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">8b. PCA Additional Examples</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../BCB743/09-CA.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">9. Correspondence Analysis (CA)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../BCB743/10-PCoA.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">10. Principal Coordinate Analysis (PCoA)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../BCB743/11-nMDS.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">11a. non-Metric Multidimensional Scaling (nMDS)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../BCB743/11-nMDS_diatoms.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">11b. nMDS of Mayombo’s Diatom Data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../BCB743/12-constrained_ordination.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">12. Constrained Ordination</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../BCB743/13-cluster_analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">13. Cluster Analysis</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item">
 <span class="menu-text">☘︎</span>
  </li>
        <li class="sidebar-item">
 <span class="menu-text">SUPPORT</span>
  </li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="false">
 <span class="menu-text">Web Resources</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../resources/general_resources_web.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">R Resources</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../resources/ecology_resources_web.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Quantitative Ecology Resources</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../resources/spatial_resources_web.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Spatial R Resources</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item">
 <span class="menu-text">☘︎</span>
  </li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li>
<a href="#preparation" id="toc-preparation" class="nav-link active" data-scroll-target="#preparation"><span class="header-section-number">1</span> Preparation</a>
  <ul class="collapse">
<li><a href="#the-south-african-seaweed-data" id="toc-the-south-african-seaweed-data" class="nav-link" data-scroll-target="#the-south-african-seaweed-data"><span class="header-section-number">1.1</span> The South African seaweed data</a></li>
  <li><a href="#setting-up-the-analysis-environment" id="toc-setting-up-the-analysis-environment" class="nav-link" data-scroll-target="#setting-up-the-analysis-environment"><span class="header-section-number">1.2</span> Setting up the analysis environment</a></li>
  <li><a href="#a-look-at-the-data" id="toc-a-look-at-the-data" class="nav-link" data-scroll-target="#a-look-at-the-data"><span class="header-section-number">1.3</span> A look at the data</a></li>
  </ul>
</li>
  <li><a href="#species-data" id="toc-species-data" class="nav-link" data-scroll-target="#species-data"><span class="header-section-number">2</span> Species data</a></li>
  <li>
<a href="#three-measures-of-biodiversity" id="toc-three-measures-of-biodiversity" class="nav-link" data-scroll-target="#three-measures-of-biodiversity"><span class="header-section-number">3</span> Three measures of biodiversity</a>
  <ul class="collapse">
<li>
<a href="#alpha-diversity" id="toc-alpha-diversity" class="nav-link" data-scroll-target="#alpha-diversity"><span class="header-section-number">3.1</span> Alpha diversity</a>
  <ul class="collapse">
<li><a href="#species-richness-s" id="toc-species-richness-s" class="nav-link" data-scroll-target="#species-richness-s"><span class="header-section-number">3.1.1</span> Species richness, <span class="math inline">\(S\)</span></a></li>
  <li><a href="#univariate-diversity-indices" id="toc-univariate-diversity-indices" class="nav-link" data-scroll-target="#univariate-diversity-indices"><span class="header-section-number">3.1.2</span> Univariate diversity indices</a></li>
  <li><a href="#species-evenness" id="toc-species-evenness" class="nav-link" data-scroll-target="#species-evenness"><span class="header-section-number">3.1.3</span> Species evenness</a></li>
  <li><a href="#dissimilarity-indices" id="toc-dissimilarity-indices" class="nav-link" data-scroll-target="#dissimilarity-indices"><span class="header-section-number">3.1.4</span> Dissimilarity indices</a></li>
  </ul>
</li>
  <li><a href="#gamma-diversity" id="toc-gamma-diversity" class="nav-link" data-scroll-target="#gamma-diversity"><span class="header-section-number">3.2</span> Gamma diversity</a></li>
  <li>
<a href="#beta-diversity" id="toc-beta-diversity" class="nav-link" data-scroll-target="#beta-diversity"><span class="header-section-number">3.3</span> Beta-diversity</a>
  <ul class="collapse">
<li><a href="#whittakers-concept-of-beta-diversity" id="toc-whittakers-concept-of-beta-diversity" class="nav-link" data-scroll-target="#whittakers-concept-of-beta-diversity"><span class="header-section-number">3.3.1</span> Whittaker’s concept of <span class="math inline">\(\beta\)</span>-diversity</a></li>
  <li><a href="#contemporary-definitions-beta-diversity" id="toc-contemporary-definitions-beta-diversity" class="nav-link" data-scroll-target="#contemporary-definitions-beta-diversity"><span class="header-section-number">3.3.2</span> Contemporary definitions <span class="math inline">\(\beta\)</span>-diversity</a></li>
  </ul>
</li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references"><span class="header-section-number">3.4</span> References</a></li>
  </ul>
</li>
  </ul><div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/ajsmit/tangled_bank/edit/main/BDC334/03-biodiversity1.qmd" class="toc-action">Edit this page</a></p><p><a href="https://github.com/ajsmit/tangled_bank/issues/new" class="toc-action">Report an issue</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content column-body" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">3. Quantifying Biodiversity</h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
<p class="subtitle lead">The Things we can do with Species Data</p>
</div>


<div class="quarto-title-meta-author">
  <div class="quarto-title-meta-heading">Author</div>
  <div class="quarto-title-meta-heading">Affiliation</div>
  
    <div class="quarto-title-meta-contents">
    <p class="author"><a href="https://ajsmit.netlify.app">AJ Smit</a> <a href="https://orcid.org/0000-0002-3799-6126" class="quarto-title-author-orcid"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg=="></a></p>
  </div>
    <div class="quarto-title-meta-contents">
        <p class="affiliation">
            <a href="https://uwc.ac.za">
            University of the Western Cape
            </a>
          </p>
      </div>
    </div>

<div class="quarto-title-meta">

      
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">January 1, 2021</p>
    </div>
  </div>
  
    
  </div>
  

</header><blockquote class="blockquote">
<p><em><strong>Biodiversity</strong> The variability among living organisms from all sources including,</em> inter alia<em>, terrestrial, marine and other aquatic ecosystems and the ecological complexes of which they are part; this includes diversity within species, between species and of ecosystems.</em></p>
<p>— International Union for the Conservation of Nature (IUCN), Convention on Biological Diversity</p>
</blockquote>
<p>The IUCN definition considers a diversity of diversity concepts. This module looks at diversity only at the species level (species diversity). However, we can also approach macroecological problems from phylogenetic and functional (and other) diversity concepts of view. Functional and phylogenetic diversity ideas will be introduced in the <a href="../BCB743/BCB743_index.html">BDC743 module Quantitative Ecology</a>.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
BCB743
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>This material must be reviewed by BCB743 students in Week 1 of Quantitative Ecology.</strong></p>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Data for this Lab
</div>
</div>
<div class="callout-body-container callout-body">
<p>The seaweed <span class="citation" data-cites="smit2017seaweeds">(<a href="#ref-smit2017seaweeds" role="doc-biblioref">Smit et al. 2017</a>)</span> and toy data are at the links below:</p>
<ul>
<li><p>The seaweed species data – <a href="../data/seaweed/SeaweedSpp.csv"><code>SeaweedSpp.csv</code></a></p></li>
<li><p>The seaweed environmental data – <a href="../data/seaweed/SeaweedEnv.csv"><code>SeaweedEnv.csv</code></a></p></li>
<li><p>The seaweed coastal sections – <a href="../data/seaweed/SeaweedSites.csv"><code>SeaweedSites.csv</code></a></p></li>
<li><p>The fictitious light data <a href="../data/light_levels.csv"><code>light_levels.csv</code></a></p></li>
</ul>
</div>
</div>
<section id="preparation" class="level1" data-number="1"><h1 data-number="1">
<span class="header-section-number">1</span> Preparation</h1>
<section id="the-south-african-seaweed-data" class="level2" data-number="1.1"><h2 data-number="1.1" class="anchored" data-anchor-id="the-south-african-seaweed-data">
<span class="header-section-number">1.1</span> The South African seaweed data</h2>
<p>In these examples, we will use the seaweed data of <span class="citation" data-cites="smit2017seaweeds">Smit et al. (<a href="#ref-smit2017seaweeds" role="doc-biblioref">2017</a>)</span>. Please make sure that you read this paper. An additional file describing the background to the data is available <a href="../docs/Smit_the_seaweed_data.pdf">here</a> (<a href="#fig-seaweed-sections">Figure&nbsp;1</a>).</p>
<div id="fig-seaweed-sections" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="../images/Seaweed_sections.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;1: The coastal sections and associated seawater temperature profile associated with the study by <span class="citation" data-cites="smit2017seaweeds">Smit et al. (<a href="#ref-smit2017seaweeds" role="doc-biblioref">2017</a>)</span>.</figcaption><p></p>
</figure>
</div>
<p>One of the datasets, <span class="math inline">\(Y\)</span> (in the file <code>SeaweedSpp.csv</code>), comprises updated distribution records of 847 macroalgal species within each of 58 × 50 km-long sections of the South African coast <span class="citation" data-cites="bolton2002seaweed">(<a href="#ref-bolton2002seaweed" role="doc-biblioref">Bolton and Stegenga 2002</a>)</span>. The dataset captures <em>ca</em>. 90% of the known seaweed flora of South Africa, but excludes some very small and/or very rare species for which data are insufficient. The data are from verifiable literature sources and John Bolton and Rob Anderson’s collections, assembled from information collected by teams of phycologists over three decades <span class="citation" data-cites="bolton1986marine stegenga1997seaweeds bolton2002seaweed de2005guide">(<a href="#ref-bolton1986marine" role="doc-biblioref">Bolton 1986</a>; <a href="#ref-stegenga1997seaweeds" role="doc-biblioref">Stegenga et al. 1997</a>; <a href="#ref-bolton2002seaweed" role="doc-biblioref">Bolton and Stegenga 2002</a>; <a href="#ref-de2005guide" role="doc-biblioref">De Clerck et al. 2005</a>)</span>. Another file, <span class="math inline">\(E\)</span> (in <code>env.csv</code>), is a dataset of <em>in situ</em> coastal seawater temperatures derived from daily measurements over 40 years <span class="citation" data-cites="smit2013coastal">(<a href="#ref-smit2013coastal" role="doc-biblioref">Smit et al. 2013</a>)</span>.</p>
</section><section id="setting-up-the-analysis-environment" class="level2" data-number="1.2"><h2 data-number="1.2" class="anchored" data-anchor-id="setting-up-the-analysis-environment">
<span class="header-section-number">1.2</span> Setting up the analysis environment</h2>
<p>We will use <strong>R</strong>, so first, we must find, install and load various packages. Some packages will be available on CRAN and can be accessed and installed the usual way, but you will need to download others from <a href="https://r-forge.r-project.org/R/?group_id=195">R Forge</a>.</p>
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/vegandevs/vegan">vegan</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">betapart</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://www.worldagroforestry.org/output/tree-diversity-analysis">BiodiversityR</a></span><span class="op">)</span> <span class="co"># this package may at times be problematic to install</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="a-look-at-the-data" class="level2" data-number="1.3"><h2 data-number="1.3" class="anchored" data-anchor-id="a-look-at-the-data">
<span class="header-section-number">1.3</span> A look at the data</h2>
<p>Let’s load the data and see how it is structured:</p>
<div class="cell">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">spp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span><span class="st">'../data/seaweed/SeaweedSpp.csv'</span><span class="op">)</span></span>
<span><span class="va">spp</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">spp</span>, <span class="op">-</span><span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Lets look at the data:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">spp</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  58 847</code></pre>
</div>
</div>
<p>We see that our dataset has 58 rows and 847 columns. What is in the columns and rows? Start with the first five rows and five columns:</p>
<div class="cell">
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">spp</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="kable-table">
<table class="table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: right;">ACECAL</th>
<th style="text-align: right;">ACEMOE</th>
<th style="text-align: right;">ACRVIR</th>
<th style="text-align: right;">AROSP1</th>
<th style="text-align: right;">ANAWRI</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Now the last five rows and five columns:</p>
<div class="cell">
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">spp</span><span class="op">[</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">spp</span><span class="op">)</span> <span class="op">-</span> <span class="fl">5</span><span class="op">)</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">spp</span><span class="op">)</span>, <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">spp</span><span class="op">)</span> <span class="op">-</span> <span class="fl">5</span><span class="op">)</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">spp</span><span class="op">)</span><span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="kable-table">
<table class="table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">WOMKWA</th>
<th style="text-align: right;">WOMPAC</th>
<th style="text-align: right;">WRAARG</th>
<th style="text-align: right;">WRAPUR</th>
<th style="text-align: right;">WURMIN</th>
<th style="text-align: right;">ZONSEM</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">53</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">54</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">55</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">56</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">57</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">58</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>So, each row corresponds to a site (i.e.&nbsp;each of the coastal sections), and each column contains a species. We arrange the species alphabetically and use a six-letter code to identify them.</p>
</section></section><section id="species-data" class="level1" data-number="2"><h1 data-number="2">
<span class="header-section-number">2</span> Species data</h1>
<p>When ecologists talk about species diversity, they typically consider the characteristics of biological communities in a specific habitat, ecological community, or ecosystem. Species diversity considers three essential concepts about how species are distributed in space: their <strong>richness</strong>, <strong>abundance</strong>, and <strong>evenness</strong>. We can express each of these as biodiversity metrics that allow us to compare communities in space and time.</p>
<p>When ecologists talk about ‘biodiversity’, they might not necessarily be interested in <em>all</em> the plants and animals and things that are neither plant nor animal that occur at a particular place. Some ecologists are interested in ants and moths. Others might find fish more insightful. Some even like marine mammals! I prefer seaweed. The analysis of biodiversity data might often be constrained to some higher-level taxon, such as all angiosperms in a landscape, reptiles, etc. (but we sample all species in the higher-level taxon). Some ecological questions benefit from comparisons of diversity assessments among selected taxa (avifauna vs small mammals, for example), as this focus might address some particular ecological hypothesis. The bird vs small mammal comparison might reveal how barriers such as streams and rivers structure biodiversity patterns. In our examples, we will use such focused datasets.</p>
<p>Here we look at the various measures of biodiversity, viz.&nbsp;<span class="math inline">\(\alpha\)</span>-, <span class="math inline">\(\gamma\)</span>- and <span class="math inline">\(\beta\)</span>-diversity. David Zelený, in his <a href="https://www.davidzeleny.net/anadat-r/doku.php/en:diversity_analysis">Analysis of community data in R</a>, provides deeper analysis and compulsory reading.</p>
<!--- # Topic 2: Measures of biodiversity --->
</section><section id="three-measures-of-biodiversity" class="level1" data-number="3"><h1 data-number="3">
<span class="header-section-number">3</span> Three measures of biodiversity</h1>
<p><span class="citation" data-cites="whittaker1972evolution">Whittaker (<a href="#ref-whittaker1972evolution" role="doc-biblioref">1972</a>)</span> coined three measures of biodiversity, and the concepts were ‘modernised’ by <span class="citation" data-cites="jurasinski2009inventory">Jurasinski et al. (<a href="#ref-jurasinski2009inventory" role="doc-biblioref">2009</a>)</span>. The concepts represent the measurement of biodiversity <em>across different spatial scales</em>. <span class="math inline">\(\alpha\)</span>- and <span class="math inline">\(\gamma\)</span>-diversity express the total number of species in an area. The first, <span class="math inline">\(\alpha\)</span>-diversity, represents the number of species at the small (local) scale, such as, for example, within a sampling unit like a quadrat, transect, plot, or trawl. Alternatively, maybe the research question represents the local scale by several sampling units nesting within a small patch of landscape and defines the mean species richness within this patch as local. Multiples (sampling units or patches) are nested within a larger region (or ecosystem) and serve as replicates. The complete number of species across all of these replicates indicates the diversity at a larger scale—this is called <span class="math inline">\(\gamma\)</span>-diversity. <span class="math inline">\(\beta\)</span>-diversity refers to the change in species composition among samples (sites).</p>
<p>By now, you will have received a brief <a href="../BDC334/02a-r_rstudio.html">Introduction to R</a>, and we can proceed with looking at some of the measures of biodiversity. We will start by using data on the seaweeds of South Africa to demonstrate some ideas around diversity measures. The <strong>vegan</strong><a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> (for <em>vegetation analysis</em>) package <span class="citation" data-cites="oksanen2022vegan">(<a href="#ref-oksanen2022vegan" role="doc-biblioref">Oksanen et al. 2022</a>)</span> offers <a href="../docs/Oksanen_diversity-vegan.pdf">various functions</a> to calculate diversity indices. I will demonstrate some of these functions below.</p>
<section id="alpha-diversity" class="level2" data-number="3.1"><h2 data-number="3.1" class="anchored" data-anchor-id="alpha-diversity">
<span class="header-section-number">3.1</span> Alpha diversity</h2>
<p>We can represent <span class="math inline">\(\alpha\)</span>-diversity in three ways:</p>
<ol type="1">
<li><p>as species richness, <span class="math inline">\(S\)</span>;</p></li>
<li><p>as a univariate diversity index, such as the <span class="math inline">\(\alpha\)</span> parameter of <a href="04-biodiversity.html#species-abundance-distribution">Fisher’s log-series</a>, Shannon diversity, <span class="math inline">\(H'\)</span>, or Simpson’s diversity, <span class="math inline">\(\lambda\)</span>;</p></li>
<li><p>Species evenness, e.g.&nbsp;Pielou’s evenness, <span class="math inline">\(J\)</span>; or</p></li>
<li><p>as a pairwise dissimilarity index, e.g.&nbsp;Bray-Curtis, Jaccard, or Sørensen dissimilarities—see <span class="citation" data-cites="koleff2003measuring">Koleff et al. (<a href="#ref-koleff2003measuring" role="doc-biblioref">2003</a>)</span> for many more; also see <code><a href="https://rdrr.io/pkg/vegan/man/vegdist.html">?vegdist</a></code>. However, discussing pairwise dissimilarities with <span class="math inline">\(\beta\)</span>-diversity makes more sense.</p></li>
</ol>
<p>We will work through each in turn.</p>
<section id="species-richness-s" class="level3" data-number="3.1.1"><h3 data-number="3.1.1" class="anchored" data-anchor-id="species-richness-s">
<span class="header-section-number">3.1.1</span> Species richness, <span class="math inline">\(S\)</span>
</h3>
<p>First, is species richness, which we denote by the symbol <span class="math inline">\(S\)</span>. In the seaweed biodiversity data—because we view each coastal section as the local scale (the smallest unit of sampling)—I count the number of species within each of the sections.</p>
<p>The preferred option for calculating species richness is the <code><a href="https://rdrr.io/pkg/vegan/man/diversity.html">specnumber()</a></code> function in <strong>vegan</strong>:</p>
<div class="cell">
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/vegan/man/diversity.html">specnumber</a></span><span class="op">(</span><span class="va">spp</span>, MARGIN <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 138 139 139 140 143 143 143 145 149 148 159 162 208 147 168 204 269 276 280
[20] 265 265 283 269 279 281 295 290 290 299 295 311 317 298 299 301 315 308 327
[39] 340 315 315 302 311 280 300 282 283 321 319 319 330 293 291 292 294 313 333
[58] 316</code></pre>
</div>
</div>
<p>The data output is easier to understand if we display it as a <code><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble()</a></code>:</p>
<div class="cell">
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Use 'MARGIN = 1' to calculate the number of species within each row (site)</span></span>
<span><span class="va">spp_richness</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>section <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">58</span>,</span>
<span>                       richness <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/vegan/man/diversity.html">specnumber</a></span><span class="op">(</span><span class="va">spp</span>, MARGIN <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">spp_richness</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="kable-table">
<table class="table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: right;">section</th>
<th style="text-align: right;">richness</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">138</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">139</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">139</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">140</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5</td>
<td style="text-align: right;">143</td>
</tr>
<tr class="even">
<td style="text-align: right;">6</td>
<td style="text-align: right;">143</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>The <code><a href="https://rdrr.io/pkg/BiodiversityR/man/diversityresult.html">diversityresult()</a></code> function in the <strong>BiodiversityR</strong> package can do the same (sometimes this package is difficult to install due to various software dependencies that might be required for the package to load properly— do not be sad if this method does not work):</p>
<div class="cell">
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">spp_richness</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiodiversityR/man/diversityresult.html">diversityresult</a></span><span class="op">(</span><span class="va">spp</span>, index <span class="op">=</span> <span class="st">'richness'</span>,</span>
<span>                                method <span class="op">=</span> <span class="st">'each site'</span><span class="op">)</span></span>
<span><span class="co"># spp_richness</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now we make a plot seen in <a href="#fig-species-richness">Figure&nbsp;2</a>:</p>
<div class="cell">
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">spp_richness</span>, <span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">58</span>, y <span class="op">=</span> <span class="va">richness</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">1.2</span>, colour <span class="op">=</span> <span class="st">"indianred"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"Coastal section, west to east"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">"Species richness"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_linedraw</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-species-richness" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="03-biodiversity1_files/figure-html/fig-species-richness-1.svg" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;2: The seaweed species richness, <span class="math inline">\(S\)</span>, within each of the coastal sections along the shore of South Africa.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>In other instances, it makes more sense to calculate the mean species richness of all the sampling units (e.g.&nbsp;quadrats) taken inside the ecosystem of interest. You will have to decide based on your data.</p>
<p>The mean species richness is:</p>
<div class="cell">
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">spp_richness</span><span class="op">$</span><span class="va">richness</span><span class="op">)</span>, <span class="fl">0</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 259</code></pre>
</div>
</div>
</section><section id="univariate-diversity-indices" class="level3" data-number="3.1.2"><h3 data-number="3.1.2" class="anchored" data-anchor-id="univariate-diversity-indices">
<span class="header-section-number">3.1.2</span> Univariate diversity indices</h3>
<p>The second way we can express <span class="math inline">\(\alpha\)</span>-diversity is to use one of the univariate diversity indices such as Fisher’s <span class="math inline">\(\alpha\)</span>, Shannon’s <span class="math inline">\(H'\)</span> or Simpson’s <span class="math inline">\(\lambda\)</span>.</p>
<p>The choice of which indices to use should be informed by the extent to which one wants to emphasise richness or evenness. Species richness, <span class="math inline">\(S\)</span>, does not consider evenness as it is all about richness (obviously). Simpson’s <span class="math inline">\(\lambda\)</span> emphasises evenness a lot more. Shannon’s <span class="math inline">\(H'\)</span> is somewhere in the middle.</p>
<p><strong>Simpson’s <span class="math inline">\(\lambda\)</span></strong>, or simply the Simpson index, is calculated as:</p>
<p><span class="math display">\[\displaystyle \lambda = \sum_{i=1}^{S} p_{i}^{2}\]</span> where <span class="math inline">\(S\)</span> is the species richness and <span class="math inline">\(p_{i}\)</span> is the relative abundance of the <span class="math inline">\(i\)</span>th species.</p>
<p><strong>Shannon’s <span class="math inline">\(H'\)</span></strong> is sometimes called Shannon’s diversity, the Shannon-Wiener index, the Shannon-Weaver index, or the Shannon entropy. It is calculated as:</p>
<p><span class="math display">\[H' = -\sum_{i=1}^{S} p_{i} \ln p_{i}\]</span> where <span class="math inline">\(p_{i}\)</span> is the proportion of individuals belonging to the <span class="math inline">\(i\)</span>th species, and <span class="math inline">\(S\)</span> is the species richness.</p>
<p><strong>Fisher’s <span class="math inline">\(\alpha\)</span></strong> estimates the <span class="math inline">\(\alpha\)</span> parameter of <a href="03-04-biodiversity.html#species-abundance-distribution">Fisher’s logarithmic series</a> (see functions <code><a href="https://rdrr.io/pkg/vegan/man/diversity.html">fisher.alpha()</a></code> and <code><a href="https://rdrr.io/pkg/vegan/man/fisherfit.html">fisherfit()</a></code>). The estimation is possible only for actual counts (i.e.&nbsp;integers) of individuals, so it will not work for per cent cover, biomass, and other measures that real numbers can express. We will get to this function later under <a href="03-04-biodiversity.html#species-abundance-distribution">Fisher’s logarithmic series</a>.</p>
<p>Except for Fisher’s-<span class="math inline">\(\alpha\)</span>, we cannot calculate these for the seaweed data because, in order to do so, we require abundance data—the seaweed data are presence-absence only. Let us load a fictitious dataset of the diversity of three different communities of plants, with each community corresponding to a different light environment (dim, mid, and high light):</p>
<div class="cell">
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">light</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span><span class="st">"../data/light_levels.csv"</span><span class="op">)</span></span>
<span><span class="va">light</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="kable-table">
<table class="table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: left;">Site</th>
<th style="text-align: right;">A</th>
<th style="text-align: right;">B</th>
<th style="text-align: right;">C</th>
<th style="text-align: right;">D</th>
<th style="text-align: right;">E</th>
<th style="text-align: right;">F</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">low_light</td>
<td style="text-align: right;">0.75</td>
<td style="text-align: right;">0.62</td>
<td style="text-align: right;">0.24</td>
<td style="text-align: right;">0.33</td>
<td style="text-align: right;">0.21</td>
<td style="text-align: right;">0.14</td>
</tr>
<tr class="even">
<td style="text-align: left;">mid_light</td>
<td style="text-align: right;">0.38</td>
<td style="text-align: right;">0.15</td>
<td style="text-align: right;">0.52</td>
<td style="text-align: right;">0.57</td>
<td style="text-align: right;">0.28</td>
<td style="text-align: right;">0.29</td>
</tr>
<tr class="odd">
<td style="text-align: left;">high_light</td>
<td style="text-align: right;">0.08</td>
<td style="text-align: right;">0.15</td>
<td style="text-align: right;">0.18</td>
<td style="text-align: right;">0.52</td>
<td style="text-align: right;">0.54</td>
<td style="text-align: right;">0.56</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>We can see above that instead of having data with 1s and 0s for presence-absence, here we have some values that indicate the relative amounts of each of the species in the three light environments. We calculate species richness (as before), and also the Shannon and Simpson indices using <strong>vegan</strong>’s <code><a href="https://rdrr.io/pkg/vegan/man/diversity.html">diversity()</a></code> function:</p>
<div class="cell">
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">light_div</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span></span>
<span>  site <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"low_light"</span>, <span class="st">"mid_light"</span>, <span class="st">"high_light"</span><span class="op">)</span>,</span>
<span>  richness <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/vegan/man/diversity.html">specnumber</a></span><span class="op">(</span><span class="va">light</span><span class="op">[</span>, <span class="fl">2</span><span class="op">:</span><span class="fl">7</span><span class="op">]</span>, MARGIN <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>  shannon <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/vegan/man/diversity.html">diversity</a></span><span class="op">(</span><span class="va">light</span><span class="op">[</span>, <span class="fl">2</span><span class="op">:</span><span class="fl">7</span><span class="op">]</span>, MARGIN <span class="op">=</span> <span class="fl">1</span>, index <span class="op">=</span> <span class="st">"shannon"</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>  simpson <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/vegan/man/diversity.html">diversity</a></span><span class="op">(</span><span class="va">light</span><span class="op">[</span>, <span class="fl">2</span><span class="op">:</span><span class="fl">7</span><span class="op">]</span>, MARGIN <span class="op">=</span> <span class="fl">1</span>, index <span class="op">=</span> <span class="st">"simpson"</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">light_div</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="kable-table">
<table class="table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: left;">site</th>
<th style="text-align: right;">richness</th>
<th style="text-align: right;">shannon</th>
<th style="text-align: right;">simpson</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">low_light</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">1.62</td>
<td style="text-align: right;">0.78</td>
</tr>
<tr class="even">
<td style="text-align: left;">mid_light</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">1.71</td>
<td style="text-align: right;">0.81</td>
</tr>
<tr class="odd">
<td style="text-align: left;">high_light</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">1.59</td>
<td style="text-align: right;">0.77</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<!-- Hill numbers, $q$, (Hill, 1973) summarise $S$, Shannon's $H'$ and Simpson's $\lambda$. Higher $q$ puts less weight on rare species and weighs abundant ones more. Hill numbers can be used to draw diversity profiles, which allow for an elegant comparison of diversity among communities considering both richness and evenness. -->
<!-- ```{r fig.height=3, fig.width=5} -->
<!-- data(BCI) -->
<!-- i <- sample(nrow(BCI), 12) -->
<!-- mod <- renyi(BCI[i,]) -->
<!-- plot(mod) -->
<!-- mod <- renyiaccum(BCI[i,]) -->

<!-- plot(mod, as.table=TRUE, col = c(1, 2, 2)) -->
<!-- persp(mod) -->
<!-- ``` -->
</section><section id="species-evenness" class="level3" data-number="3.1.3"><h3 data-number="3.1.3" class="anchored" data-anchor-id="species-evenness">
<span class="header-section-number">3.1.3</span> Species evenness</h3>
<p>Evenness refers to the shape of a <a href="04-biodiversity.html#species-abundance-distribution">species abundance distribution</a>.</p>
<p>One index for evenness is Pielou’s evenness, <span class="math inline">\(J\)</span>:</p>
<p><span class="math display">\[J = \frac{H^{\prime}} {log(S)}\]</span></p>
<p>where <span class="math inline">\(H'\)</span> is Shannon’s diversity index, and <span class="math inline">\(S\)</span> the number of species (i.e.&nbsp;<span class="math inline">\(S\)</span>).</p>
<p>To calculate Pielou’s evenness index for the <code>light</code> data, we can do this:</p>
<div class="cell">
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">H</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/vegan/man/diversity.html">diversity</a></span><span class="op">(</span><span class="va">light</span><span class="op">[</span>, <span class="fl">2</span><span class="op">:</span><span class="fl">7</span><span class="op">]</span>, MARGIN <span class="op">=</span> <span class="fl">1</span>, index <span class="op">=</span> <span class="st">"shannon"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">J</span> <span class="op">&lt;-</span> <span class="va">H</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/vegan/man/diversity.html">specnumber</a></span><span class="op">(</span><span class="va">light</span><span class="op">[</span>, <span class="fl">2</span><span class="op">:</span><span class="fl">7</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">J</span>, <span class="fl">2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.91 0.95 0.89</code></pre>
</div>
</div>
</section><section id="dissimilarity-indices" class="level3" data-number="3.1.4"><h3 data-number="3.1.4" class="anchored" data-anchor-id="dissimilarity-indices">
<span class="header-section-number">3.1.4</span> Dissimilarity indices</h3>
<p>In this Section, we will cover the dissimilarity indices, special cases of diversity indices that use pairwise comparisons between sampling units, habitats, or ecosystems. We can express both <span class="math inline">\(\alpha\)</span>- and <span class="math inline">\(\beta\)</span>-diversity as dissimilarity indices, but let us deal with <span class="math inline">\(\alpha\)</span>-diversity first.</p>
<p>Species dissimilarities result in pairwise matrices similar to the pairwise correlation or Euclidian distance matrices we have seen in <a href="../BDC334/01-introduction.html">Lab 1</a>. In <a href="../BDC334/02b-env_dist.html">Lab 2b</a> you will have also learned how to calculate these ecological distances in R. These dissimilarity indices are multivariate and compare between sites, sections, plots, etc., and must therefore not be confused with the univariate diversity indices.</p>
<p>We use the Bray-Curtis and Jaccard indices with abundance data and the Sørensen dissimilarity with presence-absence data. The seaweed dataset is a presence-absence dataset that necessitates using the Sørensen index. The interpretation of the resulting square (number of rows = number of columns) dissimilarity matrices is the same regardless of whether we calculate it for an abundance or presence-absence dataset. The values in the matrix range from 0 to 1. A 0 means that the pair of sites we compare is identical (all species in common) but 1 means they are completely different (no species in common). In the square dissimilarity matrix, the diagonal is 0, which essentially (and obviously) means that any site is identical to itself. Elsewhere the values will range from 0 to 1. Since this is a pairwise calculation (each site compared to every other site), our seaweed dataset will contain (58 × (58 - 1))/2 = 1653 values, each one ranging from 0 to 1.</p>
<p>The first step involves the species table, <span class="math inline">\(Y\)</span>. First, we compute the Sørensen dissimilarity index, <span class="math inline">\(\beta_{\text{sør}}\)</span>, to compare the dissimilarity of all pairs of coastal sections using presence-absence data. The dissimilarity in species composition between two sections is calculated from three parameters, <em>viz</em>., <em>b</em> and <em>c</em>, which represent the number of species unique to each of the two sites, and <em>a</em>, the number of species in common between them. It is given by:</p>
<p><span class="math display">\[\beta_\text{sør}=\frac{b+c}{2a+b+c}\]</span></p>
<p>The <strong>vegan</strong> function <code><a href="https://rdrr.io/pkg/vegan/man/vegdist.html">vegdist()</a></code> provides access to the dissimilarity indices. We calculate the Sørensen dissimilarity index:</p>
<div class="cell">
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">sor</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/vegan/man/vegdist.html">vegdist</a></span><span class="op">(</span><span class="va">spp</span>, binary <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># makes the lower triangle matrix</span></span>
<span><span class="va">sor_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">sor</span><span class="op">)</span>, <span class="fl">4</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">sor_df</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 58 58</code></pre>
</div>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">sor_df</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span> <span class="co"># the first 10 rows and columns</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        1      2      3      4      5      6      7      8      9     10
1  0.0000 0.0036 0.0036 0.0072 0.0249 0.0391 0.0391 0.0459 0.0592 0.0629
2  0.0036 0.0000 0.0000 0.0036 0.0213 0.0355 0.0355 0.0423 0.0556 0.0592
3  0.0036 0.0000 0.0000 0.0036 0.0213 0.0355 0.0355 0.0423 0.0556 0.0592
4  0.0072 0.0036 0.0036 0.0000 0.0177 0.0318 0.0318 0.0386 0.0519 0.0556
5  0.0249 0.0213 0.0213 0.0177 0.0000 0.0140 0.0140 0.0208 0.0342 0.0378
6  0.0391 0.0355 0.0355 0.0318 0.0140 0.0000 0.0000 0.0069 0.0205 0.0241
7  0.0391 0.0355 0.0355 0.0318 0.0140 0.0000 0.0000 0.0069 0.0205 0.0241
8  0.0459 0.0423 0.0423 0.0386 0.0208 0.0069 0.0069 0.0000 0.0136 0.0171
9  0.0592 0.0556 0.0556 0.0519 0.0342 0.0205 0.0205 0.0136 0.0000 0.0034
10 0.0629 0.0592 0.0592 0.0556 0.0378 0.0241 0.0241 0.0171 0.0034 0.0000</code></pre>
</div>
</div>
<p>What we see above is a square dissimilarity matrix. The most important characteristics of the matrix are:</p>
<ol type="i">
<li><p>whereas the raw species data, <span class="math inline">\(Y\)</span>, is rectangular (number rows ≠ number columns), the dissimilarity matrix is square (number rows = number columns);</p></li>
<li><p>the diagonal is filled with 0;</p></li>
<li><p>the matrix is symmetrical—it is comprised of symetrical upper and lower triangles.</p></li>
</ol>
<p>Create a data.frame suitable for plotting:</p>
<div class="cell">
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">sor_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">sor</span><span class="op">)</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Lab 3
</div>
</div>
<div class="callout-body-container callout-body">
<p>These questions concern matrices produced from species data using any of the indices available in <code><a href="https://rdrr.io/pkg/vegan/man/vegdist.html">vegdist()</a></code>:</p>
<ol type="1">
<li><p>Why is the matrix square, and what determines the number of rows/columns?</p></li>
<li><p>What is the meaning of the diagonal?</p></li>
<li><p>What is the meaning of the non-diagonal elements?</p></li>
<li><p>Referring to the seaweed species data specifically, take the data in row 1 or column 1 and create a line graph showing these values as a function of the section number.</p></li>
</ol>
<blockquote class="blockquote">
<p>Answer:</p>
</blockquote>
<div class="cell">
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">sor_df</span>, <span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">58</span>, y <span class="op">=</span> <span class="va">X1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">1.2</span>, colour <span class="op">=</span> <span class="st">"indianred"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"Coastal section, west to east"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">"Total beta-diversity"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_linedraw</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03-biodiversity1_files/figure-html/unnamed-chunk-15-1.svg" class="img-fluid"></p>
</div>
</div>
<ol start="5" type="1">
<li>Provide a mechanistic (ecological) explanation for why this figure takes the shape that it does. Which community assembly process does this hint at?</li>
</ol>
</div>
</div>
<p>Dissimilarity indices will be unpacked in more detail under <a href="03-04-biodiversity.html#contemporary-definitions-beta-diversity">contemporary views of <span class="math inline">\(\beta\)</span>-diversity</a>.</p>
</section></section><section id="gamma-diversity" class="level2" data-number="3.2"><h2 data-number="3.2" class="anchored" data-anchor-id="gamma-diversity">
<span class="header-section-number">3.2</span> Gamma diversity</h2>
<p>Staying with the seaweed data, <span class="math inline">\(Y\)</span>, let us now look at <span class="math inline">\(\gamma\)</span>-diversity—this would be the total number of species along the South African coastline in all 58 coastal sections. Since each column represents one species, and the dataset contains data collected at each of the 58 sites (the number of rows), we can do:</p>
<div class="cell">
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># the number of columns gives the total number of species in this example:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">spp</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 847</code></pre>
</div>
</div>
<p>We can also use:</p>
<div class="cell">
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/BiodiversityR/man/diversityresult.html">diversityresult</a></span><span class="op">(</span><span class="va">spp</span>, index <span class="op">=</span> <span class="st">'richness'</span>, method <span class="op">=</span> <span class="st">'pooled'</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="kable-table">
<table class="table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">richness</th>
</tr></thead>
<tbody><tr class="odd">
<td style="text-align: left;">pooled</td>
<td style="text-align: right;">846</td>
</tr></tbody>
</table>
</div>
</div>
</div>
<!-- ```{r} -->
<!-- specpool() -->
<!-- ``` -->
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Lab 3 (continue)
</div>
</div>
<div class="callout-body-container callout-body">
<ol start="6" type="1">
<li><p>Why is there a difference between the two?</p></li>
<li><p>Which is correct?</p></li>
</ol>
</div>
</div>
<p>Think before you calculate <span class="math inline">\(\gamma\)</span>-diversity for your own data as it might not be as simple as here!</p>
</section><section id="beta-diversity" class="level2" data-number="3.3"><h2 data-number="3.3" class="anchored" data-anchor-id="beta-diversity">
<span class="header-section-number">3.3</span> Beta-diversity</h2>
<section id="whittakers-concept-of-beta-diversity" class="level3" data-number="3.3.1"><h3 data-number="3.3.1" class="anchored" data-anchor-id="whittakers-concept-of-beta-diversity">
<span class="header-section-number">3.3.1</span> Whittaker’s concept of <span class="math inline">\(\beta\)</span>-diversity</h3>
<p>The first measure of <span class="math inline">\(\beta\)</span>-diversity comes from <span class="citation" data-cites="whittaker1960vegetation">Whittaker (<a href="#ref-whittaker1960vegetation" role="doc-biblioref">1960</a>)</span> and is called <em>true <span class="math inline">\(\beta\)</span>-diversity</em>. In this instance, divide the <span class="math inline">\(\gamma\)</span>-diversity for the region by the <span class="math inline">\(\alpha\)</span>-diversity for a specific coastal section. We can calculate it all at once for the whole dataset and make a graph (<a href="#fig-true-beta">Figure&nbsp;3</a>):</p>
<div class="cell">
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">true_beta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  beta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/vegan/man/diversity.html">specnumber</a></span><span class="op">(</span><span class="va">spp</span>, MARGIN <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">spp</span><span class="op">)</span>,</span>
<span>  section_no <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">58</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co"># true_beta</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">true_beta</span>, <span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">section_no</span>, y <span class="op">=</span> <span class="va">beta</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">1.2</span>, colour <span class="op">=</span> <span class="st">"indianred"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"Coastal section, west to east"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">"True beta-diversity"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_linedraw</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-true-beta" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="03-biodiversity1_files/figure-html/fig-true-beta-1.svg" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;3: Whittaker’s true β-diversity shown in the seaweed data.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>The second measure of <span class="math inline">\(\beta\)</span>-diversity is <em>absolute species turnover</em>, and to calculate this, we subtract <span class="math inline">\(\alpha\)</span>-diversity for each section from the region’s <span class="math inline">\(\gamma\)</span>-diversity (<a href="#fig-abs-beta">Figure&nbsp;4</a>):</p>
<div class="cell">
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">abs_beta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  beta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">spp</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/pkg/vegan/man/diversity.html">specnumber</a></span><span class="op">(</span><span class="va">spp</span>, MARGIN <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>  section_no <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">58</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co"># abs_beta</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">abs_beta</span>, <span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">section_no</span>, y <span class="op">=</span> <span class="va">beta</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">1.2</span>, colour <span class="op">=</span> <span class="st">"indianred"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"Coastal section, west to east"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">"Absolute beta-diversity"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_linedraw</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-abs-beta" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="03-biodiversity1_files/figure-html/fig-abs-beta-1.svg" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;4: Whittaker’s absolute species turnover shown in action in the seaweed data.</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section><section id="contemporary-definitions-beta-diversity" class="level3" data-number="3.3.2"><h3 data-number="3.3.2" class="anchored" data-anchor-id="contemporary-definitions-beta-diversity">
<span class="header-section-number">3.3.2</span> Contemporary definitions <span class="math inline">\(\beta\)</span>-diversity</h3>
<p>Contemporary views of <span class="math inline">\(\beta\)</span>-diversity are available by <span class="citation" data-cites="nekola1999distance">Nekola and White (<a href="#ref-nekola1999distance" role="doc-biblioref">1999</a>)</span>, <span class="citation" data-cites="baselga2010partitioning">Baselga (<a href="#ref-baselga2010partitioning" role="doc-biblioref">2010</a>)</span>, and <span class="citation" data-cites="anderson2011navigating">Anderson et al. (<a href="#ref-anderson2011navigating" role="doc-biblioref">2011</a>)</span>. Nowadays, we see <span class="math inline">\(\beta\)</span>-diversity is a concept that describes how species assemblages (communities) measured within the ecosystem of interest vary from place to place, e.g.&nbsp;between the various transects or quadrats used to sample the ecosystem. <span class="math inline">\(\beta\)</span>-diversity results from habitat heterogeneity (along gradients or randomly). We have already seen two concepts of <span class="math inline">\(\beta\)</span>-diversity, viz.&nbsp;true <span class="math inline">\(\beta\)</span>-diversity and absolute species turnover—both rely on knowledge of species richness at local (a measure of <span class="math inline">\(\alpha\)</span>-diversity) and regional (<span class="math inline">\(\gamma\)</span>-diversity) scales. However, more insight into <strong>species assembly processes</strong> can be extracted when we view <span class="math inline">\(\beta\)</span>-diversity as a dissimilarity index. In this view, we will see that there are <em>two processes</em> by which <span class="math inline">\(\beta\)</span>-diversity might be affected (i.e.&nbsp;in which the patterning of communities over landscapes might arise). These offer glimpses into mechanistic influences on how ecosystems are structured.</p>
<p><strong>Process 1:</strong> If a region comprises the species A, B, C, …, M (i.e.&nbsp;<span class="math inline">\(\gamma\)</span>-diversity is 13), a subset of the regional flora captured by one quadrat might be species <strong>A</strong>, <strong>D</strong>, E. In another quadrat species <strong>A</strong>, <strong>D</strong>, F might be present. <span class="math inline">\(\alpha\)</span>-diversity is three in both instances, and heterogeneity (and hence <span class="math inline">\(\beta\)</span>-diversity) results from the fact that the first quadrat has species E, but the other has species F. In other words, here, we have the same number of species in both quadrats, but only two of the species are the same. The process responsible for this form of <span class="math inline">\(\beta\)</span>-diversity is species <strong>turnover</strong>, <span class="math inline">\(\beta_\text{sim}\)</span>. Turnover refers to processes that cause communities to differ due to species being lost or gained from section to section, i.e.&nbsp;the species composition changes between sections without corresponding changes in <span class="math inline">\(\alpha\)</span>-diversity. The function <code><a href="https://rdrr.io/r/base/Special.html">beta()</a></code> in the R package <strong>BAT</strong> calls this form of <span class="math inline">\(\beta\)</span> diversity <strong>replacement</strong> and use the symbol <span class="math inline">\(\beta_{repl}\)</span> (<span class="citation" data-cites="cardoso2015bat">Cardoso et al. (<a href="#ref-cardoso2015bat" role="doc-biblioref">2015</a>)</span>).</p>
<p><strong>Process 2:</strong> Consider again species A, B, C, …, M. Now we have a quadrat with species <strong>A</strong>, <strong>B</strong>, C, D, <strong>G</strong>, H (<span class="math inline">\(\alpha\)</span>-diversity is six) but another quadrat has a subset of these species, e.g.&nbsp;only species <strong>A</strong>, <strong>B</strong>, <strong>G</strong> (<span class="math inline">\(\alpha\)</span>-diversity three). Here, <span class="math inline">\(\beta\)</span>-diversity is high even though the quadrats share <em>some</em> species, but the number of species differs among the quadrats (i.e.&nbsp;from place to place) due to one quadrat capturing only a subset of species present in the other. This form of <span class="math inline">\(\beta\)</span>-diversity is called <strong>nestedness-resultant</strong> <span class="math inline">\(\beta\)</span>-diversity, <span class="math inline">\(\beta_\text{sne}\)</span>, and it refers to processes that cause species to be gained or lost, and the community with the lowest <span class="math inline">\(\alpha\)</span>-diversity is a subset of the richer community. The function <code><a href="https://rdrr.io/r/base/Special.html">beta()</a></code> in the R package <strong>BAT</strong> calls this form of <span class="math inline">\(\beta\)</span> diversity *richness difference** and uses the symbol <span class="math inline">\(\beta_{rich}\)</span> (<span class="citation" data-cites="cardoso2015bat">Cardoso et al. (<a href="#ref-cardoso2015bat" role="doc-biblioref">2015</a>)</span>).</p>
<p>The above two examples show that <span class="math inline">\(\beta\)</span>-diversity is coupled not only with the identity of the species in the quadrats but also <span class="math inline">\(\alpha\)</span>-diversity—with species richness in particular.</p>
<p>We express <span class="math inline">\(\beta\)</span>-diversity as nestedness-resultant, <span class="math inline">\(\beta_\text{sne}\)</span>, and turnover, <span class="math inline">\(\beta_\text{sim}\)</span>, components to be able to distinguish between these two processes. It allows us to make inferences about the two possible drivers of <span class="math inline">\(\beta\)</span>-diversity. Turnover refers to processes that cause communities to differ due to species being lost or gained from section to section, i.e.&nbsp;the species composition changes between sections without corresponding changes in <span class="math inline">\(\alpha\)</span>-diversity. The nestedness-resultant component implies processes that cause species to be gained or lost without replacement, and the community with the lowest <span class="math inline">\(\alpha\)</span>-diversity is a subset of the richer community.</p>
<p>According to <span class="citation" data-cites="nekola1999distance">Nekola and White (<a href="#ref-nekola1999distance" role="doc-biblioref">1999</a>)</span> on p.&nbsp;868, there are <em>two causes</em> of ecological distance decay. ‘Ecological’ is key to the first cause—it is environmental filtering results in a decrease in similarity as the distance between sites increases. We sometimes call this the <strong>niche difference model</strong>. Such patterns are typically visible along steep environmental gradients such as elevation slopes (mountains), latitude, or depth in the ocean, to name only three. It is also the dominant mechanism underlying island biogeography.</p>
<p>The second cause of distance decay <em>sensu</em> <span class="citation" data-cites="nekola1999distance">Nekola and White (<a href="#ref-nekola1999distance" role="doc-biblioref">1999</a>)</span> involves aspects of the spatial configuration, context of the habitats, and some temporal considerations. Here, the evolutionary differences between species—specifically around those traits that affect their ability to disperse—are more at play and are the primary influences of distance decay rates that might vary between species. Let us first consider some properties of a hypothetical homogeneous landscape. The landscape creates some impediment (resistance) to the propagation of some species (hypothetically species A, B, and C) across its surface, but which are less effective in impeding others (D, E, and F). For argument’s sake, all species (A, …, F) share similar environmental tolerances to the prevailing environmental conditions, so one can argue that the niche difference model (environmental filtering) does not explain distributional patterns. Given a particular founding or disturbance event, species D, E, and F will, in a relatively shorter period, be able to become evenly distributed (relatively similar abundances everywhere) across this landscape. However, the less vagile (in terms of dispersal ability), species A, B, and C will develop a steeper gradient of decreasing species abundances away from the founding populations (resulting from, for example, adaptive radiation). They will require more time to become homogeneously dispersed across the landscape. In this regard, historical events set up striking distributional patterns that can be mistaken for gradients, which exist because insufficient time has passed to ensure complete dispersal. Studying the influence of such past events is called ‘historical biogeography.’ In reality, landscapes are seldom homogeneous in their spatial template (e.g.&nbsp;there are hills and valleys), and variable dispersal mechanisms and abilities will interact with this heterogeneous landscape to form interesting patterns of communities. The ecologist will have an exciting time figuring out the relative importance of actual gradients vs those that result from evolved traits that affect their dispersal ability and interact with the environment. I have not said anything about ‘neutral theories’ <span class="citation" data-cites="smit2017seaweeds">(but which are seen in the <span class="math inline">\(\beta_\text{sne}\)</span> form of <span class="math inline">\(\beta\)</span>-diversity as in <a href="#ref-smit2017seaweeds" role="doc-biblioref">Smit et al. 2017</a>)</span>, nor biological interactions that might affect community structure.</p>
<p>How do we calculate the turnover and nestedness-resultant components of <span class="math inline">\(\beta\)</span>-diversity? The <strong>betapart</strong> package <span class="citation" data-cites="baselga2022betapart">(<a href="#ref-baselga2022betapart" role="doc-biblioref">Baselga et al. 2022</a>)</span> comes to the rescue. We decompose the dissimilarity into the <span class="math inline">\(\beta_\text{sim}\)</span> and <span class="math inline">\(\beta_\text{sne}\)</span> components <span class="citation" data-cites="baselga2010partitioning">(<a href="#ref-baselga2010partitioning" role="doc-biblioref">Baselga 2010</a>)</span> using the <code><a href="https://rdrr.io/pkg/betapart/man/betapart.core.html">betapart.core()</a></code> and <code>betapart.pair()</code> functions. The outcomes of this partitioning calculation are placed into the matrices <span class="math inline">\(Y1\)</span> and <span class="math inline">\(Y2\)</span>. These data can then be analysed further—e.g.&nbsp;we can apply a principal components analysis (PCA) or another multivariate analysis on <span class="math inline">\(Y\)</span> to find the major patterns in the community data—we will do this in a later section.</p>
<div class="cell">
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Decompose total Sørensen dissimilarity into turnover and nestedness-resultant</span></span>
<span><span class="co"># components:</span></span>
<span><span class="va">Y.core</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/betapart/man/betapart.core.html">betapart.core</a></span><span class="op">(</span><span class="va">spp</span><span class="op">)</span></span>
<span><span class="va">Y.pair</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/betapart/man/beta.pair.html">beta.pair</a></span><span class="op">(</span><span class="va">Y.core</span>, index.family <span class="op">=</span> <span class="st">"sor"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Let Y1 be the turnover component (beta-sim):</span></span>
<span><span class="va">Y1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">Y.pair</span><span class="op">$</span><span class="va">beta.sim</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Let Y2 be the nestedness-resultant component (beta-sne):</span></span>
<span><span class="va">Y2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">Y.pair</span><span class="op">$</span><span class="va">beta.sne</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>A portion of the turnover component matrix:</p>
<div class="cell">
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">Y1</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="kable-table">
<table class="table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: right;">X1</th>
<th style="text-align: right;">X2</th>
<th style="text-align: right;">X3</th>
<th style="text-align: right;">X4</th>
<th style="text-align: right;">X5</th>
<th style="text-align: right;">X6</th>
<th style="text-align: right;">X7</th>
<th style="text-align: right;">X8</th>
<th style="text-align: right;">X9</th>
<th style="text-align: right;">X10</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.007</td>
<td style="text-align: right;">0.022</td>
<td style="text-align: right;">0.022</td>
<td style="text-align: right;">0.022</td>
<td style="text-align: right;">0.022</td>
<td style="text-align: right;">0.029</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.007</td>
<td style="text-align: right;">0.022</td>
<td style="text-align: right;">0.022</td>
<td style="text-align: right;">0.022</td>
<td style="text-align: right;">0.022</td>
<td style="text-align: right;">0.029</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.007</td>
<td style="text-align: right;">0.022</td>
<td style="text-align: right;">0.022</td>
<td style="text-align: right;">0.022</td>
<td style="text-align: right;">0.022</td>
<td style="text-align: right;">0.029</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.007</td>
<td style="text-align: right;">0.021</td>
<td style="text-align: right;">0.021</td>
<td style="text-align: right;">0.021</td>
<td style="text-align: right;">0.021</td>
<td style="text-align: right;">0.029</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.007</td>
<td style="text-align: right;">0.007</td>
<td style="text-align: right;">0.007</td>
<td style="text-align: right;">0.007</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.014</td>
<td style="text-align: right;">0.014</td>
<td style="text-align: right;">0.014</td>
<td style="text-align: right;">0.014</td>
<td style="text-align: right;">0.021</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.022</td>
<td style="text-align: right;">0.022</td>
<td style="text-align: right;">0.022</td>
<td style="text-align: right;">0.021</td>
<td style="text-align: right;">0.014</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.007</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.022</td>
<td style="text-align: right;">0.022</td>
<td style="text-align: right;">0.022</td>
<td style="text-align: right;">0.021</td>
<td style="text-align: right;">0.014</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.007</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.022</td>
<td style="text-align: right;">0.022</td>
<td style="text-align: right;">0.022</td>
<td style="text-align: right;">0.021</td>
<td style="text-align: right;">0.014</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.007</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.022</td>
<td style="text-align: right;">0.022</td>
<td style="text-align: right;">0.022</td>
<td style="text-align: right;">0.021</td>
<td style="text-align: right;">0.014</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.029</td>
<td style="text-align: right;">0.029</td>
<td style="text-align: right;">0.029</td>
<td style="text-align: right;">0.029</td>
<td style="text-align: right;">0.021</td>
<td style="text-align: right;">0.007</td>
<td style="text-align: right;">0.007</td>
<td style="text-align: right;">0.007</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>A portion of the nestedness-resultant matrix:</p>
<div class="cell">
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">Y2</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="kable-table">
<table class="table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: right;">X1</th>
<th style="text-align: right;">X2</th>
<th style="text-align: right;">X3</th>
<th style="text-align: right;">X4</th>
<th style="text-align: right;">X5</th>
<th style="text-align: right;">X6</th>
<th style="text-align: right;">X7</th>
<th style="text-align: right;">X8</th>
<th style="text-align: right;">X9</th>
<th style="text-align: right;">X10</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.004</td>
<td style="text-align: right;">0.004</td>
<td style="text-align: right;">0.007</td>
<td style="text-align: right;">0.018</td>
<td style="text-align: right;">0.017</td>
<td style="text-align: right;">0.017</td>
<td style="text-align: right;">0.024</td>
<td style="text-align: right;">0.037</td>
<td style="text-align: right;">0.034</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.004</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.004</td>
<td style="text-align: right;">0.014</td>
<td style="text-align: right;">0.014</td>
<td style="text-align: right;">0.014</td>
<td style="text-align: right;">0.021</td>
<td style="text-align: right;">0.034</td>
<td style="text-align: right;">0.030</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.004</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.004</td>
<td style="text-align: right;">0.014</td>
<td style="text-align: right;">0.014</td>
<td style="text-align: right;">0.014</td>
<td style="text-align: right;">0.021</td>
<td style="text-align: right;">0.034</td>
<td style="text-align: right;">0.030</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.007</td>
<td style="text-align: right;">0.004</td>
<td style="text-align: right;">0.004</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.011</td>
<td style="text-align: right;">0.010</td>
<td style="text-align: right;">0.010</td>
<td style="text-align: right;">0.017</td>
<td style="text-align: right;">0.030</td>
<td style="text-align: right;">0.027</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.018</td>
<td style="text-align: right;">0.014</td>
<td style="text-align: right;">0.014</td>
<td style="text-align: right;">0.011</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.007</td>
<td style="text-align: right;">0.020</td>
<td style="text-align: right;">0.017</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.017</td>
<td style="text-align: right;">0.014</td>
<td style="text-align: right;">0.014</td>
<td style="text-align: right;">0.010</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.007</td>
<td style="text-align: right;">0.021</td>
<td style="text-align: right;">0.017</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.017</td>
<td style="text-align: right;">0.014</td>
<td style="text-align: right;">0.014</td>
<td style="text-align: right;">0.010</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.007</td>
<td style="text-align: right;">0.021</td>
<td style="text-align: right;">0.017</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.024</td>
<td style="text-align: right;">0.021</td>
<td style="text-align: right;">0.021</td>
<td style="text-align: right;">0.017</td>
<td style="text-align: right;">0.007</td>
<td style="text-align: right;">0.007</td>
<td style="text-align: right;">0.007</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.014</td>
<td style="text-align: right;">0.010</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.037</td>
<td style="text-align: right;">0.034</td>
<td style="text-align: right;">0.034</td>
<td style="text-align: right;">0.030</td>
<td style="text-align: right;">0.020</td>
<td style="text-align: right;">0.021</td>
<td style="text-align: right;">0.021</td>
<td style="text-align: right;">0.014</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.003</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.034</td>
<td style="text-align: right;">0.030</td>
<td style="text-align: right;">0.030</td>
<td style="text-align: right;">0.027</td>
<td style="text-align: right;">0.017</td>
<td style="text-align: right;">0.017</td>
<td style="text-align: right;">0.017</td>
<td style="text-align: right;">0.010</td>
<td style="text-align: right;">0.003</td>
<td style="text-align: right;">0.000</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>A portion of the nestedness-resultant matrix reformatted as a <code><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble()</a></code><a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a>:</p>
<div class="cell">
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">Y2_tib</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html">as_tibble</a></span><span class="op">(</span><span class="va">Y2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">Y2_tib</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="kable-table">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
</colgroup>
<thead><tr class="header">
<th style="text-align: right;">X1</th>
<th style="text-align: right;">X2</th>
<th style="text-align: right;">X3</th>
<th style="text-align: right;">X4</th>
<th style="text-align: right;">X5</th>
<th style="text-align: right;">X6</th>
<th style="text-align: right;">X7</th>
<th style="text-align: right;">X8</th>
<th style="text-align: right;">X9</th>
<th style="text-align: right;">X10</th>
<th style="text-align: right;">X11</th>
<th style="text-align: right;">X12</th>
<th style="text-align: right;">X13</th>
<th style="text-align: right;">X14</th>
<th style="text-align: right;">X15</th>
<th style="text-align: right;">X16</th>
<th style="text-align: right;">X17</th>
<th style="text-align: right;">X18</th>
<th style="text-align: right;">X19</th>
<th style="text-align: right;">X20</th>
<th style="text-align: right;">X21</th>
<th style="text-align: right;">X22</th>
<th style="text-align: right;">X23</th>
<th style="text-align: right;">X24</th>
<th style="text-align: right;">X25</th>
<th style="text-align: right;">X26</th>
<th style="text-align: right;">X27</th>
<th style="text-align: right;">X28</th>
<th style="text-align: right;">X29</th>
<th style="text-align: right;">X30</th>
<th style="text-align: right;">X31</th>
<th style="text-align: right;">X32</th>
<th style="text-align: right;">X33</th>
<th style="text-align: right;">X34</th>
<th style="text-align: right;">X35</th>
<th style="text-align: right;">X36</th>
<th style="text-align: right;">X37</th>
<th style="text-align: right;">X38</th>
<th style="text-align: right;">X39</th>
<th style="text-align: right;">X40</th>
<th style="text-align: right;">X41</th>
<th style="text-align: right;">X42</th>
<th style="text-align: right;">X43</th>
<th style="text-align: right;">X44</th>
<th style="text-align: right;">X45</th>
<th style="text-align: right;">X46</th>
<th style="text-align: right;">X47</th>
<th style="text-align: right;">X48</th>
<th style="text-align: right;">X49</th>
<th style="text-align: right;">X50</th>
<th style="text-align: right;">X51</th>
<th style="text-align: right;">X52</th>
<th style="text-align: right;">X53</th>
<th style="text-align: right;">X54</th>
<th style="text-align: right;">X55</th>
<th style="text-align: right;">X56</th>
<th style="text-align: right;">X57</th>
<th style="text-align: right;">X58</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.004</td>
<td style="text-align: right;">0.004</td>
<td style="text-align: right;">0.007</td>
<td style="text-align: right;">0.018</td>
<td style="text-align: right;">0.017</td>
<td style="text-align: right;">0.017</td>
<td style="text-align: right;">0.024</td>
<td style="text-align: right;">0.037</td>
<td style="text-align: right;">0.034</td>
<td style="text-align: right;">0.069</td>
<td style="text-align: right;">0.078</td>
<td style="text-align: right;">0.196</td>
<td style="text-align: right;">0.030</td>
<td style="text-align: right;">0.092</td>
<td style="text-align: right;">0.179</td>
<td style="text-align: right;">0.285</td>
<td style="text-align: right;">0.261</td>
<td style="text-align: right;">0.254</td>
<td style="text-align: right;">0.215</td>
<td style="text-align: right;">0.212</td>
<td style="text-align: right;">0.225</td>
<td style="text-align: right;">0.166</td>
<td style="text-align: right;">0.174</td>
<td style="text-align: right;">0.173</td>
<td style="text-align: right;">0.179</td>
<td style="text-align: right;">0.172</td>
<td style="text-align: right;">0.172</td>
<td style="text-align: right;">0.179</td>
<td style="text-align: right;">0.168</td>
<td style="text-align: right;">0.176</td>
<td style="text-align: right;">0.180</td>
<td style="text-align: right;">0.149</td>
<td style="text-align: right;">0.150</td>
<td style="text-align: right;">0.151</td>
<td style="text-align: right;">0.159</td>
<td style="text-align: right;">0.144</td>
<td style="text-align: right;">0.153</td>
<td style="text-align: right;">0.156</td>
<td style="text-align: right;">0.125</td>
<td style="text-align: right;">0.122</td>
<td style="text-align: right;">0.105</td>
<td style="text-align: right;">0.109</td>
<td style="text-align: right;">0.079</td>
<td style="text-align: right;">0.083</td>
<td style="text-align: right;">0.070</td>
<td style="text-align: right;">0.067</td>
<td style="text-align: right;">0.069</td>
<td style="text-align: right;">0.057</td>
<td style="text-align: right;">0.055</td>
<td style="text-align: right;">0.056</td>
<td style="text-align: right;">0.042</td>
<td style="text-align: right;">0.039</td>
<td style="text-align: right;">0.039</td>
<td style="text-align: right;">0.039</td>
<td style="text-align: right;">0.042</td>
<td style="text-align: right;">0.033</td>
<td style="text-align: right;">0.028</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.004</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.004</td>
<td style="text-align: right;">0.014</td>
<td style="text-align: right;">0.014</td>
<td style="text-align: right;">0.014</td>
<td style="text-align: right;">0.021</td>
<td style="text-align: right;">0.034</td>
<td style="text-align: right;">0.030</td>
<td style="text-align: right;">0.065</td>
<td style="text-align: right;">0.074</td>
<td style="text-align: right;">0.193</td>
<td style="text-align: right;">0.027</td>
<td style="text-align: right;">0.088</td>
<td style="text-align: right;">0.175</td>
<td style="text-align: right;">0.280</td>
<td style="text-align: right;">0.256</td>
<td style="text-align: right;">0.249</td>
<td style="text-align: right;">0.211</td>
<td style="text-align: right;">0.209</td>
<td style="text-align: right;">0.221</td>
<td style="text-align: right;">0.163</td>
<td style="text-align: right;">0.171</td>
<td style="text-align: right;">0.170</td>
<td style="text-align: right;">0.176</td>
<td style="text-align: right;">0.170</td>
<td style="text-align: right;">0.170</td>
<td style="text-align: right;">0.176</td>
<td style="text-align: right;">0.166</td>
<td style="text-align: right;">0.173</td>
<td style="text-align: right;">0.177</td>
<td style="text-align: right;">0.147</td>
<td style="text-align: right;">0.147</td>
<td style="text-align: right;">0.148</td>
<td style="text-align: right;">0.156</td>
<td style="text-align: right;">0.141</td>
<td style="text-align: right;">0.151</td>
<td style="text-align: right;">0.154</td>
<td style="text-align: right;">0.123</td>
<td style="text-align: right;">0.120</td>
<td style="text-align: right;">0.104</td>
<td style="text-align: right;">0.107</td>
<td style="text-align: right;">0.077</td>
<td style="text-align: right;">0.082</td>
<td style="text-align: right;">0.068</td>
<td style="text-align: right;">0.066</td>
<td style="text-align: right;">0.068</td>
<td style="text-align: right;">0.057</td>
<td style="text-align: right;">0.054</td>
<td style="text-align: right;">0.056</td>
<td style="text-align: right;">0.041</td>
<td style="text-align: right;">0.038</td>
<td style="text-align: right;">0.038</td>
<td style="text-align: right;">0.039</td>
<td style="text-align: right;">0.042</td>
<td style="text-align: right;">0.033</td>
<td style="text-align: right;">0.028</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.004</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.004</td>
<td style="text-align: right;">0.014</td>
<td style="text-align: right;">0.014</td>
<td style="text-align: right;">0.014</td>
<td style="text-align: right;">0.021</td>
<td style="text-align: right;">0.034</td>
<td style="text-align: right;">0.030</td>
<td style="text-align: right;">0.065</td>
<td style="text-align: right;">0.074</td>
<td style="text-align: right;">0.193</td>
<td style="text-align: right;">0.027</td>
<td style="text-align: right;">0.088</td>
<td style="text-align: right;">0.175</td>
<td style="text-align: right;">0.280</td>
<td style="text-align: right;">0.256</td>
<td style="text-align: right;">0.249</td>
<td style="text-align: right;">0.211</td>
<td style="text-align: right;">0.209</td>
<td style="text-align: right;">0.221</td>
<td style="text-align: right;">0.163</td>
<td style="text-align: right;">0.171</td>
<td style="text-align: right;">0.170</td>
<td style="text-align: right;">0.176</td>
<td style="text-align: right;">0.170</td>
<td style="text-align: right;">0.170</td>
<td style="text-align: right;">0.176</td>
<td style="text-align: right;">0.166</td>
<td style="text-align: right;">0.173</td>
<td style="text-align: right;">0.177</td>
<td style="text-align: right;">0.147</td>
<td style="text-align: right;">0.147</td>
<td style="text-align: right;">0.148</td>
<td style="text-align: right;">0.156</td>
<td style="text-align: right;">0.141</td>
<td style="text-align: right;">0.151</td>
<td style="text-align: right;">0.154</td>
<td style="text-align: right;">0.123</td>
<td style="text-align: right;">0.120</td>
<td style="text-align: right;">0.104</td>
<td style="text-align: right;">0.107</td>
<td style="text-align: right;">0.077</td>
<td style="text-align: right;">0.082</td>
<td style="text-align: right;">0.068</td>
<td style="text-align: right;">0.066</td>
<td style="text-align: right;">0.068</td>
<td style="text-align: right;">0.057</td>
<td style="text-align: right;">0.054</td>
<td style="text-align: right;">0.056</td>
<td style="text-align: right;">0.041</td>
<td style="text-align: right;">0.038</td>
<td style="text-align: right;">0.038</td>
<td style="text-align: right;">0.039</td>
<td style="text-align: right;">0.042</td>
<td style="text-align: right;">0.033</td>
<td style="text-align: right;">0.028</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.007</td>
<td style="text-align: right;">0.004</td>
<td style="text-align: right;">0.004</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.011</td>
<td style="text-align: right;">0.010</td>
<td style="text-align: right;">0.010</td>
<td style="text-align: right;">0.017</td>
<td style="text-align: right;">0.030</td>
<td style="text-align: right;">0.027</td>
<td style="text-align: right;">0.062</td>
<td style="text-align: right;">0.071</td>
<td style="text-align: right;">0.190</td>
<td style="text-align: right;">0.023</td>
<td style="text-align: right;">0.084</td>
<td style="text-align: right;">0.170</td>
<td style="text-align: right;">0.275</td>
<td style="text-align: right;">0.252</td>
<td style="text-align: right;">0.245</td>
<td style="text-align: right;">0.207</td>
<td style="text-align: right;">0.205</td>
<td style="text-align: right;">0.217</td>
<td style="text-align: right;">0.160</td>
<td style="text-align: right;">0.168</td>
<td style="text-align: right;">0.167</td>
<td style="text-align: right;">0.173</td>
<td style="text-align: right;">0.167</td>
<td style="text-align: right;">0.167</td>
<td style="text-align: right;">0.173</td>
<td style="text-align: right;">0.163</td>
<td style="text-align: right;">0.171</td>
<td style="text-align: right;">0.174</td>
<td style="text-align: right;">0.144</td>
<td style="text-align: right;">0.145</td>
<td style="text-align: right;">0.146</td>
<td style="text-align: right;">0.154</td>
<td style="text-align: right;">0.139</td>
<td style="text-align: right;">0.149</td>
<td style="text-align: right;">0.152</td>
<td style="text-align: right;">0.121</td>
<td style="text-align: right;">0.118</td>
<td style="text-align: right;">0.102</td>
<td style="text-align: right;">0.106</td>
<td style="text-align: right;">0.076</td>
<td style="text-align: right;">0.081</td>
<td style="text-align: right;">0.067</td>
<td style="text-align: right;">0.065</td>
<td style="text-align: right;">0.067</td>
<td style="text-align: right;">0.056</td>
<td style="text-align: right;">0.053</td>
<td style="text-align: right;">0.055</td>
<td style="text-align: right;">0.040</td>
<td style="text-align: right;">0.038</td>
<td style="text-align: right;">0.038</td>
<td style="text-align: right;">0.038</td>
<td style="text-align: right;">0.041</td>
<td style="text-align: right;">0.032</td>
<td style="text-align: right;">0.028</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.018</td>
<td style="text-align: right;">0.014</td>
<td style="text-align: right;">0.014</td>
<td style="text-align: right;">0.011</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.007</td>
<td style="text-align: right;">0.020</td>
<td style="text-align: right;">0.017</td>
<td style="text-align: right;">0.052</td>
<td style="text-align: right;">0.061</td>
<td style="text-align: right;">0.181</td>
<td style="text-align: right;">0.013</td>
<td style="text-align: right;">0.073</td>
<td style="text-align: right;">0.157</td>
<td style="text-align: right;">0.261</td>
<td style="text-align: right;">0.240</td>
<td style="text-align: right;">0.233</td>
<td style="text-align: right;">0.197</td>
<td style="text-align: right;">0.194</td>
<td style="text-align: right;">0.207</td>
<td style="text-align: right;">0.152</td>
<td style="text-align: right;">0.160</td>
<td style="text-align: right;">0.159</td>
<td style="text-align: right;">0.165</td>
<td style="text-align: right;">0.159</td>
<td style="text-align: right;">0.159</td>
<td style="text-align: right;">0.165</td>
<td style="text-align: right;">0.155</td>
<td style="text-align: right;">0.163</td>
<td style="text-align: right;">0.167</td>
<td style="text-align: right;">0.138</td>
<td style="text-align: right;">0.138</td>
<td style="text-align: right;">0.139</td>
<td style="text-align: right;">0.147</td>
<td style="text-align: right;">0.133</td>
<td style="text-align: right;">0.142</td>
<td style="text-align: right;">0.145</td>
<td style="text-align: right;">0.116</td>
<td style="text-align: right;">0.113</td>
<td style="text-align: right;">0.097</td>
<td style="text-align: right;">0.101</td>
<td style="text-align: right;">0.072</td>
<td style="text-align: right;">0.077</td>
<td style="text-align: right;">0.064</td>
<td style="text-align: right;">0.062</td>
<td style="text-align: right;">0.064</td>
<td style="text-align: right;">0.053</td>
<td style="text-align: right;">0.051</td>
<td style="text-align: right;">0.053</td>
<td style="text-align: right;">0.038</td>
<td style="text-align: right;">0.036</td>
<td style="text-align: right;">0.036</td>
<td style="text-align: right;">0.036</td>
<td style="text-align: right;">0.039</td>
<td style="text-align: right;">0.031</td>
<td style="text-align: right;">0.026</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.017</td>
<td style="text-align: right;">0.014</td>
<td style="text-align: right;">0.014</td>
<td style="text-align: right;">0.010</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.007</td>
<td style="text-align: right;">0.021</td>
<td style="text-align: right;">0.017</td>
<td style="text-align: right;">0.053</td>
<td style="text-align: right;">0.062</td>
<td style="text-align: right;">0.184</td>
<td style="text-align: right;">0.013</td>
<td style="text-align: right;">0.073</td>
<td style="text-align: right;">0.157</td>
<td style="text-align: right;">0.261</td>
<td style="text-align: right;">0.240</td>
<td style="text-align: right;">0.233</td>
<td style="text-align: right;">0.197</td>
<td style="text-align: right;">0.194</td>
<td style="text-align: right;">0.207</td>
<td style="text-align: right;">0.152</td>
<td style="text-align: right;">0.160</td>
<td style="text-align: right;">0.159</td>
<td style="text-align: right;">0.165</td>
<td style="text-align: right;">0.159</td>
<td style="text-align: right;">0.159</td>
<td style="text-align: right;">0.165</td>
<td style="text-align: right;">0.155</td>
<td style="text-align: right;">0.163</td>
<td style="text-align: right;">0.167</td>
<td style="text-align: right;">0.138</td>
<td style="text-align: right;">0.138</td>
<td style="text-align: right;">0.139</td>
<td style="text-align: right;">0.147</td>
<td style="text-align: right;">0.133</td>
<td style="text-align: right;">0.142</td>
<td style="text-align: right;">0.145</td>
<td style="text-align: right;">0.116</td>
<td style="text-align: right;">0.113</td>
<td style="text-align: right;">0.097</td>
<td style="text-align: right;">0.101</td>
<td style="text-align: right;">0.072</td>
<td style="text-align: right;">0.077</td>
<td style="text-align: right;">0.064</td>
<td style="text-align: right;">0.062</td>
<td style="text-align: right;">0.064</td>
<td style="text-align: right;">0.053</td>
<td style="text-align: right;">0.051</td>
<td style="text-align: right;">0.053</td>
<td style="text-align: right;">0.038</td>
<td style="text-align: right;">0.036</td>
<td style="text-align: right;">0.036</td>
<td style="text-align: right;">0.036</td>
<td style="text-align: right;">0.039</td>
<td style="text-align: right;">0.031</td>
<td style="text-align: right;">0.026</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Lab 3 (continue)
</div>
</div>
<div class="callout-body-container callout-body">
<ol start="8" type="1">
<li>Plot species turnover as a function of Section number, and provide a mechanistic explanation for the pattern observed.</li>
</ol>
<blockquote class="blockquote">
<p>Answer</p>
</blockquote>
<div class="cell">
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># The turnover component</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">Y1</span>, <span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">58</span>, y <span class="op">=</span> <span class="va">X1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">1.2</span>, colour <span class="op">=</span> <span class="st">"indianred"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"Coastal section, west to east"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">"Species richness"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_linedraw</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03-biodiversity1_files/figure-html/unnamed-chunk-24-1.svg" class="img-fluid"></p>
</div>
</div>
<ol start="9" type="1">
<li>Based on an assessment of literature on the topic, provide a discussion of nestedness-resultant <span class="math inline">\(\beta\)</span>-diversity. Use either a marine or terrestrial example to explain this mode of structuring biodiversity (i.e.&nbsp;assembly of species into a community).</li>
</ol>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Submission instructions
</div>
</div>
<div class="callout-body-container callout-body">
<p>The Lab 3 assignment on Species Data was discussed on Monday 15 August and is due at <strong>07:00 on Monday 22 August 2022</strong>.</p>
<p>Provide a <strong>neat and thoroughly annotated</strong> R file which can recreate all the graphs and all calculations. Written answers must be typed in the same file as comments.</p>
<p>Please label the R file as follows:</p>
<ul>
<li><code>BDC334_&lt;first_name&gt;_&lt;last_name&gt;_Lab_3.R</code></li>
</ul>
<p>(the <code>&lt;</code> and <code>&gt;</code> must be omitted as they are used in the example as field indicators only).</p>
<p>Submit your appropriately named R documents on iKamva when ready.</p>
<p>Failing to follow these instructions carefully, precisely, and thoroughly will cause you to lose marks, which could cause a significant drop in your score as formatting counts for 15% of the final mark (out of 100%).</p>
</div>
</div>
</section></section><section id="references" class="level2" data-number="3.4"><h2 data-number="3.4" class="anchored" data-anchor-id="references">
<span class="header-section-number">3.4</span> References</h2>
<div id="refs" class="references csl-bib-body hanging-indent" role="list">
<div id="ref-anderson2011navigating" class="csl-entry" role="listitem">
Anderson MJ, Crist TO, Chase JM, Vellend M, Inouye BD, Freestone AL, Sanders NJ, Cornell HV, Comita LS, Davies KF, others (2011) Navigating the multiple meanings of <span class="math inline">\(\beta\)</span> diversity: A roadmap for the practicing ecologist. <span>Ecology Letters</span> 14:19–28.
</div>
<div id="ref-baselga2010partitioning" class="csl-entry" role="listitem">
Baselga A (2010) Partitioning the turnover and nestedness components of beta diversity. <span>Global Ecology and Biogeography</span> 19:134–143.
</div>
<div id="ref-baselga2022betapart" class="csl-entry" role="listitem">
Baselga A, Orme D, Villeger S, De Bortoli J, Leprieur F, Logez M (2022) <a href="https://CRAN.R-project.org/package=betapart"><span class="nocase">betapart: Partitioning Beta Diversity into Turnover and Nestedness Components</span></a>.
</div>
<div id="ref-bolton1986marine" class="csl-entry" role="listitem">
Bolton J (1986) Marine phytogeography of the <span>B</span>enguela upwelling region on the west coast of southern africa: A temperature dependent approach.
</div>
<div id="ref-bolton2002seaweed" class="csl-entry" role="listitem">
Bolton J, Stegenga H (2002) <span class="nocase">Seaweed species diversity in South Africa</span>. <span>South African Journal of Marine Science</span> 24:9–18.
</div>
<div id="ref-cardoso2015bat" class="csl-entry" role="listitem">
Cardoso P, Rigal F, Carvalho JC (2015) BAT–biodiversity assessment tools, an r package for the measurement and estimation of alpha and beta taxon, phylogenetic and functional diversity. Methods in Ecology and Evolution 6:232–236.
</div>
<div id="ref-de2005guide" class="csl-entry" role="listitem">
De Clerck O, Bolton J, Anderson R, Coppejans E, Bolton J, Anderson R (2005) <span class="nocase">Guide to the seaweeds of KwaZulu-Natal</span>.
</div>
<div id="ref-jurasinski2009inventory" class="csl-entry" role="listitem">
Jurasinski G, Retzer V, Beierkuhnlein C (2009) Inventory, differentiation, and proportional diversity: A consistent terminology for quantifying species diversity. Oecologia 159:15–26.
</div>
<div id="ref-koleff2003measuring" class="csl-entry" role="listitem">
Koleff P, Gaston KJ, Lennon JJ (2003) Measuring beta diversity for presence–absence data. <span>Journal of Animal Ecology</span> 72:367–382.
</div>
<div id="ref-nekola1999distance" class="csl-entry" role="listitem">
Nekola JC, White PS (1999) The distance decay of similarity in biogeography and ecology. <span>Journal of Biogeography</span> 26:867–878.
</div>
<div id="ref-oksanen2022vegan" class="csl-entry" role="listitem">
Oksanen J, Simpson GL, Blanchet FG, Kindt R, Legendre P, Minchin PR, O’Hara RB, Solymos P, Stevens MHH, Szoecs E, Wagner H, Barbour M, Bedward M, Bolker B, Borcard D, Carvalho G, Chirico M, De Caceres M, Durand S, Evangelista HBA, FitzJohn R, Friendly M, Furneaux B, Hannigan G, Hill MO, Lahti L, McGlinn D, Ouellette M-H, Ribeiro Cunha E, Smith T, Stier A, Ter Braak CJF, Weedon J (2022) <a href="https://CRAN.R-project.org/package=vegan"><span class="nocase">vegan: Community Ecology Package</span></a>.
</div>
<div id="ref-smit2013coastal" class="csl-entry" role="listitem">
Smit AJ, Roberts M, Anderson RJ, Dufois F, Dudley SF, Bornman TG, Olbers J, Bolton JJ (2013) <span class="nocase">A coastal seawater temperature dataset for biogeographical studies: large biases between in situ and remotely-sensed data sets around the coast of South Africa</span>. <span>PLoS One</span> 8:e81944.
</div>
<div id="ref-smit2017seaweeds" class="csl-entry" role="listitem">
Smit AJ, Bolton JJ, Anderson RJ (2017) Seaweeds in two oceans: Beta-diversity. <span>Frontiers in Marine Science</span> 4:404.
</div>
<div id="ref-stegenga1997seaweeds" class="csl-entry" role="listitem">
Stegenga H, Bolton JJ, Anderson RJ (1997) <span class="nocase">Seaweeds of the South African west coast</span>.
</div>
<div id="ref-whittaker1960vegetation" class="csl-entry" role="listitem">
Whittaker RH (1960) <span class="nocase">Vegetation of the Siskiyou mountains, Oregon and California</span>. <span>Ecological Monographs</span> 30:279–338.
</div>
<div id="ref-whittaker1972evolution" class="csl-entry" role="listitem">
Whittaker RH (1972) Evolution and measurement of species diversity. Taxon 21:213–251.
</div>
</div>


<!-- -->

</section></section><div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>
<ol>
<li id="fn1"><p>I am by no means an advocate for veganism.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>Note that the rows are no longer numbered in the tibble view, but it can easily be recreated by <code>seq(1:58)</code>.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol></section><section class="quarto-appendix-contents"><h2 class="anchored quarto-appendix-heading">Reuse</h2><div id="quarto-reuse" class="quarto-appendix-contents"><div><a rel="license" href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</a></div></div></section><section class="quarto-appendix-contents"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{smit2021,
  author = {Smit, AJ},
  title = {3. {Quantifying} {Biodiversity}},
  date = {2021-01-01},
  url = {https://tangledbank.netlify.app/BDC334/03-biodiversity1.html},
  langid = {en}
}
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-smit2021" class="csl-entry quarto-appendix-citeas" role="listitem">
Smit A (2021) 3. Quantifying Biodiversity. <a href="https://tangledbank.netlify.app/BDC334/03-biodiversity1.html">https://tangledbank.netlify.app/BDC334/03-biodiversity1.html.
</a>
</div></div></section></div></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><script src="https://utteranc.es/client.js" repo="ajsmit/tangled_bank" issue-term="pathname" theme="github-light" crossorigin="anonymous" async="">
</script><nav class="page-navigation column-body"><div class="nav-page nav-page-previous">
      <a href="../BDC334/02b-env_dist.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Lab 2b: Environmental Distance</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../BDC334/04-biodiversity2.html" class="pagination-link">
        <span class="nav-page-text">Lab 4: Describing Biodiversity Patterns</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb33" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> "2021-01-01"</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "3. Quantifying Biodiversity"</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="an">subtitle:</span><span class="co"> "The Things we can do with Species Data"</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; ***Biodiversity** The variability among living organisms from all</span></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; sources including,* inter alia*, terrestrial, marine and other aquatic</span></span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; ecosystems and the ecological complexes of which they are part; this</span></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; includes diversity within species, between species and of ecosystems.*</span></span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;</span></span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; --- International Union for the Conservation of Nature (IUCN), Convention on Biological Diversity</span></span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>The IUCN definition considers a diversity of diversity concepts. This module looks at diversity only at the species level (species diversity). However, we can also approach macroecological problems from phylogenetic and functional (and other) diversity concepts of view. Functional and phylogenetic diversity ideas will be introduced in the <span class="co">[</span><span class="ot">BDC743 module Quantitative Ecology</span><span class="co">](../BCB743/BCB743_index.qmd)</span>.</span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a>::: callout-note</span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a><span class="fu">## BCB743</span></span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a>**This material must be reviewed by BCB743 students in Week 1 of Quantitative Ecology.**</span>
<span id="cb33-20"><a href="#cb33-20" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb33-21"><a href="#cb33-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-22"><a href="#cb33-22" aria-hidden="true" tabindex="-1"></a>::: callout-tip</span>
<span id="cb33-23"><a href="#cb33-23" aria-hidden="true" tabindex="-1"></a><span class="fu">## Data for this Lab</span></span>
<span id="cb33-24"><a href="#cb33-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-25"><a href="#cb33-25" aria-hidden="true" tabindex="-1"></a>The seaweed <span class="co">[</span><span class="ot">@smit2017seaweeds</span><span class="co">]</span> and toy data are at the links below:</span>
<span id="cb33-26"><a href="#cb33-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-27"><a href="#cb33-27" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The seaweed species data -- <span class="co">[</span><span class="ot">`SeaweedSpp.csv`</span><span class="co">](../data/seaweed/SeaweedSpp.csv)</span></span>
<span id="cb33-28"><a href="#cb33-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-29"><a href="#cb33-29" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The seaweed environmental data -- <span class="co">[</span><span class="ot">`SeaweedEnv.csv`</span><span class="co">](../data/seaweed/SeaweedEnv.csv)</span></span>
<span id="cb33-30"><a href="#cb33-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-31"><a href="#cb33-31" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The seaweed coastal sections -- <span class="co">[</span><span class="ot">`SeaweedSites.csv`</span><span class="co">](../data/seaweed/SeaweedSites.csv)</span></span>
<span id="cb33-32"><a href="#cb33-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-33"><a href="#cb33-33" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The fictitious light data <span class="co">[</span><span class="ot">`light_levels.csv`</span><span class="co">](../data/light_levels.csv)</span></span>
<span id="cb33-34"><a href="#cb33-34" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb33-35"><a href="#cb33-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-36"><a href="#cb33-36" aria-hidden="true" tabindex="-1"></a><span class="fu"># Preparation</span></span>
<span id="cb33-37"><a href="#cb33-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-38"><a href="#cb33-38" aria-hidden="true" tabindex="-1"></a><span class="fu">## The South African seaweed data</span></span>
<span id="cb33-39"><a href="#cb33-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-40"><a href="#cb33-40" aria-hidden="true" tabindex="-1"></a>In these examples, we will use the seaweed data of @smit2017seaweeds.</span>
<span id="cb33-41"><a href="#cb33-41" aria-hidden="true" tabindex="-1"></a>Please make sure that you read this paper. An additional file describing the background to the data is available <span class="co">[</span><span class="ot">here</span><span class="co">](../docs/Smit_the_seaweed_data.pdf)</span> (@fig-seaweed-sections).</span>
<span id="cb33-42"><a href="#cb33-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-43"><a href="#cb33-43" aria-hidden="true" tabindex="-1"></a><span class="al">![The coastal sections and associated seawater temperature profile associated with the study by @smit2017seaweeds.](../images/Seaweed_sections.png)</span>{#fig-seaweed-sections fig-align="center"}</span>
<span id="cb33-44"><a href="#cb33-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-45"><a href="#cb33-45" aria-hidden="true" tabindex="-1"></a>One of the datasets, $Y$ (in the file <span class="in">`SeaweedSpp.csv`</span>),</span>
<span id="cb33-46"><a href="#cb33-46" aria-hidden="true" tabindex="-1"></a>comprises updated distribution records of 847 macroalgal species within each of 58 × 50 km-long sections of the South African coast <span class="co">[</span><span class="ot">@bolton2002seaweed</span><span class="co">]</span>. The dataset captures *ca*. 90% of the known seaweed flora of South Africa, but excludes some very small and/or very rare species for which data are insufficient. The data are from verifiable literature sources and John Bolton and Rob Anderson's collections, assembled from information collected by teams of phycologists over three decades [@bolton1986marine; @stegenga1997seaweeds; @bolton2002seaweed; @de2005guide]. Another file, $E$ (in `env.csv`), is a dataset of *in situ* coastal seawater temperatures derived from daily</span>
<span id="cb33-47"><a href="#cb33-47" aria-hidden="true" tabindex="-1"></a>measurements over 40 years <span class="co">[</span><span class="ot">@smit2013coastal</span><span class="co">]</span>.</span>
<span id="cb33-48"><a href="#cb33-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-49"><a href="#cb33-49" aria-hidden="true" tabindex="-1"></a><span class="fu">## Setting up the analysis environment</span></span>
<span id="cb33-50"><a href="#cb33-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-51"><a href="#cb33-51" aria-hidden="true" tabindex="-1"></a>We will use **R**, so first, we must find, install and load various packages. Some packages will be available on CRAN and can be accessed and installed the usual way, but you will need to download others from <span class="co">[</span><span class="ot">R Forge</span><span class="co">](https://r-forge.r-project.org/R/?group_id=195)</span>.</span>
<span id="cb33-52"><a href="#cb33-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-55"><a href="#cb33-55" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb33-56"><a href="#cb33-56" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb33-57"><a href="#cb33-57" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(vegan)</span>
<span id="cb33-58"><a href="#cb33-58" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(betapart)</span>
<span id="cb33-59"><a href="#cb33-59" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(BiodiversityR) <span class="co"># this package may at times be problematic to install</span></span>
<span id="cb33-60"><a href="#cb33-60" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-61"><a href="#cb33-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-62"><a href="#cb33-62" aria-hidden="true" tabindex="-1"></a><span class="fu">## A look at the data</span></span>
<span id="cb33-63"><a href="#cb33-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-64"><a href="#cb33-64" aria-hidden="true" tabindex="-1"></a>Let's load the data and see how it is structured:</span>
<span id="cb33-65"><a href="#cb33-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-68"><a href="#cb33-68" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb33-69"><a href="#cb33-69" aria-hidden="true" tabindex="-1"></a>spp <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">'../data/seaweed/SeaweedSpp.csv'</span>)</span>
<span id="cb33-70"><a href="#cb33-70" aria-hidden="true" tabindex="-1"></a>spp <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">select</span>(spp, <span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb33-71"><a href="#cb33-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-72"><a href="#cb33-72" aria-hidden="true" tabindex="-1"></a><span class="co"># Lets look at the data:</span></span>
<span id="cb33-73"><a href="#cb33-73" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(spp)</span>
<span id="cb33-74"><a href="#cb33-74" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-75"><a href="#cb33-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-76"><a href="#cb33-76" aria-hidden="true" tabindex="-1"></a>We see that our dataset has 58 rows and 847 columns. What is in the</span>
<span id="cb33-77"><a href="#cb33-77" aria-hidden="true" tabindex="-1"></a>columns and rows? Start with the first five rows and five columns:</span>
<span id="cb33-78"><a href="#cb33-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-81"><a href="#cb33-81" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb33-82"><a href="#cb33-82" aria-hidden="true" tabindex="-1"></a>spp[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb33-83"><a href="#cb33-83" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-84"><a href="#cb33-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-85"><a href="#cb33-85" aria-hidden="true" tabindex="-1"></a>Now the last five rows and five columns:</span>
<span id="cb33-86"><a href="#cb33-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-89"><a href="#cb33-89" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb33-90"><a href="#cb33-90" aria-hidden="true" tabindex="-1"></a>spp[(<span class="fu">nrow</span>(spp) <span class="sc">-</span> <span class="dv">5</span>)<span class="sc">:</span><span class="fu">nrow</span>(spp), (<span class="fu">ncol</span>(spp) <span class="sc">-</span> <span class="dv">5</span>)<span class="sc">:</span><span class="fu">ncol</span>(spp)]</span>
<span id="cb33-91"><a href="#cb33-91" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-92"><a href="#cb33-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-93"><a href="#cb33-93" aria-hidden="true" tabindex="-1"></a>So, each row corresponds to a site (i.e. each of the coastal sections), and each column contains a species. We arrange the species alphabetically and use a six-letter code to identify them.</span>
<span id="cb33-94"><a href="#cb33-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-95"><a href="#cb33-95" aria-hidden="true" tabindex="-1"></a><span class="fu"># Species data</span></span>
<span id="cb33-96"><a href="#cb33-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-97"><a href="#cb33-97" aria-hidden="true" tabindex="-1"></a>When ecologists talk about species diversity, they typically consider the characteristics of biological communities in a specific habitat, ecological community, or ecosystem. Species diversity considers three essential concepts about how species are distributed in space: their **richness**, **abundance**, and **evenness**. We can express each of these as biodiversity metrics that allow us to compare communities in space and time.</span>
<span id="cb33-98"><a href="#cb33-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-99"><a href="#cb33-99" aria-hidden="true" tabindex="-1"></a>When ecologists talk about 'biodiversity', they might not necessarily be</span>
<span id="cb33-100"><a href="#cb33-100" aria-hidden="true" tabindex="-1"></a>interested in *all* the plants and animals and things that are neither</span>
<span id="cb33-101"><a href="#cb33-101" aria-hidden="true" tabindex="-1"></a>plant nor animal that occur at a particular place. Some ecologists are</span>
<span id="cb33-102"><a href="#cb33-102" aria-hidden="true" tabindex="-1"></a>interested in ants and moths. Others might find fish more insightful.</span>
<span id="cb33-103"><a href="#cb33-103" aria-hidden="true" tabindex="-1"></a>Some even like marine mammals! I prefer seaweed. The analysis of</span>
<span id="cb33-104"><a href="#cb33-104" aria-hidden="true" tabindex="-1"></a>biodiversity data might often be constrained to some higher-level taxon,</span>
<span id="cb33-105"><a href="#cb33-105" aria-hidden="true" tabindex="-1"></a>such as all angiosperms in a landscape, reptiles, etc. (but we sample all</span>
<span id="cb33-106"><a href="#cb33-106" aria-hidden="true" tabindex="-1"></a>species in the higher-level taxon). Some ecological</span>
<span id="cb33-107"><a href="#cb33-107" aria-hidden="true" tabindex="-1"></a>questions benefit from comparisons of diversity assessments among</span>
<span id="cb33-108"><a href="#cb33-108" aria-hidden="true" tabindex="-1"></a>selected taxa (avifauna vs small mammals, for example), as this focus</span>
<span id="cb33-109"><a href="#cb33-109" aria-hidden="true" tabindex="-1"></a>might address some particular ecological hypothesis. The bird vs small</span>
<span id="cb33-110"><a href="#cb33-110" aria-hidden="true" tabindex="-1"></a>mammal comparison might reveal how barriers such as</span>
<span id="cb33-111"><a href="#cb33-111" aria-hidden="true" tabindex="-1"></a>streams and rivers structure biodiversity patterns. In our examples, we</span>
<span id="cb33-112"><a href="#cb33-112" aria-hidden="true" tabindex="-1"></a>will use such focused datasets.</span>
<span id="cb33-113"><a href="#cb33-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-114"><a href="#cb33-114" aria-hidden="true" tabindex="-1"></a>Here we look at the various measures of biodiversity, viz. $\alpha$-, $\gamma$- and $\beta$-diversity. David Zelený, in his <span class="co">[</span><span class="ot">Analysis of community data in R</span><span class="co">](https://www.davidzeleny.net/anadat-r/doku.php/en:diversity_analysis)</span>, provides deeper analysis and compulsory reading. </span>
<span id="cb33-115"><a href="#cb33-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-116"><a href="#cb33-116" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--- # Topic 2: Measures of biodiversity ---&gt;</span></span>
<span id="cb33-117"><a href="#cb33-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-118"><a href="#cb33-118" aria-hidden="true" tabindex="-1"></a><span class="fu"># Three measures of biodiversity</span></span>
<span id="cb33-119"><a href="#cb33-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-120"><a href="#cb33-120" aria-hidden="true" tabindex="-1"></a>@whittaker1972evolution coined three measures of biodiversity, and the concepts were ‘modernised’ by @jurasinski2009inventory. The concepts</span>
<span id="cb33-121"><a href="#cb33-121" aria-hidden="true" tabindex="-1"></a>represent the measurement of biodiversity *across different spatial</span>
<span id="cb33-122"><a href="#cb33-122" aria-hidden="true" tabindex="-1"></a>scales*. $\alpha$- and $\gamma$-diversity express the total number of species in an area. The first, $\alpha$-diversity, represents the number of species at the small (local) scale, such as, for example, within a sampling unit like a quadrat, transect, plot, or trawl. Alternatively, maybe the research question represents the local scale by several sampling units nesting within a small patch of landscape and defines the mean species richness within this patch as local. Multiples (sampling units or patches) are nested within a larger region (or ecosystem) and serve as replicates. The complete number of species across all of these replicates indicates the diversity at a larger scale---this is called $\gamma$-diversity. $\beta$-diversity refers to the change in species composition among samples (sites).</span>
<span id="cb33-123"><a href="#cb33-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-124"><a href="#cb33-124" aria-hidden="true" tabindex="-1"></a>By now, you will have received a brief [Introduction to</span>
<span id="cb33-125"><a href="#cb33-125" aria-hidden="true" tabindex="-1"></a>R](02a-r_rstudio.qmd), and we can proceed with looking at</span>
<span id="cb33-126"><a href="#cb33-126" aria-hidden="true" tabindex="-1"></a>some of the measures of biodiversity. We will start by using data on the</span>
<span id="cb33-127"><a href="#cb33-127" aria-hidden="true" tabindex="-1"></a>seaweeds of South Africa to demonstrate some ideas around diversity</span>
<span id="cb33-128"><a href="#cb33-128" aria-hidden="true" tabindex="-1"></a>measures. The **vegan**^<span class="co">[</span><span class="ot">I am by no means an advocate for veganism.</span><span class="co">]</span> (for *vegetation analysis*) package <span class="co">[</span><span class="ot">@oksanen2022vegan</span><span class="co">]</span> offers [various</span>
<span id="cb33-129"><a href="#cb33-129" aria-hidden="true" tabindex="-1"></a>functions](../docs/Oksanen_diversity-vegan.pdf) to calculate diversity</span>
<span id="cb33-130"><a href="#cb33-130" aria-hidden="true" tabindex="-1"></a>indices. I will demonstrate some of these functions below.</span>
<span id="cb33-131"><a href="#cb33-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-132"><a href="#cb33-132" aria-hidden="true" tabindex="-1"></a><span class="fu">## Alpha diversity</span></span>
<span id="cb33-133"><a href="#cb33-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-134"><a href="#cb33-134" aria-hidden="true" tabindex="-1"></a>We can represent $\alpha$-diversity in three ways:</span>
<span id="cb33-135"><a href="#cb33-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-136"><a href="#cb33-136" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>as species richness, $S$;</span>
<span id="cb33-137"><a href="#cb33-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-138"><a href="#cb33-138" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>as a univariate diversity index, such as the $\alpha$ parameter of <span class="co">[</span><span class="ot">Fisher’s log-series</span><span class="co">](04-biodiversity.html#species-abundance-distribution)</span>, Shannon diversity, $H'$, or Simpson’s diversity, $\lambda$;</span>
<span id="cb33-139"><a href="#cb33-139" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb33-140"><a href="#cb33-140" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>Species evenness, e.g. Pielou’s evenness, $J$; or    </span>
<span id="cb33-141"><a href="#cb33-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-142"><a href="#cb33-142" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>as a pairwise dissimilarity index, e.g. Bray-Curtis, Jaccard, or Sørensen dissimilarities---see @koleff2003measuring for many more; also see <span class="in">`?vegdist`</span>. However, discussing pairwise dissimilarities with $\beta$-diversity makes more sense.</span>
<span id="cb33-143"><a href="#cb33-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-144"><a href="#cb33-144" aria-hidden="true" tabindex="-1"></a>We will work through each in turn.</span>
<span id="cb33-145"><a href="#cb33-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-146"><a href="#cb33-146" aria-hidden="true" tabindex="-1"></a><span class="fu">### Species richness, $S$</span></span>
<span id="cb33-147"><a href="#cb33-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-148"><a href="#cb33-148" aria-hidden="true" tabindex="-1"></a>First, is species richness, which we denote by the symbol $S$. In the seaweed biodiversity data---because we view each coastal section as the local scale (the smallest unit of sampling)---I count the number of species within each of the sections.</span>
<span id="cb33-149"><a href="#cb33-149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-150"><a href="#cb33-150" aria-hidden="true" tabindex="-1"></a>The preferred option for calculating species richness is the</span>
<span id="cb33-151"><a href="#cb33-151" aria-hidden="true" tabindex="-1"></a><span class="in">`specnumber()`</span> function in **vegan**:</span>
<span id="cb33-152"><a href="#cb33-152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-155"><a href="#cb33-155" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb33-156"><a href="#cb33-156" aria-hidden="true" tabindex="-1"></a><span class="fu">specnumber</span>(spp, <span class="at">MARGIN =</span> <span class="dv">1</span>)</span>
<span id="cb33-157"><a href="#cb33-157" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-158"><a href="#cb33-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-159"><a href="#cb33-159" aria-hidden="true" tabindex="-1"></a>The data output is easier to understand if we display it as a <span class="in">`tibble()`</span>:</span>
<span id="cb33-160"><a href="#cb33-160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-163"><a href="#cb33-163" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb33-164"><a href="#cb33-164" aria-hidden="true" tabindex="-1"></a><span class="co"># Use 'MARGIN = 1' to calculate the number of species within each row (site)</span></span>
<span id="cb33-165"><a href="#cb33-165" aria-hidden="true" tabindex="-1"></a>spp_richness <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">section =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">58</span>,</span>
<span id="cb33-166"><a href="#cb33-166" aria-hidden="true" tabindex="-1"></a>                       <span class="at">richness =</span> <span class="fu">specnumber</span>(spp, <span class="at">MARGIN =</span> <span class="dv">1</span>))</span>
<span id="cb33-167"><a href="#cb33-167" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(spp_richness)</span>
<span id="cb33-168"><a href="#cb33-168" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-169"><a href="#cb33-169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-170"><a href="#cb33-170" aria-hidden="true" tabindex="-1"></a>The <span class="in">`diversityresult()`</span> function in the **BiodiversityR** package can do</span>
<span id="cb33-171"><a href="#cb33-171" aria-hidden="true" tabindex="-1"></a>the same (sometimes this package is difficult to install due to various</span>
<span id="cb33-172"><a href="#cb33-172" aria-hidden="true" tabindex="-1"></a>software dependencies that might be required for the package to load</span>
<span id="cb33-173"><a href="#cb33-173" aria-hidden="true" tabindex="-1"></a>properly--- do not be sad if this method does not work):</span>
<span id="cb33-174"><a href="#cb33-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-175"><a href="#cb33-175" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, eval=FALSE}</span></span>
<span id="cb33-176"><a href="#cb33-176" aria-hidden="true" tabindex="-1"></a>spp_richness <span class="ot">&lt;-</span> <span class="fu">diversityresult</span>(spp, <span class="at">index =</span> <span class="st">'richness'</span>,</span>
<span id="cb33-177"><a href="#cb33-177" aria-hidden="true" tabindex="-1"></a>                                <span class="at">method =</span> <span class="st">'each site'</span>)</span>
<span id="cb33-178"><a href="#cb33-178" aria-hidden="true" tabindex="-1"></a><span class="co"># spp_richness</span></span>
<span id="cb33-179"><a href="#cb33-179" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-180"><a href="#cb33-180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-181"><a href="#cb33-181" aria-hidden="true" tabindex="-1"></a>Now we make a plot seen in @fig-species-richness:</span>
<span id="cb33-182"><a href="#cb33-182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-185"><a href="#cb33-185" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb33-186"><a href="#cb33-186" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "The seaweed species richness, $S$, within each of the coastal sections along the shore of South Africa."</span></span>
<span id="cb33-187"><a href="#cb33-187" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-species-richness</span></span>
<span id="cb33-188"><a href="#cb33-188" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> spp_richness, (<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">58</span>, <span class="at">y =</span> richness))) <span class="sc">+</span></span>
<span id="cb33-189"><a href="#cb33-189" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">1.2</span>, <span class="at">colour =</span> <span class="st">"indianred"</span>) <span class="sc">+</span></span>
<span id="cb33-190"><a href="#cb33-190" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Coastal section, west to east"</span>) <span class="sc">+</span></span>
<span id="cb33-191"><a href="#cb33-191" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Species richness"</span>) <span class="sc">+</span></span>
<span id="cb33-192"><a href="#cb33-192" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_linedraw</span>()</span>
<span id="cb33-193"><a href="#cb33-193" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-194"><a href="#cb33-194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-195"><a href="#cb33-195" aria-hidden="true" tabindex="-1"></a>In other instances, it makes more sense to calculate the mean species</span>
<span id="cb33-196"><a href="#cb33-196" aria-hidden="true" tabindex="-1"></a>richness of all the sampling units (e.g. quadrats) taken inside the</span>
<span id="cb33-197"><a href="#cb33-197" aria-hidden="true" tabindex="-1"></a>ecosystem of interest. You will have to decide based on your data.</span>
<span id="cb33-198"><a href="#cb33-198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-199"><a href="#cb33-199" aria-hidden="true" tabindex="-1"></a>The mean species richness is:</span>
<span id="cb33-200"><a href="#cb33-200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-203"><a href="#cb33-203" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb33-204"><a href="#cb33-204" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">mean</span>(spp_richness<span class="sc">$</span>richness), <span class="dv">0</span>)</span>
<span id="cb33-205"><a href="#cb33-205" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-206"><a href="#cb33-206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-207"><a href="#cb33-207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-208"><a href="#cb33-208" aria-hidden="true" tabindex="-1"></a><span class="fu">### Univariate diversity indices</span></span>
<span id="cb33-209"><a href="#cb33-209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-210"><a href="#cb33-210" aria-hidden="true" tabindex="-1"></a>The second way we can express $\alpha$-diversity is to use one of the univariate diversity indices such as Fisher's $\alpha$, Shannon's $H'$ or Simpson's $\lambda$.</span>
<span id="cb33-211"><a href="#cb33-211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-212"><a href="#cb33-212" aria-hidden="true" tabindex="-1"></a>The choice of which indices to use should be informed by the</span>
<span id="cb33-213"><a href="#cb33-213" aria-hidden="true" tabindex="-1"></a>extent to which one wants to emphasise richness or evenness. Species</span>
<span id="cb33-214"><a href="#cb33-214" aria-hidden="true" tabindex="-1"></a>richness, $S$, does not consider evenness as it is all about</span>
<span id="cb33-215"><a href="#cb33-215" aria-hidden="true" tabindex="-1"></a>richness (obviously). Simpson's $\lambda$ emphasises evenness a lot more. Shannon's $H'$ is somewhere in the middle.</span>
<span id="cb33-216"><a href="#cb33-216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-217"><a href="#cb33-217" aria-hidden="true" tabindex="-1"></a>**Simpson's $\lambda$**, or simply the Simpson index, is calculated as:</span>
<span id="cb33-218"><a href="#cb33-218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-219"><a href="#cb33-219" aria-hidden="true" tabindex="-1"></a>$$\displaystyle \lambda = \sum_{i=1}^{S} p_{i}^{2}$$ where $S$ is the</span>
<span id="cb33-220"><a href="#cb33-220" aria-hidden="true" tabindex="-1"></a>species richness and $p_{i}$ is the relative abundance of the $i$th</span>
<span id="cb33-221"><a href="#cb33-221" aria-hidden="true" tabindex="-1"></a>species.</span>
<span id="cb33-222"><a href="#cb33-222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-223"><a href="#cb33-223" aria-hidden="true" tabindex="-1"></a>**Shannon's $H'$** is sometimes called Shannon's diversity, the</span>
<span id="cb33-224"><a href="#cb33-224" aria-hidden="true" tabindex="-1"></a>Shannon-Wiener index, the Shannon-Weaver index, or the Shannon entropy.</span>
<span id="cb33-225"><a href="#cb33-225" aria-hidden="true" tabindex="-1"></a>It is calculated as:</span>
<span id="cb33-226"><a href="#cb33-226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-227"><a href="#cb33-227" aria-hidden="true" tabindex="-1"></a>$$H' = -\sum_{i=1}^{S} p_{i} \ln p_{i}$$ where $p_{i}$ is the proportion of individuals belonging to the $i$th species, and $S$ is the species richness.</span>
<span id="cb33-228"><a href="#cb33-228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-229"><a href="#cb33-229" aria-hidden="true" tabindex="-1"></a>**Fisher's $\alpha$** estimates the $\alpha$ parameter of <span class="co">[</span><span class="ot">Fisher's logarithmic series</span><span class="co">](03-04-biodiversity.html#species-abundance-distribution)</span> (see functions <span class="in">`fisher.alpha()`</span> and <span class="in">`fisherfit()`</span>). The estimation is possible only for actual counts (i.e. integers) of individuals, so it will not work for per cent cover, biomass, and other measures that real numbers can express. We will get to this function later under <span class="co">[</span><span class="ot">Fisher's logarithmic series</span><span class="co">](03-04-biodiversity.html#species-abundance-distribution)</span>.</span>
<span id="cb33-230"><a href="#cb33-230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-231"><a href="#cb33-231" aria-hidden="true" tabindex="-1"></a>Except for Fisher's-$\alpha$, we cannot calculate these for the seaweed data because, in order to do so, we require abundance data---the seaweed data are presence-absence only. Let us load a fictitious dataset of the diversity of three different communities of plants, with each community corresponding to a different light environment (dim, mid, and high light):</span>
<span id="cb33-232"><a href="#cb33-232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-235"><a href="#cb33-235" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb33-236"><a href="#cb33-236" aria-hidden="true" tabindex="-1"></a>light <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"../data/light_levels.csv"</span>)</span>
<span id="cb33-237"><a href="#cb33-237" aria-hidden="true" tabindex="-1"></a>light</span>
<span id="cb33-238"><a href="#cb33-238" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-239"><a href="#cb33-239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-240"><a href="#cb33-240" aria-hidden="true" tabindex="-1"></a>We can see above that instead of having data with 1s and 0s for presence-absence, here we have some values that indicate the relative amounts of each of the species in the three light environments. We calculate species richness (as before), and also the Shannon and Simpson indices using **vegan**'s <span class="in">`diversity()`</span> function:</span>
<span id="cb33-241"><a href="#cb33-241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-244"><a href="#cb33-244" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb33-245"><a href="#cb33-245" aria-hidden="true" tabindex="-1"></a>light_div <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb33-246"><a href="#cb33-246" aria-hidden="true" tabindex="-1"></a>  <span class="at">site =</span> <span class="fu">c</span>(<span class="st">"low_light"</span>, <span class="st">"mid_light"</span>, <span class="st">"high_light"</span>),</span>
<span id="cb33-247"><a href="#cb33-247" aria-hidden="true" tabindex="-1"></a>  <span class="at">richness =</span> <span class="fu">specnumber</span>(light[, <span class="dv">2</span><span class="sc">:</span><span class="dv">7</span>], <span class="at">MARGIN =</span> <span class="dv">1</span>),</span>
<span id="cb33-248"><a href="#cb33-248" aria-hidden="true" tabindex="-1"></a>  <span class="at">shannon =</span> <span class="fu">round</span>(<span class="fu">diversity</span>(light[, <span class="dv">2</span><span class="sc">:</span><span class="dv">7</span>], <span class="at">MARGIN =</span> <span class="dv">1</span>, <span class="at">index =</span> <span class="st">"shannon"</span>), <span class="dv">2</span>),</span>
<span id="cb33-249"><a href="#cb33-249" aria-hidden="true" tabindex="-1"></a>  <span class="at">simpson =</span> <span class="fu">round</span>(<span class="fu">diversity</span>(light[, <span class="dv">2</span><span class="sc">:</span><span class="dv">7</span>], <span class="at">MARGIN =</span> <span class="dv">1</span>, <span class="at">index =</span> <span class="st">"simpson"</span>), <span class="dv">2</span>)</span>
<span id="cb33-250"><a href="#cb33-250" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb33-251"><a href="#cb33-251" aria-hidden="true" tabindex="-1"></a>light_div</span>
<span id="cb33-252"><a href="#cb33-252" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-253"><a href="#cb33-253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-254"><a href="#cb33-254" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- Hill numbers, $q$, (Hill, 1973) summarise $S$, Shannon's $H'$ and Simpson's $\lambda$. Higher $q$ puts less weight on rare species and weighs abundant ones more. Hill numbers can be used to draw diversity profiles, which allow for an elegant comparison of diversity among communities considering both richness and evenness. --&gt;</span></span>
<span id="cb33-255"><a href="#cb33-255" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-256"><a href="#cb33-256" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- ```{r fig.height=3, fig.width=5} --&gt;</span></span>
<span id="cb33-257"><a href="#cb33-257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-258"><a href="#cb33-258" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- data(BCI) --&gt;</span></span>
<span id="cb33-259"><a href="#cb33-259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-260"><a href="#cb33-260" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- i &lt;- sample(nrow(BCI), 12) --&gt;</span></span>
<span id="cb33-261"><a href="#cb33-261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-262"><a href="#cb33-262" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- mod &lt;- renyi(BCI[i,]) --&gt;</span></span>
<span id="cb33-263"><a href="#cb33-263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-264"><a href="#cb33-264" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- plot(mod) --&gt;</span></span>
<span id="cb33-265"><a href="#cb33-265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-266"><a href="#cb33-266" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- mod &lt;- renyiaccum(BCI[i,]) --&gt;</span></span>
<span id="cb33-267"><a href="#cb33-267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-268"><a href="#cb33-268" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- plot(mod, as.table=TRUE, col = c(1, 2, 2)) --&gt;</span></span>
<span id="cb33-269"><a href="#cb33-269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-270"><a href="#cb33-270" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- persp(mod) --&gt;</span></span>
<span id="cb33-271"><a href="#cb33-271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-272"><a href="#cb33-272" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- ``` --&gt;</span></span>
<span id="cb33-273"><a href="#cb33-273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-274"><a href="#cb33-274" aria-hidden="true" tabindex="-1"></a><span class="fu">### Species evenness</span></span>
<span id="cb33-275"><a href="#cb33-275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-276"><a href="#cb33-276" aria-hidden="true" tabindex="-1"></a>Evenness refers to the shape of a <span class="co">[</span><span class="ot">species abundance distribution</span><span class="co">](04-biodiversity.html#species-abundance-distribution)</span>.</span>
<span id="cb33-277"><a href="#cb33-277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-278"><a href="#cb33-278" aria-hidden="true" tabindex="-1"></a>One index for evenness is Pielou's evenness, $J$:</span>
<span id="cb33-279"><a href="#cb33-279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-280"><a href="#cb33-280" aria-hidden="true" tabindex="-1"></a>$$J = \frac{H^{\prime}} {log(S)}$$</span>
<span id="cb33-281"><a href="#cb33-281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-282"><a href="#cb33-282" aria-hidden="true" tabindex="-1"></a>where $H'$ is Shannon's diversity index, and $S$ the number of species</span>
<span id="cb33-283"><a href="#cb33-283" aria-hidden="true" tabindex="-1"></a>(i.e. $S$).</span>
<span id="cb33-284"><a href="#cb33-284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-285"><a href="#cb33-285" aria-hidden="true" tabindex="-1"></a>To calculate Pielou's evenness index for the <span class="in">`light`</span> data, we can do</span>
<span id="cb33-286"><a href="#cb33-286" aria-hidden="true" tabindex="-1"></a>this:</span>
<span id="cb33-287"><a href="#cb33-287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-290"><a href="#cb33-290" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb33-291"><a href="#cb33-291" aria-hidden="true" tabindex="-1"></a>H <span class="ot">&lt;-</span> <span class="fu">diversity</span>(light[, <span class="dv">2</span><span class="sc">:</span><span class="dv">7</span>], <span class="at">MARGIN =</span> <span class="dv">1</span>, <span class="at">index =</span> <span class="st">"shannon"</span>)</span>
<span id="cb33-292"><a href="#cb33-292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-293"><a href="#cb33-293" aria-hidden="true" tabindex="-1"></a>J <span class="ot">&lt;-</span> H<span class="sc">/</span><span class="fu">log</span>(<span class="fu">specnumber</span>(light[, <span class="dv">2</span><span class="sc">:</span><span class="dv">7</span>]))</span>
<span id="cb33-294"><a href="#cb33-294" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(J, <span class="dv">2</span>)</span>
<span id="cb33-295"><a href="#cb33-295" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-296"><a href="#cb33-296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-297"><a href="#cb33-297" aria-hidden="true" tabindex="-1"></a><span class="fu">### Dissimilarity indices</span></span>
<span id="cb33-298"><a href="#cb33-298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-299"><a href="#cb33-299" aria-hidden="true" tabindex="-1"></a>In this Section, we will cover the dissimilarity indices, special cases of diversity indices that use pairwise comparisons between sampling units, habitats, or ecosystems. We can express both $\alpha$- and $\beta$-diversity as dissimilarity indices, but let us deal with $\alpha$-diversity first.</span>
<span id="cb33-300"><a href="#cb33-300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-301"><a href="#cb33-301" aria-hidden="true" tabindex="-1"></a>Species dissimilarities result in pairwise matrices similar to the pairwise correlation or Euclidian distance matrices we have seen in <span class="co">[</span><span class="ot">Lab 1</span><span class="co">](01-introduction.qmd)</span>. In <span class="co">[</span><span class="ot">Lab 2b</span><span class="co">](02b-env_dist.qmd)</span> you will have also learned how to calculate these ecological distances in R. These dissimilarity indices are multivariate and compare between sites, sections, plots, etc., and must therefore not be confused with the univariate diversity indices.</span>
<span id="cb33-302"><a href="#cb33-302" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-303"><a href="#cb33-303" aria-hidden="true" tabindex="-1"></a>We use the Bray-Curtis and Jaccard indices with abundance data and the Sørensen dissimilarity with presence-absence data. The seaweed dataset is a presence-absence dataset that necessitates using the Sørensen index. The interpretation of the resulting square (number of rows = number of columns) dissimilarity matrices is the same regardless of whether we calculate it for an abundance or presence-absence dataset. The values in the matrix range from 0 to 1. A 0 means that the pair of sites we compare is identical (all species in common) but 1 means they are completely different (no species in common). In the square dissimilarity matrix, the diagonal is 0, which essentially (and obviously) means that any site is identical to itself. Elsewhere the values will range from 0 to 1. Since this is a pairwise calculation (each site compared to every other site), our seaweed dataset will contain (58 × (58 - 1))/2 = 1653 values, each one ranging from 0 to 1.</span>
<span id="cb33-304"><a href="#cb33-304" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-305"><a href="#cb33-305" aria-hidden="true" tabindex="-1"></a>The first step involves the species table, $Y$. First, we compute the Sørensen dissimilarity index, $\beta_{\text{sør}}$, to compare the dissimilarity of all pairs of coastal sections using presence-absence data. The dissimilarity in species composition between two sections is calculated from three parameters, *viz*., *b* and *c*, which represent the number of species unique to each of the two sites, and *a*, the number of species in common between them. It is given by:</span>
<span id="cb33-306"><a href="#cb33-306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-307"><a href="#cb33-307" aria-hidden="true" tabindex="-1"></a>$$\beta_\text{sør}=\frac{b+c}{2a+b+c}$$</span>
<span id="cb33-308"><a href="#cb33-308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-309"><a href="#cb33-309" aria-hidden="true" tabindex="-1"></a>The **vegan** function <span class="in">`vegdist()`</span> provides access to the dissimilarity indices. We calculate the Sørensen dissimilarity index:</span>
<span id="cb33-310"><a href="#cb33-310" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-313"><a href="#cb33-313" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb33-314"><a href="#cb33-314" aria-hidden="true" tabindex="-1"></a>sor <span class="ot">&lt;-</span> <span class="fu">vegdist</span>(spp, <span class="at">binary =</span> <span class="cn">TRUE</span>) <span class="co"># makes the lower triangle matrix</span></span>
<span id="cb33-315"><a href="#cb33-315" aria-hidden="true" tabindex="-1"></a>sor_df <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">as.matrix</span>(sor), <span class="dv">4</span>)</span>
<span id="cb33-316"><a href="#cb33-316" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(sor_df)</span>
<span id="cb33-317"><a href="#cb33-317" aria-hidden="true" tabindex="-1"></a>sor_df[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>] <span class="co"># the first 10 rows and columns</span></span>
<span id="cb33-318"><a href="#cb33-318" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-319"><a href="#cb33-319" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-320"><a href="#cb33-320" aria-hidden="true" tabindex="-1"></a>What we see above is a square dissimilarity matrix. The most important characteristics of the matrix are:</span>
<span id="cb33-321"><a href="#cb33-321" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-322"><a href="#cb33-322" aria-hidden="true" tabindex="-1"></a>i.  whereas the raw species data, $Y$, is rectangular (number rows ≠ number columns), the dissimilarity matrix is square (number rows = number columns);</span>
<span id="cb33-323"><a href="#cb33-323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-324"><a href="#cb33-324" aria-hidden="true" tabindex="-1"></a>ii. the diagonal is filled with 0;</span>
<span id="cb33-325"><a href="#cb33-325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-326"><a href="#cb33-326" aria-hidden="true" tabindex="-1"></a>iii. the matrix is symmetrical---it is comprised of symetrical upper and lower triangles.</span>
<span id="cb33-327"><a href="#cb33-327" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-328"><a href="#cb33-328" aria-hidden="true" tabindex="-1"></a>Create a data.frame suitable for plotting:</span>
<span id="cb33-331"><a href="#cb33-331" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb33-332"><a href="#cb33-332" aria-hidden="true" tabindex="-1"></a>sor_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">round</span>(<span class="fu">as.matrix</span>(sor), <span class="dv">4</span>))</span>
<span id="cb33-333"><a href="#cb33-333" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-334"><a href="#cb33-334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-335"><a href="#cb33-335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-336"><a href="#cb33-336" aria-hidden="true" tabindex="-1"></a>::: callout-important</span>
<span id="cb33-337"><a href="#cb33-337" aria-hidden="true" tabindex="-1"></a><span class="fu">## Lab 3</span></span>
<span id="cb33-338"><a href="#cb33-338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-339"><a href="#cb33-339" aria-hidden="true" tabindex="-1"></a>These questions concern matrices produced from species data using any of the indices available in <span class="in">`vegdist()`</span>:</span>
<span id="cb33-340"><a href="#cb33-340" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-341"><a href="#cb33-341" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Why is the matrix square, and what determines the</span>
<span id="cb33-342"><a href="#cb33-342" aria-hidden="true" tabindex="-1"></a>number of rows/columns?</span>
<span id="cb33-343"><a href="#cb33-343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-344"><a href="#cb33-344" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>What is the meaning of the diagonal?</span>
<span id="cb33-345"><a href="#cb33-345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-346"><a href="#cb33-346" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>What is the meaning of the non-diagonal elements?</span>
<span id="cb33-347"><a href="#cb33-347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-348"><a href="#cb33-348" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>Referring to the seaweed species data specifically, take the data in row 1 or column 1 and create a line graph showing these values as a function of the section number.</span>
<span id="cb33-349"><a href="#cb33-349" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-350"><a href="#cb33-350" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; Answer:</span></span>
<span id="cb33-351"><a href="#cb33-351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-354"><a href="#cb33-354" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb33-355"><a href="#cb33-355" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> sor_df, (<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">58</span>, <span class="at">y =</span> X1))) <span class="sc">+</span></span>
<span id="cb33-356"><a href="#cb33-356" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">1.2</span>, <span class="at">colour =</span> <span class="st">"indianred"</span>) <span class="sc">+</span></span>
<span id="cb33-357"><a href="#cb33-357" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Coastal section, west to east"</span>) <span class="sc">+</span></span>
<span id="cb33-358"><a href="#cb33-358" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Total beta-diversity"</span>) <span class="sc">+</span></span>
<span id="cb33-359"><a href="#cb33-359" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_linedraw</span>()</span>
<span id="cb33-360"><a href="#cb33-360" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-361"><a href="#cb33-361" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-362"><a href="#cb33-362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-363"><a href="#cb33-363" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span>Provide a mechanistic (ecological) explanation for why this figure takes the shape that it does. Which community assembly process does this hint at?</span>
<span id="cb33-364"><a href="#cb33-364" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb33-365"><a href="#cb33-365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-366"><a href="#cb33-366" aria-hidden="true" tabindex="-1"></a>Dissimilarity indices will be unpacked in more detail under <span class="co">[</span><span class="ot">contemporary views of $\beta$-diversity</span><span class="co">](03-04-biodiversity.html#contemporary-definitions-beta-diversity)</span>.</span>
<span id="cb33-367"><a href="#cb33-367" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-368"><a href="#cb33-368" aria-hidden="true" tabindex="-1"></a><span class="fu">## Gamma diversity</span></span>
<span id="cb33-369"><a href="#cb33-369" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-370"><a href="#cb33-370" aria-hidden="true" tabindex="-1"></a>Staying with the seaweed data, $Y$, let us now look at $\gamma$-diversity---this would be the total number of species along the South African coastline in all 58 coastal sections. Since each column represents one species, and the dataset contains data collected at each of the 58 sites (the number of rows), we can do:</span>
<span id="cb33-371"><a href="#cb33-371" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-374"><a href="#cb33-374" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb33-375"><a href="#cb33-375" aria-hidden="true" tabindex="-1"></a><span class="co"># the number of columns gives the total number of species in this example:</span></span>
<span id="cb33-376"><a href="#cb33-376" aria-hidden="true" tabindex="-1"></a><span class="fu">ncol</span>(spp)</span>
<span id="cb33-377"><a href="#cb33-377" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-378"><a href="#cb33-378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-379"><a href="#cb33-379" aria-hidden="true" tabindex="-1"></a>We can also use:</span>
<span id="cb33-380"><a href="#cb33-380" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-381"><a href="#cb33-381" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, eval=TRUE}</span></span>
<span id="cb33-382"><a href="#cb33-382" aria-hidden="true" tabindex="-1"></a><span class="fu">diversityresult</span>(spp, <span class="at">index =</span> <span class="st">'richness'</span>, <span class="at">method =</span> <span class="st">'pooled'</span>)</span>
<span id="cb33-383"><a href="#cb33-383" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-384"><a href="#cb33-384" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-385"><a href="#cb33-385" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- ```{r} --&gt;</span></span>
<span id="cb33-386"><a href="#cb33-386" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-387"><a href="#cb33-387" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- specpool() --&gt;</span></span>
<span id="cb33-388"><a href="#cb33-388" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-389"><a href="#cb33-389" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- ``` --&gt;</span></span>
<span id="cb33-390"><a href="#cb33-390" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-391"><a href="#cb33-391" aria-hidden="true" tabindex="-1"></a>::: callout-important</span>
<span id="cb33-392"><a href="#cb33-392" aria-hidden="true" tabindex="-1"></a><span class="fu">## Lab 3 (continue)</span></span>
<span id="cb33-393"><a href="#cb33-393" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-394"><a href="#cb33-394" aria-hidden="true" tabindex="-1"></a><span class="ss">6. </span>Why is there a difference between the two?</span>
<span id="cb33-395"><a href="#cb33-395" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-396"><a href="#cb33-396" aria-hidden="true" tabindex="-1"></a><span class="ss">7. </span>Which is correct?</span>
<span id="cb33-397"><a href="#cb33-397" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb33-398"><a href="#cb33-398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-399"><a href="#cb33-399" aria-hidden="true" tabindex="-1"></a>Think before you calculate $\gamma$-diversity for your own data as it might not be as simple as here!</span>
<span id="cb33-400"><a href="#cb33-400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-401"><a href="#cb33-401" aria-hidden="true" tabindex="-1"></a><span class="fu">## Beta-diversity</span></span>
<span id="cb33-402"><a href="#cb33-402" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-403"><a href="#cb33-403" aria-hidden="true" tabindex="-1"></a><span class="fu">### Whittaker's concept of $\beta$-diversity</span></span>
<span id="cb33-404"><a href="#cb33-404" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-405"><a href="#cb33-405" aria-hidden="true" tabindex="-1"></a>The first measure of $\beta$-diversity comes from @whittaker1960vegetation and is called *true $\beta$-diversity*. In this instance, divide the $\gamma$-diversity for the region by the $\alpha$-diversity for a specific coastal section. We can calculate it all at once for the whole dataset and make a graph (@fig-true-beta):</span>
<span id="cb33-406"><a href="#cb33-406" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-409"><a href="#cb33-409" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb33-410"><a href="#cb33-410" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Whittaker’s true β-diversity shown in the seaweed data."</span></span>
<span id="cb33-411"><a href="#cb33-411" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-true-beta</span></span>
<span id="cb33-412"><a href="#cb33-412" aria-hidden="true" tabindex="-1"></a>true_beta <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb33-413"><a href="#cb33-413" aria-hidden="true" tabindex="-1"></a>  <span class="at">beta =</span> <span class="fu">specnumber</span>(spp, <span class="at">MARGIN =</span> <span class="dv">1</span>) <span class="sc">/</span> <span class="fu">ncol</span>(spp),</span>
<span id="cb33-414"><a href="#cb33-414" aria-hidden="true" tabindex="-1"></a>  <span class="at">section_no =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">58</span>)</span>
<span id="cb33-415"><a href="#cb33-415" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb33-416"><a href="#cb33-416" aria-hidden="true" tabindex="-1"></a><span class="co"># true_beta</span></span>
<span id="cb33-417"><a href="#cb33-417" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> true_beta, (<span class="fu">aes</span>(<span class="at">x =</span> section_no, <span class="at">y =</span> beta))) <span class="sc">+</span></span>
<span id="cb33-418"><a href="#cb33-418" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">1.2</span>, <span class="at">colour =</span> <span class="st">"indianred"</span>) <span class="sc">+</span></span>
<span id="cb33-419"><a href="#cb33-419" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Coastal section, west to east"</span>) <span class="sc">+</span></span>
<span id="cb33-420"><a href="#cb33-420" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"True beta-diversity"</span>) <span class="sc">+</span></span>
<span id="cb33-421"><a href="#cb33-421" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_linedraw</span>()</span>
<span id="cb33-422"><a href="#cb33-422" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-423"><a href="#cb33-423" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-424"><a href="#cb33-424" aria-hidden="true" tabindex="-1"></a>The second measure of $\beta$-diversity is *absolute species turnover*, and to calculate this, we subtract $\alpha$-diversity for each  section from the region's $\gamma$-diversity (@fig-abs-beta):</span>
<span id="cb33-425"><a href="#cb33-425" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-428"><a href="#cb33-428" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb33-429"><a href="#cb33-429" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Whittaker’s absolute species turnover shown in action in the seaweed data."</span></span>
<span id="cb33-430"><a href="#cb33-430" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-abs-beta</span></span>
<span id="cb33-431"><a href="#cb33-431" aria-hidden="true" tabindex="-1"></a>abs_beta <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb33-432"><a href="#cb33-432" aria-hidden="true" tabindex="-1"></a>  <span class="at">beta =</span> <span class="fu">ncol</span>(spp) <span class="sc">-</span> <span class="fu">specnumber</span>(spp, <span class="at">MARGIN =</span> <span class="dv">1</span>),</span>
<span id="cb33-433"><a href="#cb33-433" aria-hidden="true" tabindex="-1"></a>  <span class="at">section_no =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">58</span>)</span>
<span id="cb33-434"><a href="#cb33-434" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb33-435"><a href="#cb33-435" aria-hidden="true" tabindex="-1"></a><span class="co"># abs_beta</span></span>
<span id="cb33-436"><a href="#cb33-436" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> abs_beta, (<span class="fu">aes</span>(<span class="at">x =</span> section_no, <span class="at">y =</span> beta))) <span class="sc">+</span></span>
<span id="cb33-437"><a href="#cb33-437" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">1.2</span>, <span class="at">colour =</span> <span class="st">"indianred"</span>) <span class="sc">+</span></span>
<span id="cb33-438"><a href="#cb33-438" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Coastal section, west to east"</span>) <span class="sc">+</span></span>
<span id="cb33-439"><a href="#cb33-439" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Absolute beta-diversity"</span>) <span class="sc">+</span></span>
<span id="cb33-440"><a href="#cb33-440" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_linedraw</span>()</span>
<span id="cb33-441"><a href="#cb33-441" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-442"><a href="#cb33-442" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-443"><a href="#cb33-443" aria-hidden="true" tabindex="-1"></a><span class="fu">### Contemporary definitions $\beta$-diversity</span></span>
<span id="cb33-444"><a href="#cb33-444" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-445"><a href="#cb33-445" aria-hidden="true" tabindex="-1"></a>Contemporary views of $\beta$-diversity are available by @nekola1999distance, @baselga2010partitioning, and @anderson2011navigating. Nowadays, we see $\beta$-diversity is a concept that describes how species assemblages (communities) measured within the ecosystem of interest vary from place to place, e.g. between the various transects or quadrats used to sample the ecosystem. $\beta$-diversity results from habitat heterogeneity (along gradients or randomly). We have already seen two concepts of $\beta$-diversity, viz. true $\beta$-diversity and absolute species turnover---both rely on knowledge of species richness at local (a measure of $\alpha$-diversity) and regional ($\gamma$-diversity) scales. However, more insight into **species assembly processes** can be extracted when we view $\beta$-diversity as a dissimilarity index. In this view, we will see that there are *two processes* by which $\beta$-diversity might be affected (i.e. in which the patterning of communities over landscapes might arise). These offer glimpses into mechanistic influences on how ecosystems are structured.</span>
<span id="cb33-446"><a href="#cb33-446" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-447"><a href="#cb33-447" aria-hidden="true" tabindex="-1"></a>**Process 1:** If a region comprises the species A, B, C, ..., M</span>
<span id="cb33-448"><a href="#cb33-448" aria-hidden="true" tabindex="-1"></a>(i.e. $\gamma$-diversity is 13), a subset of the regional flora captured by one quadrat might be species **A**, **D**, E. In another quadrat species **A**, **D**, F might be present. $\alpha$-diversity is three in both instances, and heterogeneity (and hence $\beta$-diversity) results from the fact that the first quadrat has species E, but the other has species F. In other words, here, we have the same number of species in both quadrats, but only two of the species are the same. The process responsible for this form of $\beta$-diversity is species **turnover**, $\beta_\text{sim}$. Turnover refers to processes that cause communities to differ due to species being lost or gained from section to section, i.e. the species composition changes between sections without corresponding changes in $\alpha$-diversity. The  function `beta()` in the R package **BAT** calls this form of $\beta$ diversity **replacement** and use the symbol $\beta_{repl}$ (@cardoso2015bat).</span>
<span id="cb33-449"><a href="#cb33-449" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-450"><a href="#cb33-450" aria-hidden="true" tabindex="-1"></a>**Process 2:** Consider again species A, B, C, ..., M. Now we have a quadrat with species **A**, **B**, C, D, **G**, H ($\alpha$-diversity is</span>
<span id="cb33-451"><a href="#cb33-451" aria-hidden="true" tabindex="-1"></a>six) but another quadrat has a subset of these species, e.g. only species **A**, **B**, **G** ($\alpha$-diversity three). Here, $\beta$-diversity is high even though the quadrats share *some* species, but the number of species differs among the quadrats (i.e. from place to place) due to one quadrat capturing only a subset of species present in the other. This</span>
<span id="cb33-452"><a href="#cb33-452" aria-hidden="true" tabindex="-1"></a>form of $\beta$-diversity is called **nestedness-resultant** $\beta$-diversity, $\beta_\text{sne}$, and it refers to processes that cause species to be gained or lost, and the community with the lowest $\alpha$-diversity is a subset of the richer community. The function `beta()` in the R package **BAT** calls this form of $\beta$ diversity *richness difference** and uses the symbol $\beta_{rich}$ (@cardoso2015bat).</span>
<span id="cb33-453"><a href="#cb33-453" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-454"><a href="#cb33-454" aria-hidden="true" tabindex="-1"></a>The above two examples show that $\beta$-diversity is coupled not only with the identity of the species in the quadrats but also $\alpha$-diversity---with species richness in particular.</span>
<span id="cb33-455"><a href="#cb33-455" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-456"><a href="#cb33-456" aria-hidden="true" tabindex="-1"></a>We express $\beta$-diversity as nestedness-resultant, $\beta_\text{sne}$, and turnover, $\beta_\text{sim}$, components to be able to distinguish between these two processes. It allows us to make inferences about the two possible drivers of $\beta$-diversity. Turnover refers to processes that cause communities to differ due to species being lost or gained from section to section, i.e. the species composition changes between sections without corresponding changes in $\alpha$-diversity. The nestedness-resultant component implies processes that cause species to be gained or lost without replacement, and the community with the lowest $\alpha$-diversity is a subset of the richer community.</span>
<span id="cb33-457"><a href="#cb33-457" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-458"><a href="#cb33-458" aria-hidden="true" tabindex="-1"></a>According to @nekola1999distance on p. 868, there are *two causes* of ecological distance decay. 'Ecological' is key to the first cause---it is environmental filtering results in a decrease in similarity as the distance between sites increases. We sometimes call this the **niche difference model**. Such patterns are typically visible along steep environmental gradients such as elevation slopes (mountains), latitude, or depth in the ocean, to name only three. It is also the dominant mechanism underlying island biogeography.</span>
<span id="cb33-459"><a href="#cb33-459" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-460"><a href="#cb33-460" aria-hidden="true" tabindex="-1"></a>The second cause of distance decay *sensu* @nekola1999distance involves aspects of the spatial configuration, context of the habitats, and some temporal considerations. Here, the evolutionary differences between species---specifically around those traits that affect their ability to disperse---are more at play and are the primary influences of distance decay rates that might vary between species. Let us first consider some properties of a hypothetical homogeneous landscape. The landscape creates some impediment (resistance) to the propagation of some species (hypothetically species A, B, and C) across its surface, but which are less effective in impeding others (D, E, and F). For argument's sake, all species (A, ..., F) share similar environmental tolerances to the prevailing environmental conditions, so one can argue that the niche difference model (environmental filtering) does not explain distributional patterns. Given a particular founding or disturbance event, species D, E, and F will, in a relatively shorter period, be able to become evenly distributed (relatively similar abundances everywhere) across this landscape. However, the less vagile (in terms of dispersal ability), species A, B, and C will develop a steeper gradient of decreasing species abundances away from the founding populations (resulting from, for example, adaptive radiation). They will require more time to become homogeneously dispersed across the landscape. In this regard, historical events set up striking distributional patterns that can be mistaken for gradients, which exist because insufficient time has passed to ensure complete dispersal. Studying the influence of such past events is called 'historical biogeography.' In reality, landscapes are seldom homogeneous in their spatial template (e.g. there are hills and valleys), and variable dispersal mechanisms and abilities will interact with this heterogeneous landscape to form interesting patterns of communities. The ecologist will have an exciting time figuring out the relative importance of actual gradients vs those that result from evolved traits that affect their dispersal ability and interact with the environment. I have not said anything about 'neutral theories' <span class="co">[</span><span class="ot">but which are seen in the $\beta_\text{sne}$ form of $\beta$-diversity as in @smit2017seaweeds</span><span class="co">]</span>, nor biological interactions that might affect community structure.</span>
<span id="cb33-461"><a href="#cb33-461" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-462"><a href="#cb33-462" aria-hidden="true" tabindex="-1"></a>How do we calculate the turnover and nestedness-resultant components of $\beta$-diversity? The **betapart** package <span class="co">[</span><span class="ot">@baselga2022betapart</span><span class="co">]</span> comes to the rescue. We decompose the dissimilarity into the $\beta_\text{sim}$ and $\beta_\text{sne}$ components <span class="co">[</span><span class="ot">@baselga2010partitioning</span><span class="co">]</span> using the <span class="in">`betapart.core()`</span> and <span class="in">`betapart.pair()`</span> functions. The outcomes of this partitioning calculation are placed into the matrices $Y1$ and $Y2$. These data can then be analysed further---e.g. we can apply a principal components analysis (PCA) or another multivariate analysis on $Y$ to find the major patterns in the community data---we will do this in a later section.</span>
<span id="cb33-463"><a href="#cb33-463" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-466"><a href="#cb33-466" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb33-467"><a href="#cb33-467" aria-hidden="true" tabindex="-1"></a><span class="co"># Decompose total Sørensen dissimilarity into turnover and nestedness-resultant</span></span>
<span id="cb33-468"><a href="#cb33-468" aria-hidden="true" tabindex="-1"></a><span class="co"># components:</span></span>
<span id="cb33-469"><a href="#cb33-469" aria-hidden="true" tabindex="-1"></a>Y.core <span class="ot">&lt;-</span> <span class="fu">betapart.core</span>(spp)</span>
<span id="cb33-470"><a href="#cb33-470" aria-hidden="true" tabindex="-1"></a>Y.pair <span class="ot">&lt;-</span> <span class="fu">beta.pair</span>(Y.core, <span class="at">index.family =</span> <span class="st">"sor"</span>)</span>
<span id="cb33-471"><a href="#cb33-471" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-472"><a href="#cb33-472" aria-hidden="true" tabindex="-1"></a><span class="co"># Let Y1 be the turnover component (beta-sim):</span></span>
<span id="cb33-473"><a href="#cb33-473" aria-hidden="true" tabindex="-1"></a>Y1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">round</span>(<span class="fu">as.matrix</span>(Y.pair<span class="sc">$</span>beta.sim), <span class="dv">3</span>))</span>
<span id="cb33-474"><a href="#cb33-474" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-475"><a href="#cb33-475" aria-hidden="true" tabindex="-1"></a><span class="co"># Let Y2 be the nestedness-resultant component (beta-sne):</span></span>
<span id="cb33-476"><a href="#cb33-476" aria-hidden="true" tabindex="-1"></a>Y2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">round</span>(<span class="fu">as.matrix</span>(Y.pair<span class="sc">$</span>beta.sne), <span class="dv">3</span>))</span>
<span id="cb33-477"><a href="#cb33-477" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-478"><a href="#cb33-478" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-479"><a href="#cb33-479" aria-hidden="true" tabindex="-1"></a>A portion of the turnover component matrix:</span>
<span id="cb33-482"><a href="#cb33-482" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb33-483"><a href="#cb33-483" aria-hidden="true" tabindex="-1"></a>Y1[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>]</span>
<span id="cb33-484"><a href="#cb33-484" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-485"><a href="#cb33-485" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-486"><a href="#cb33-486" aria-hidden="true" tabindex="-1"></a>A portion of the nestedness-resultant matrix:</span>
<span id="cb33-489"><a href="#cb33-489" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb33-490"><a href="#cb33-490" aria-hidden="true" tabindex="-1"></a>Y2[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>]</span>
<span id="cb33-491"><a href="#cb33-491" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-492"><a href="#cb33-492" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-493"><a href="#cb33-493" aria-hidden="true" tabindex="-1"></a>A portion of the nestedness-resultant matrix reformatted as a <span class="in">`tibble()`</span>^<span class="co">[</span><span class="ot">Note that the rows are no longer numbered in the tibble view, but it can easily be recreated by `seq(1:58)`.</span><span class="co">]</span>:</span>
<span id="cb33-496"><a href="#cb33-496" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb33-497"><a href="#cb33-497" aria-hidden="true" tabindex="-1"></a>Y2_tib <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(Y2)</span>
<span id="cb33-498"><a href="#cb33-498" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(Y2_tib)</span>
<span id="cb33-499"><a href="#cb33-499" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-500"><a href="#cb33-500" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-501"><a href="#cb33-501" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-502"><a href="#cb33-502" aria-hidden="true" tabindex="-1"></a>::: callout-important</span>
<span id="cb33-503"><a href="#cb33-503" aria-hidden="true" tabindex="-1"></a><span class="fu">## Lab 3 (continue)</span></span>
<span id="cb33-504"><a href="#cb33-504" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-505"><a href="#cb33-505" aria-hidden="true" tabindex="-1"></a><span class="ss">8. </span>Plot species turnover as a function of Section number,</span>
<span id="cb33-506"><a href="#cb33-506" aria-hidden="true" tabindex="-1"></a>and provide a mechanistic explanation for the pattern observed.</span>
<span id="cb33-507"><a href="#cb33-507" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-508"><a href="#cb33-508" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; Answer</span></span>
<span id="cb33-509"><a href="#cb33-509" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-512"><a href="#cb33-512" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb33-513"><a href="#cb33-513" aria-hidden="true" tabindex="-1"></a><span class="co"># The turnover component</span></span>
<span id="cb33-514"><a href="#cb33-514" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> Y1, (<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">58</span>, <span class="at">y =</span> X1))) <span class="sc">+</span></span>
<span id="cb33-515"><a href="#cb33-515" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">1.2</span>, <span class="at">colour =</span> <span class="st">"indianred"</span>) <span class="sc">+</span></span>
<span id="cb33-516"><a href="#cb33-516" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Coastal section, west to east"</span>) <span class="sc">+</span></span>
<span id="cb33-517"><a href="#cb33-517" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Species richness"</span>) <span class="sc">+</span></span>
<span id="cb33-518"><a href="#cb33-518" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_linedraw</span>()</span>
<span id="cb33-519"><a href="#cb33-519" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-520"><a href="#cb33-520" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-521"><a href="#cb33-521" aria-hidden="true" tabindex="-1"></a><span class="ss">9. </span>Based on an assessment of literature on the topic,</span>
<span id="cb33-522"><a href="#cb33-522" aria-hidden="true" tabindex="-1"></a>provide a discussion of nestedness-resultant $\beta$-diversity. Use either a</span>
<span id="cb33-523"><a href="#cb33-523" aria-hidden="true" tabindex="-1"></a>marine or terrestrial example to explain this mode of structuring biodiversity (i.e. assembly of species into a community).</span>
<span id="cb33-524"><a href="#cb33-524" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb33-525"><a href="#cb33-525" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-526"><a href="#cb33-526" aria-hidden="true" tabindex="-1"></a>:::{.callout-important}</span>
<span id="cb33-527"><a href="#cb33-527" aria-hidden="true" tabindex="-1"></a><span class="fu">## Submission instructions</span></span>
<span id="cb33-528"><a href="#cb33-528" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-529"><a href="#cb33-529" aria-hidden="true" tabindex="-1"></a>The Lab 3 assignment on Species Data was discussed on Monday 15 August</span>
<span id="cb33-530"><a href="#cb33-530" aria-hidden="true" tabindex="-1"></a>and is due at **07:00 on Monday 22 August 2022**.</span>
<span id="cb33-531"><a href="#cb33-531" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-532"><a href="#cb33-532" aria-hidden="true" tabindex="-1"></a>Provide a **neat and thoroughly annotated** R file which can recreate all the</span>
<span id="cb33-533"><a href="#cb33-533" aria-hidden="true" tabindex="-1"></a>graphs and all calculations. Written answers must be typed in the same file as comments.</span>
<span id="cb33-534"><a href="#cb33-534" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-535"><a href="#cb33-535" aria-hidden="true" tabindex="-1"></a>Please label the R file as follows:</span>
<span id="cb33-536"><a href="#cb33-536" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-537"><a href="#cb33-537" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`BDC334_&lt;first_name&gt;_&lt;last_name&gt;_Lab_3.R`</span></span>
<span id="cb33-538"><a href="#cb33-538" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-539"><a href="#cb33-539" aria-hidden="true" tabindex="-1"></a>(the <span class="in">`&lt;`</span> and <span class="in">`&gt;`</span> must be omitted as they are used in the example as</span>
<span id="cb33-540"><a href="#cb33-540" aria-hidden="true" tabindex="-1"></a>field indicators only).</span>
<span id="cb33-541"><a href="#cb33-541" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-542"><a href="#cb33-542" aria-hidden="true" tabindex="-1"></a>Submit your appropriately named R documents on iKamva when ready.</span>
<span id="cb33-543"><a href="#cb33-543" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-544"><a href="#cb33-544" aria-hidden="true" tabindex="-1"></a>Failing to follow these instructions carefully, precisely, and</span>
<span id="cb33-545"><a href="#cb33-545" aria-hidden="true" tabindex="-1"></a>thoroughly will cause you to lose marks, which could cause a significant</span>
<span id="cb33-546"><a href="#cb33-546" aria-hidden="true" tabindex="-1"></a>drop in your score as formatting counts for 15% of the final mark (out</span>
<span id="cb33-547"><a href="#cb33-547" aria-hidden="true" tabindex="-1"></a>of 100%).</span>
<span id="cb33-548"><a href="#cb33-548" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb33-549"><a href="#cb33-549" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-550"><a href="#cb33-550" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-551"><a href="#cb33-551" aria-hidden="true" tabindex="-1"></a><span class="fu">##     References</span></span>
<span id="cb33-552"><a href="#cb33-552" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-553"><a href="#cb33-553" aria-hidden="true" tabindex="-1"></a>::: {#refs}</span>
<span id="cb33-554"><a href="#cb33-554" aria-hidden="true" tabindex="-1"></a>:::</span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">© 2023, AJ Smit</div>   
    <div class="nav-footer-center"><div class="cookie-consent-footer"><a href="#" id="open_preferences_center">Cookie Preferences</a></div></div>
    <div class="nav-footer-right">This page is built with <a href="https://quarto.org/">Quarto</a>.</div>
  </div>
</footer>


<script src="../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>