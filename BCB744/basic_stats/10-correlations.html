<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.33">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="Smit, A. J.">
<meta name="dcterms.date" content="2021-01-01">
<title>10. Correlations – The Tangled Bank</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../BCB744/basic_stats/11-decision_guide.html" rel="next">
<link href="../../BCB744/basic_stats/09-regressions.html" rel="prev">
<link href="../../images/favicon.ico" rel="icon">
<script src="../../site_libs/cookie-consent/cookie-consent.js"></script>
<link href="../../site_libs/cookie-consent/cookie-consent.css" rel="stylesheet">
<script src="../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-59898bd1c6b9d2bb783127feaa000c76.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-7116f089cfdb46b66375c744b53d3c7f.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script src="../../site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="../../site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="../../site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-SCYH68M489"></script><script type="text/plain" cookie-consent="tracking">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-SCYH68M489', { 'anonymize_ip': true});
</script><script type="text/javascript" charset="UTF-8">
document.addEventListener('DOMContentLoaded', function () {
cookieconsent.run({
  "notice_banner_type":"headline",
  "consent_type":"express",
  "palette":"light",
  "language":"en",
  "page_load_consent_levels":["strictly-necessary"],
  "notice_banner_reject_button_hide":false,
  "preferences_center_close_button_hide":false,
  "website_name":""
  ,
"language":"en"
  });
});
</script><style>html{ scroll-behavior: smooth; }</style>
<script async="" src="https://hypothes.is/embed.js"></script><script>
  window.document.addEventListener("DOMContentLoaded", function (_event) {
    document.body.classList.add('hypothesis-enabled');
  });
</script><script src="../../site_libs/kePrint-0.0.1/kePrint.js"></script><link href="../../site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script><link rel="stylesheet" href="../../LesCodex2.css">
<meta property="og:title" content="10. Correlations – The Tangled Bank">
<meta property="og:description" content="The association between continuous variables">
<meta property="og:image" content="http://tangledbank.netlify.app/BCB744/basic_stats/data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==">
<meta property="og:site_name" content="The Tangled Bank">
</head>
<body class="nav-sidebar floating nav-fixed slimcontent quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="navbar navbar-expand-lg " data-bs-theme="dark"><div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">The Tangled Bank</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
<li class="nav-item">
    <a class="nav-link active" href="../../index.html" aria-current="page"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-vignettes" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Vignettes</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-vignettes">
<li>
    <a class="dropdown-item" href="../../vignettes/netCDF_dates.html">
 <span class="dropdown-text">Dates From netCDF Files: Two Approaches</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../vignettes/prep_NOAA_OISST.html">
 <span class="dropdown-text">Downloading and Prep: ERDDAP</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../vignettes/chl_ERDDAP.html">
 <span class="dropdown-text">Retrieving Chlorophyll-a Data from ERDDAP Servers</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../vignettes/alt_method.html">
 <span class="dropdown-text">Downloading and Prep: Python + CDO</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../vignettes/gridded_data.html">
 <span class="dropdown-text">Detecting Events in Gridded Data</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../vignettes/regridding.html">
 <span class="dropdown-text">Regridding gridded data</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../vignettes/MHW_MCS_horizonplots.html">
 <span class="dropdown-text">Displaying MHWs and MCSs as Horizon Plots</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../vignettes/heatwaveR_issues.html">
 <span class="dropdown-text">heatwaveR Issues</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../vignettes/chl_sightings.html">
 <span class="dropdown-text">Plotting the Whale Sightings and Chlorophyll-<em>a</em> Concentrations</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../vignettes/chl_localisation.html">
 <span class="dropdown-text">Spatial Localisation, Subsetting, and Aggregation of the Chlorophyll-<em>a</em> Data</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../vignettes/elem_ts_methods.html">
 <span class="dropdown-text">Wavelet Analysis of Diatom Time Series</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../vignettes/buffer_data_extract.html">
 <span class="dropdown-text">Extracting gridded data within a buffer</span></a>
  </li>  
    </ul>
</li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-high-performace-computing" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">High-Performace Computing</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-high-performace-computing">
<li>
    <a class="dropdown-item" href="../../vignettes/README_Lengau.html">
 <span class="dropdown-text">Using Lengau</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../vignettes/PBSPro_users.html">
 <span class="dropdown-text">PBSPro user and job management</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../vignettes/README_tmux.html">
 <span class="dropdown-text">Using tmux</span></a>
  </li>  
    </ul>
</li>
  <li class="nav-item">
    <a class="nav-link" href="../../blog.html"> 
<span class="menu-text">Tangled Bank Blog</span></a>
  </li>  
</ul>
<ul class="navbar-nav navbar-nav-scroll ms-auto">
<li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-blogroll" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Blogroll</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-blogroll">
<li>
    <a class="dropdown-item" href="https://www.r-bloggers.com">
 <span class="dropdown-text">R-bloggers</span></a>
  </li>  
    </ul>
</li>
  <li class="nav-item compact">
    <a class="nav-link" href="../../blog.xml"> <i class="bi bi-rss" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-bi-github" role="link" data-bs-toggle="dropdown" aria-expanded="false">
      <i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-bi-github">
<li>
    <a class="dropdown-item" href="https://github.com/ajsmit/tangled_bank">
 <span class="dropdown-text">Source Code</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://bugs.com">
 <span class="dropdown-text">Report a Bug</span></a>
  </li>  
    </ul>
</li>
</ul>
</div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
      </div> <!-- /container-fluid -->
    </nav><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../BCB744/BCB744_index.html">BCB744: Introduction to R, &amp; Biostatistics</a></li><li class="breadcrumb-item"><a href="../../BCB744/basic_stats/10-correlations.html">10. Correlations</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="../../index.html" class="sidebar-logo-link">
      <img src="../../images/my_tree_hex.png" alt="" class="sidebar-logo py-0 d-lg-inline d-none"></a>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Home</span></a>
  </div>
</li>
        <li class="sidebar-item">
 <span class="menu-text">☘☘☘</span>
  </li>
        <li class="sidebar-item">
 <span class="menu-text">UNDERGRADUATE</span>
  </li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false">
 <span class="menu-text">BDC223: Plant Ecophysiology</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BDC223/BDC223_index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><strong>About</strong></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BDC223/L00-introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lecture 0: Introduction</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BDC223/L01-worldmapper.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lecture 1: Worldmapper</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BDC223/L02-SA_V.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lecture 2: Surface Area to Volume (SA/V) Ratios in Biology</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BDC223/L03-plant_stress.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lecture 3: Plant Stress</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BDC223/L04-carbon_cycle.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lecture 4: Perturbations to the Carbon Cycle</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BDC223/L05-light.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lecture 5: Light</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BDC223/L06a-pigments_photosynthesis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lecture 6a: Pigments and Photosynthesis</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BDC223/L06b-jassby_platt.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lecture 6b: PI Curves – Jassby and Platt</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BDC223/L07-chromatic_adaptation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lecture 7: Chromatic Adaptation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BDC223/L08a-nutrient_uptake.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lecture 8a: Nutrient Uptake</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BDC223/L08b-nutrients_michaelis_menten.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lecture 8b: Uptake Kinetics – Michaelis-Menten</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BDC223/Lab1_SA_V.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lab 1: Surface Area to Volume (SA/V) Ratios in Biology</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BDC223/Lab2_misc_calcs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lab 2: Miscellaneous Calculations</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BDC223/Lab3_PI_curves.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lab 3: PI Curves – Jassby and Platt</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BDC223/Lab4_nitrogen_uptake.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lab 4: Uptake Kinetics – Michaelis-Menten</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BDC223/BDC223_FAQ.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">FAQ</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false">
 <span class="menu-text">BDC334: Biogeography &amp; Global Ecology</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BDC334/BDC334_syllabus.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><strong>About</strong></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BDC334/BDC334-Lecture-Transcripts.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="my-highlight">BCB334 Lecture Transcript</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BDC334/Lec-01-introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lecture 1: Introductory Lecture</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BDC334/Lec-02-ecosystems.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lecture 2. Overview of Ecosystems</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BDC334/Lec-03-gradients.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lecture 3. Ecological Gradients</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BDC334/Lec-04-biodiversity.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lecture 4: Biodiversity Concepts</span></a>
  </div>
</li>
          <li class="sidebar-item">
 <span class="menu-text">Lecture 5: Multivariate Data</span>
  </li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BDC334/Lec-06-unified-ecology.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lecture 6: Unified Ecology</span></a>
  </div>
</li>
          <li class="sidebar-item">
 <span class="menu-text">Lecture 7: Threats to Biodiversity</span>
  </li>
          <li class="sidebar-item">
 <span class="menu-text">Lecture 8: Nature's Contribution to People</span>
  </li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/IKS_Conservation.pdf" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lecture 9: Indigenous Knowledge Systems and Conservation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BDC334/Lab-01-introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lab 1. Ecological Data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BDC334/Lab-02a-r_rstudio.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lab 2a. Introduction `R` &amp; RStudio</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BDC334/Lab-02b-env_dist.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lab 2b. Environmental Distance</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BDC334/Lab-03-biodiversity.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lab 3. Quantifying Biodiversity</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BDC334/Lab-04-biodiversity.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lab 4. Species Distribution Patterns</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BDC334/BDC334_AI_Tutor.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="my-highlight">BCB334 AI Tutor</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../pages/Transboundary_systems.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Transboundary systems</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item">
 <span class="menu-text">☘☘☘</span>
  </li>
        <li class="sidebar-item">
 <span class="menu-text">HONOURS CORE</span>
  </li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">BCB744: Introduction to R, &amp; Biostatistics</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BCB744/BCB744_index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><strong>About</strong></span></a>
  </div>
</li>
          <li class="px-0"><hr class="sidebar-divider hi "></li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BCB744/intro_r/01-RStudio.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">1. R &amp; RStudio</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BCB744/intro_r/02-working-with-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">2. Working With Data &amp; Code</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BCB744/intro_r/03-data-in-R.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">3. Data Classes &amp; Structures</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BCB744/intro_r/04-workflow.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">4. R Workflows</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BCB744/intro_r/05-graphics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">5. Graphics with <strong>ggplot2</strong></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BCB744/intro_r/06-faceting.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">6. Faceting Figures</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BCB744/intro_r/07-brewing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">7. Brewing Colours</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BCB744/intro_r/08-mapping.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">8. Mapping With <strong>ggplot2</strong></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BCB744/intro_r/09-mapping_style.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">9. Mapping With Style</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BCB744/intro_r/10-mapping_rnaturalearth.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">10. Mapping With Natural Earth</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BCB744/intro_r/11-mapping_quakes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">11. The Fiji Earthquake Data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BCB744/intro_r/12-tidy.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">12. Tidy Data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BCB744/intro_r/13-tidier.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">13. Tidier Data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BCB744/intro_r/14-tidiest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">14. Tidiest Data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BCB744/intro_r/15-recap.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">15. Recap</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../assessments/BCB744_Intro_R_Self-Assessment.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="my-highlight">Intro R Self-Assessment</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../assessments/examples/BCB744_Intro_R_Example_1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">BCB744 Intro R Example 1</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../assessments/examples/BCB744_Intro_R_Example_2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">BCB744 Intro R Example 2</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../self-assessment_v1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Self-Assessment Form</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../assessments/BCB744_Intro_R_Presentations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="my-highlight">Presentations</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../assessments/BCB744_Intro_R_Test_2025.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="my-highlight">Intro R Test</span></span></a>
  </div>
</li>
          <li class="px-0"><hr class="sidebar-divider hi "></li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BCB744/basic_stats/01-scientific-philosophy.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">1. Philosophy of Science</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BCB744/basic_stats/02-summarise-and-describe.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">2. Data Summaries &amp; Descriptions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BCB744/basic_stats/03-visualise.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">3. Statistical Figures</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BCB744/basic_stats/04-distributions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">4. Data Distributions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BCB744/basic_stats/05-inference.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">5. Statistical Inference</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BCB744/basic_stats/06-assumptions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">6. Assumptions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BCB744/basic_stats/07-t_tests.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">7. <em>t</em>-Tests</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BCB744/basic_stats/08-anova.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">8. ANOVA</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BCB744/basic_stats/09-regressions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">9. Simple Linear Regressions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BCB744/basic_stats/10-correlations.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">10. Correlations</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BCB744/basic_stats/11-decision_guide.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">11. Parametric Tests</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BCB744/basic_stats/12-glance.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">12. Non-Parametric Tests</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BCB744/basic_stats/13-confidence.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">13. Confidence Intervals</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BCB744/basic_stats/14-transformations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">14. Data Transformations</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../assessments/BCB744_Biostatistics_Self-Assessment.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="my-highlight">Biostatistics Self-Assessment</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../assessments/examples/BCB744_BioStats_Example_1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">BCB744 BioStats 2025 Example 1</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item">
 <span class="menu-text">☘☘☘</span>
  </li>
        <li class="sidebar-item">
 <span class="menu-text">HONOURS ELECTIVES</span>
  </li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false">
 <span class="menu-text">BCB743: Quantitative Ecology</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BCB743/BCB743_index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><strong>About</strong></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BCB743/review.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">1-4: Review Concepts fo Biodiversity</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BCB743/correlations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">5: Correlations &amp; Associations</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BCB743/ordination.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">7: Intro to Ordination</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BCB743/PCA.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">8a: Principal Components Analysis</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BCB743/PCA_examples.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">8b: PCA: Additional Examples</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BCB743/PCA_SDG_example.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">8c: PCA: WHO SDG Example</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BCB743/CA.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">9a: Correspondence Analysis</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BCB743/DCA.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">9b: Detrended Correspondence Analysis</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BCB743/PCoA.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">10: Principal Coordinates Analysis</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BCB743/nMDS.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">11a: Non-metric Multidimensional Scaling</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BCB743/nMDS_diatoms.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">11b: nMDS: PERMANOVA (Diatoms) Example</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BCB743/unconstrained-summary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">12: Unconstrained Ordination Summary</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BCB743/constrained_ordination.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">13a: Distance-Based Redundancy Analysis</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BCB743/two_oceans_appendices.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">13b: db-RDA: Seaweeds Example</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BCB743/cluster_analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">14: Cluster Analysis</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BCB743/model_building.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">15: Model Building</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BCB743/deep_dive.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">16a: Deep Dive Into Gradients</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../BCB743/multiple_regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">16b: Multiple Regression</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item">
 <span class="menu-text">☘☘☘︎</span>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/Combined Faculty AI Policy 15082025.pdf" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Faculty of Natural Sciences AI Policy</span></a>
  </div>
</li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item">
 <span class="menu-text">☘☘☘︎</span>
  </li>
        <li class="sidebar-item">
 <span class="menu-text">SUPPORT</span>
  </li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false">
 <span class="menu-text">Web Resources</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../resources/general_resources_web.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">R Resources</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../resources/ecology_resources_web.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Quantitative Ecology Resources</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../resources/spatial_resources_web.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Spatial R Resources</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item">
 <span class="menu-text">☘☘☘︎</span>
  </li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">On this page</h2>
   
  <ul>
<li><a href="#at-a-glance" id="toc-at-a-glance" class="nav-link active" data-scroll-target="#at-a-glance">At a glance</a></li>
  <li><a href="#introduction-to-correlation" id="toc-introduction-to-correlation" class="nav-link" data-scroll-target="#introduction-to-correlation">Introduction to correlation</a></li>
  <li><a href="#pearson-correlation" id="toc-pearson-correlation" class="nav-link" data-scroll-target="#pearson-correlation">Pearson correlation</a></li>
  <li><a href="#spearman-rank-correlation" id="toc-spearman-rank-correlation" class="nav-link" data-scroll-target="#spearman-rank-correlation">Spearman rank correlation</a></li>
  <li><a href="#kendall-rank-correlation" id="toc-kendall-rank-correlation" class="nav-link" data-scroll-target="#kendall-rank-correlation">Kendall rank correlation</a></li>
  </ul><div class="toc-actions"><ul><li><a href="https://github.com/ajsmit/tangled_bank/edit/main/BCB744/basic_stats/10-correlations.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/ajsmit/tangled_bank/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div><div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="10-correlations.pdf"><i class="bi bi-file-pdf"></i>Typst</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../BCB744/BCB744_index.html">BCB744: Introduction to R, &amp; Biostatistics</a></li><li class="breadcrumb-item"><a href="../../BCB744/basic_stats/10-correlations.html">10. Correlations</a></li></ol></nav><div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">10. Correlations</h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
<p class="subtitle lead">The association between continuous variables</p>
</div>


<div class="quarto-title-meta-author">
  <div class="quarto-title-meta-heading">Author</div>
  <div class="quarto-title-meta-heading">Affiliation</div>
  
    <div class="quarto-title-meta-contents">
    <p class="author"><a href="https://tangledbank.netlify.app">Smit, A. J.</a> <a href="https://orcid.org/0000-0002-3799-6126" class="quarto-title-author-orcid"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg=="></a></p>
  </div>
  <div class="quarto-title-meta-contents">
        <p class="affiliation">
            <a href="https://uwc.ac.za">
            University of the Western Cape
            </a>
          </p>
      </div>
  </div>

<div class="quarto-title-meta">

      
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">January 1, 2021</p>
    </div>
  </div>
  
    
  </div>
  


</header><div class="callout callout-style-simple callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
In this Chapter
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>Correlations</li>
<li>Pearson’s product moment correlation</li>
<li>Paired correlations</li>
<li>Spearman rank correlation</li>
<li>Kendal rank correlation</li>
</ul>
</div>
</div>
<div class="callout callout-style-simple callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Cheatsheet
</div>
</div>
<div class="callout-body-container callout-body">
<p>Find here a <a href="../../docs/Methods_cheatsheet_v1.pdf">Cheatsheet</a> on statistical methods.</p>
</div>
</div>
<div class="callout callout-style-simple callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Slides with additional information about correlations
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><a href="../../slides/BCB744_Correlations_slides--1-.html">Slide deck 1</a></li>
<li><a href="../../slides/BCB744_Correlations_slides--2-.html">Slide deck 2</a></li>
</ul>
</div>
</div>
<div class="callout callout-style-simple callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tasks to complete in this Chapter
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>Task Η</li>
</ul>
</div>
</div>
<section id="at-a-glance" class="level2"><h2 class="anchored" data-anchor-id="at-a-glance">At a glance</h2>
<p>Correlation analysis is used to quantify the <em>strength and direction of the linear relationship between two continuous variables</em>. The expectations about the data needed for a correlation analysis are:</p>
<ul>
<li><p><strong>Continuous variables</strong> Both variables should be measured on a continuous scale (e.g., height, depth, income). Note that we <em>do not have dependent and independent variables</em> as no dependency of one variable upon the other is implied.</p></li>
<li><p><strong>Bivariate relationship</strong> Correlation analysis is used to assess the relationship between two variables at a time. If you are interested in the relationship between multiple variables, you may need to consider pairwise correlations, or other multivariate techniques such as multiple regression or canonical correlation.</p></li>
<li><p><strong>Linear relationship</strong> The relationship between the two variables should be linear. This can be visually assessed using scatter plots. If the relationship is not linear, you may need to consider non-linear correlation measures, such as Spearman’s <span class="math inline">\(\rho\)</span> correlation or Kendall’s <span class="math inline">\(\tau\)</span>.</p></li>
<li><p><strong>No outliers</strong> Outliers can have a strong influence on the correlation coefficient, potentially leading to misleading conclusions. It’s important to visually inspect the data using scatter plots and address any outliers before performing correlation analysis.</p></li>
<li><p><strong>Normality</strong> While not strictly required for correlation analysis, the assumption of bivariate normality can be important when making inferences about the population correlation coefficient. If the variables are not normally distributed or have a non-linear relationship, consider using non-parametric correlation measures like Spearman’s <span class="math inline">\(\rho\)</span> correlation or Kendall’s <span class="math inline">\(\tau\)</span>.</p></li>
<li><p><strong>Independence of observations</strong> The observations should be independent of each other. In the case of time series data or clustered data, this assumption may be violated, requiring specific techniques to account for the dependence (e.g., autocorrelation, cross-correlation).</p></li>
<li><p><strong>Random sampling</strong> The data should be obtained through random sampling, ensuring that each observation has an equal chance of being included in the sample.</p></li>
</ul>
<p>Keep in mind that correlation does not imply causation; it only describes the association between variables without establishing a cause-and-effect relationship. When the intention is to model causation you’ll need to apply a regression.</p>
</section><section id="introduction-to-correlation" class="level2"><h2 class="anchored" data-anchor-id="introduction-to-correlation">Introduction to correlation</h2>
<p>A correlation is performed when we want to investigate the potential <em>association</em> between two continuous quantitative variables, or between some ordinal variables. We assume that the association is linear, like in a linear regression, and that one variable increases or decreases by a constant amount for a corresponding unit increase or decrease in the other variable. This does not suggest that one variable explains the other—that is the purpose of regression, as seen in <a href="../../BCB744/basic_stats/09-regressions.html">Chapter 9</a>. Like all statistical tests, correlation requires a series of assumptions:</p>
<ul>
<li>pair-wise data</li>
<li>absence of outliers</li>
<li>linearity</li>
<li>normality of distribution</li>
<li>homoscedasticity</li>
<li>level (type) of measurement</li>
<li>continuous data (Pearson <span class="math inline">\(r\)</span>)</li>
<li>non-parametric correlations (Spearman’s <span class="math inline">\(\rho\)</span> and Kendall’s <span class="math inline">\(\tau\)</span>)</li>
</ul></section><section id="pearson-correlation" class="level2 page-columns page-full"><h2 class="anchored" data-anchor-id="pearson-correlation">Pearson correlation</h2>

<div class="no-row-height column-margin column-container"><div class="">
<p><strong>Pearson’s <span class="math inline">\(r\)</span>:</strong></p>
<p><span id="eq-pearson"><span class="math display">\[r_{xy} = \frac{\sum_{i=1}^{n}(x_i - \bar{x})(y_i - \bar{y})}{\sqrt{\sum_{i=1}^{n}(x_i - \bar{x})^2}\sqrt{\sum_{i=1}^{n}(y_i - \bar{y})^2}} \tag{1}\]</span></span></p>
<p>where <span class="math inline">\(r_{xy}\)</span> is the Pearson correlation coefficient, <span class="math inline">\(x_i\)</span> and <span class="math inline">\(y_i\)</span> are the observed values of the two variables for each observation <span class="math inline">\(i\)</span>, <span class="math inline">\(\bar{x}\)</span> and <span class="math inline">\(\bar{y}\)</span> are the sample means of the two variables, and <span class="math inline">\(n\)</span> is the sample size.</p>
</div></div><p>Pearson’s <span class="math inline">\(r\)</span> is a measure of the linear relationship between two variables. It assumes that the relationship between the variables is linear, and is calculated as the ratio of the covariance between the variables to the product of their standard deviations (<a href="#eq-pearson" class="quarto-xref">Equation&nbsp;1</a>).</p>
<p>The degree of association is measured by a correlation coefficient, denoted by <span class="math inline">\(r\)</span> (note, in a regression we use the <span class="math inline">\(r^{2}\)</span>, or <span class="math inline">\(R^{2}\)</span>). The <span class="math inline">\(r\)</span> statistic is a measure of linear association. The value for <span class="math inline">\(r\)</span> varies from -1 to 1, with 0 indicating that there is absolutely no association, 1 showing a perfect positive association, and -1 a perfect inverse correlation.</p>
<p>In order to investigate correlations in biological data lets load the <code>ecklonia</code> dataset.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="co"># Load libraries</span></span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="fu">library</span>(corrplot)</span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb1-6"><a href="#cb1-6"></a></span>
<span id="cb1-7"><a href="#cb1-7"></a><span class="co"># Load data</span></span>
<span id="cb1-8"><a href="#cb1-8"></a>ecklonia <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"../../data/ecklonia.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We will also create a subsetted version of our data by removing all of the categorical variables. If we have a dataframe where each column represents pair-wise continuous/ordinal measurements with all of the other columns we may very quickly and easily perform a much wider range of correlation analyses.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a>ecklonia_sub <span class="ot">&lt;-</span> ecklonia <span class="sc">%&gt;%</span></span>
<span id="cb2-2"><a href="#cb2-2"></a>  <span class="fu">select</span>(<span class="sc">-</span>species, <span class="sc">-</span> site, <span class="sc">-</span> ID)</span>
<span id="cb2-3"><a href="#cb2-3"></a></span>
<span id="cb2-4"><a href="#cb2-4"></a><span class="co"># order the columns alphabetically</span></span>
<span id="cb2-5"><a href="#cb2-5"></a>ecklonia_sub <span class="ot">&lt;-</span> ecklonia_sub[,<span class="fu">order</span>(<span class="fu">colnames</span>(ecklonia_sub))]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>When the values we are comparing are continuous, we may use a Pearson test. This is the default and so requires little work on our end. The resulting statistic from this test is known as the Pearson correlation coefficient:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="co"># Perform correlation analysis on two specific variables</span></span>
<span id="cb3-2"><a href="#cb3-2"></a><span class="co"># Note that we do not need the final two arguments in this function to be stated</span></span>
<span id="cb3-3"><a href="#cb3-3"></a><span class="co"># as they are the defaut settings.</span></span>
<span id="cb3-4"><a href="#cb3-4"></a><span class="co"># They are only shown here to illustrate that they exist.</span></span>
<span id="cb3-5"><a href="#cb3-5"></a><span class="fu">cor.test</span>(<span class="at">x =</span> ecklonia<span class="sc">$</span>stipe_length, ecklonia<span class="sc">$</span>frond_length,</span>
<span id="cb3-6"><a href="#cb3-6"></a>         <span class="at">use =</span> <span class="st">"everything"</span>, <span class="at">method =</span> <span class="st">"pearson"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's product-moment correlation

data:  ecklonia$stipe_length and ecklonia$frond_length
t = 4.2182, df = 24, p-value = 0.0003032
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 0.3548169 0.8300525
sample estimates:
      cor 
0.6524911 </code></pre>
</div>
</div>
<p>Above we have tested the correlation between the length of <em>Ecklonia maxima</em> stipes and the length of their fronds. A perfect positive (negative) relationship would produce a value of 1 (-1), whereas no relationship would produce a value of 0. The result above, <code>cor = 0.65</code> is relatively strong.</p>
<p>As is the case with everything else we have learned thus far, a good visualisation can go a long way to help us understand what the statistics are doing. Below we visualise the stipe length to frond length relationship.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="co"># Calculate Pearson r beforehand for plotting</span></span>
<span id="cb5-2"><a href="#cb5-2"></a>r_print <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"r = "</span>,</span>
<span id="cb5-3"><a href="#cb5-3"></a>                  <span class="fu">round</span>(<span class="fu">cor</span>(<span class="at">x =</span> ecklonia<span class="sc">$</span>stipe_length, ecklonia<span class="sc">$</span>frond_length),<span class="dv">2</span>))</span>
<span id="cb5-4"><a href="#cb5-4"></a></span>
<span id="cb5-5"><a href="#cb5-5"></a><span class="co"># Then create a single panel showing one correlation</span></span>
<span id="cb5-6"><a href="#cb5-6"></a><span class="fu">ggplot</span>(<span class="at">data =</span> ecklonia, <span class="fu">aes</span>(<span class="at">x =</span> stipe_length, <span class="at">y =</span> frond_length)) <span class="sc">+</span></span>
<span id="cb5-7"><a href="#cb5-7"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">colour =</span> <span class="st">"blue3"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">size =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb5-8"><a href="#cb5-8"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">col =</span> <span class="st">"red3"</span>, <span class="at">shape =</span> <span class="dv">16</span>) <span class="sc">+</span></span>
<span id="cb5-9"><a href="#cb5-9"></a>  <span class="fu">geom_label</span>(<span class="at">x =</span> <span class="dv">300</span>, <span class="at">y =</span> <span class="dv">240</span>, <span class="at">label =</span> r_print) <span class="sc">+</span></span>
<span id="cb5-10"><a href="#cb5-10"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Stipe length (cm)"</span>, <span class="at">y =</span> <span class="st">"Frond length (cm)"</span>) <span class="sc">+</span></span>
<span id="cb5-11"><a href="#cb5-11"></a>  <span class="fu">theme_pubclean</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-corr1" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-corr1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="10-correlations_files/figure-html/fig-corr1-1.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-1" title="Figure&nbsp;1: Scatterplot showing relationship between Ecklonia maxima stipe length (cm) and frond length (cm). The correlation coefficient (Pearson r) is shown in the top left corner. Note that the best fit blue line was produced by a linear model and that it is not responsible for generating the correlation coefficient; rather it is included to help visually demonstrate the strength of the relationship."><img src="10-correlations_files/figure-html/fig-corr1-1.svg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-corr1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Scatterplot showing relationship between <em>Ecklonia maxima</em> stipe length (cm) and frond length (cm). The correlation coefficient (Pearson <em>r</em>) is shown in the top left corner. Note that the best fit blue line was produced by a linear model and that it is not responsible for generating the correlation coefficient; rather it is included to help visually demonstrate the strength of the relationship.
</figcaption></figure>
</div>
</div>
</div>
<p>Just by eye-balling this scatterplot it should be clear that these data tend to increase at a roughly similar rate. Our Pearson r value is an indication of what that is.</p>
<p>Should our dataset contain multiple variables, as <code>ecklonia</code> does, we may investigate all of the correlations simultaneously. Remember that in order to do so we want to ensure that we may perform the same test on each of our paired variables. In this case we will use <code>ecklonia_sub</code> as we know that it contains only continuous data and so are appropriate for use with a Pearson test. By default R will use all of the data we give it and perform a Pearson test so we do not need to specify any further arguments. Note however that this will only output the correlation coefficients, and does not produce a full test of each correlation. This will however be useful for us to have just now.</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a>ecklonia_pearson <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">cor</span>(ecklonia_sub), <span class="dv">2</span>)</span>
<span id="cb6-2"><a href="#cb6-2"></a>ecklonia_pearson <span class="sc">|&gt;</span> </span>
<span id="cb6-3"><a href="#cb6-3"></a>  <span class="fu">kbl</span>(<span class="at">caption =</span> <span class="st">"A pairwise matrix of the *Ecklonia* dataset."</span>) <span class="sc">%&gt;%</span></span>
<span id="cb6-4"><a href="#cb6-4"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display column-page page-columns page-full">
<table class="lightable-classic table table-sm table-striped small" data-quarto-postprocess="true">

<thead><tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">digits</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">epiphyte_length</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">frond_length</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">frond_mass</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">primary_blade_length</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">primary_blade_width</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">stipe_diameter</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">stipe_length</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">stipe_mass</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">digits</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">0.05</td>
<td style="text-align: right;">0.36</td>
<td style="text-align: right;">0.28</td>
<td style="text-align: right;">0.10</td>
<td style="text-align: right;">0.14</td>
<td style="text-align: right;">0.24</td>
<td style="text-align: right;">0.24</td>
<td style="text-align: right;">0.07</td>
</tr>
<tr class="even">
<td style="text-align: left;">epiphyte_length</td>
<td style="text-align: right;">0.05</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">0.61</td>
<td style="text-align: right;">0.44</td>
<td style="text-align: right;">0.26</td>
<td style="text-align: right;">0.41</td>
<td style="text-align: right;">0.54</td>
<td style="text-align: right;">0.61</td>
<td style="text-align: right;">0.51</td>
</tr>
<tr class="odd">
<td style="text-align: left;">frond_length</td>
<td style="text-align: right;">0.36</td>
<td style="text-align: right;">0.61</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">0.57</td>
<td style="text-align: right;">-0.02</td>
<td style="text-align: right;">0.28</td>
<td style="text-align: right;">0.39</td>
<td style="text-align: right;">0.65</td>
<td style="text-align: right;">0.39</td>
</tr>
<tr class="even">
<td style="text-align: left;">frond_mass</td>
<td style="text-align: right;">0.28</td>
<td style="text-align: right;">0.44</td>
<td style="text-align: right;">0.57</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">0.15</td>
<td style="text-align: right;">0.36</td>
<td style="text-align: right;">0.51</td>
<td style="text-align: right;">0.51</td>
<td style="text-align: right;">0.47</td>
</tr>
<tr class="odd">
<td style="text-align: left;">primary_blade_length</td>
<td style="text-align: right;">0.10</td>
<td style="text-align: right;">0.26</td>
<td style="text-align: right;">-0.02</td>
<td style="text-align: right;">0.15</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">0.34</td>
<td style="text-align: right;">0.32</td>
<td style="text-align: right;">0.13</td>
<td style="text-align: right;">0.16</td>
</tr>
<tr class="even">
<td style="text-align: left;">primary_blade_width</td>
<td style="text-align: right;">0.14</td>
<td style="text-align: right;">0.41</td>
<td style="text-align: right;">0.28</td>
<td style="text-align: right;">0.36</td>
<td style="text-align: right;">0.34</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">0.83</td>
<td style="text-align: right;">0.34</td>
<td style="text-align: right;">0.83</td>
</tr>
<tr class="odd">
<td style="text-align: left;">stipe_diameter</td>
<td style="text-align: right;">0.24</td>
<td style="text-align: right;">0.54</td>
<td style="text-align: right;">0.39</td>
<td style="text-align: right;">0.51</td>
<td style="text-align: right;">0.32</td>
<td style="text-align: right;">0.83</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">0.59</td>
<td style="text-align: right;">0.82</td>
</tr>
<tr class="even">
<td style="text-align: left;">stipe_length</td>
<td style="text-align: right;">0.24</td>
<td style="text-align: right;">0.61</td>
<td style="text-align: right;">0.65</td>
<td style="text-align: right;">0.51</td>
<td style="text-align: right;">0.13</td>
<td style="text-align: right;">0.34</td>
<td style="text-align: right;">0.59</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">0.58</td>
</tr>
<tr class="odd">
<td style="text-align: left;">stipe_mass</td>
<td style="text-align: right;">0.07</td>
<td style="text-align: right;">0.51</td>
<td style="text-align: right;">0.39</td>
<td style="text-align: right;">0.47</td>
<td style="text-align: right;">0.16</td>
<td style="text-align: right;">0.83</td>
<td style="text-align: right;">0.82</td>
<td style="text-align: right;">0.58</td>
<td style="text-align: right;">1.00</td>
</tr>
</tbody>
</table>
<div class="quarto-table-caption margin-caption">A pairwise matrix of the *Ecklonia* dataset.</div></div>
</div>
<p>How would we visualise this matrix of correlations? It is relatively straightforward to quickly plot correlation results for all of our variables in one go. In order to show which variables associate most with which other variables all at once, without creating chaos, we will create what is known as a pairwise correlation plot. This visualisation uses a range of colours, usually blue to red, to demonstrate where more of something is. In this case, we use it to show where more correlation is occurring between morphometric properties of the kelp <em>Ecklonia maxima</em>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="co"># extract the lower triangle and plot</span></span>
<span id="cb7-2"><a href="#cb7-2"></a>ecklonia_pearson[<span class="fu">upper.tri</span>(ecklonia_pearson)] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb7-3"><a href="#cb7-3"></a><span class="fu">corrplot</span>(ecklonia_pearson, <span class="at">method =</span> <span class="st">"circle"</span>, <span class="at">na.label.col =</span> <span class="st">"white"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-corr2" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-corr2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="10-correlations_files/figure-html/fig-corr2-1.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-2" title="Figure&nbsp;2: Plot of pairwise correlations showing the strength of all correlations between all variables as a scale from red (negative) to blue (positive)."><img src="10-correlations_files/figure-html/fig-corr2-1.svg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-corr2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: Plot of pairwise correlations showing the strength of all correlations between all variables as a scale from red (negative) to blue (positive).
</figcaption></figure>
</div>
</div>
</div>
<p>Let’s do it is <strong>ggplot2</strong> (<a href="#fig-corr3" class="quarto-xref">Figure&nbsp;3</a>). Here I use the <code>geom_tile()</code> function. However, before I can use the data in <strong>ggplot2</strong>, I need to create a long dataframe from the correlation matrix, and I can do this with the <code>pivot_longer()</code> function. There are several other methods for plotting pairwise correlations available—please feel free to scratch around the internet for options you like. This graph is called a heatmap, which is not dissimilar to the heatmaps and Hovmöller diagrams created in <a href="../../BCB744/basic_stats/03-visualise.html#sec-heatmaps">Chapter 2</a>.</p>
<p>Pairwise correlations are useful for identifying patterns and relationships between variables that may be hidden in the overall correlation structure of the dataset. This is particularly useful in a large dataset with many variables, where this type of analysis—especially when coupled with a suitable visualisation—can help identify subsets of variables that are strongly related to each other, which can then point the path to further analysis or modelling.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a>ecklonia_pearson <span class="sc">|&gt;</span> </span>
<span id="cb8-2"><a href="#cb8-2"></a>  <span class="fu">as.data.frame</span>() <span class="sc">|&gt;</span> </span>
<span id="cb8-3"><a href="#cb8-3"></a>  <span class="fu">mutate</span>(<span class="at">x =</span> <span class="fu">rownames</span>(ecklonia_pearson)) <span class="sc">|&gt;</span> </span>
<span id="cb8-4"><a href="#cb8-4"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> stipe_length<span class="sc">:</span>epiphyte_length,</span>
<span id="cb8-5"><a href="#cb8-5"></a>               <span class="at">names_to =</span> <span class="st">"y"</span>,</span>
<span id="cb8-6"><a href="#cb8-6"></a>               <span class="at">values_to =</span> <span class="st">"r"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb8-7"><a href="#cb8-7"></a>  <span class="fu">filter</span>(x <span class="sc">!=</span> <span class="st">"digits"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb8-8"><a href="#cb8-8"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(x, y, <span class="at">fill =</span> r)) <span class="sc">+</span></span>
<span id="cb8-9"><a href="#cb8-9"></a>    <span class="fu">geom_tile</span>(<span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb8-10"><a href="#cb8-10"></a>    <span class="fu">scale_fill_gradient2</span>(<span class="at">low =</span> <span class="st">"blue"</span>, <span class="at">high =</span> <span class="st">"red"</span>, <span class="at">mid =</span> <span class="st">"white"</span>,</span>
<span id="cb8-11"><a href="#cb8-11"></a>                         <span class="at">midpoint =</span> <span class="dv">0</span>, <span class="at">limit =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>),</span>
<span id="cb8-12"><a href="#cb8-12"></a>                          <span class="at">na.value =</span> <span class="st">"grey95"</span>,, <span class="at">space =</span> <span class="st">"Lab"</span>,</span>
<span id="cb8-13"><a href="#cb8-13"></a>                         <span class="at">name =</span> <span class="st">"r"</span>) <span class="sc">+</span></span>
<span id="cb8-14"><a href="#cb8-14"></a>    <span class="fu">xlab</span>(<span class="cn">NULL</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb8-15"><a href="#cb8-15"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb8-16"><a href="#cb8-16"></a>    <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">vjust =</span> <span class="dv">1</span>,</span>
<span id="cb8-17"><a href="#cb8-17"></a>                                     <span class="at">hjust =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb8-18"><a href="#cb8-18"></a>    <span class="fu">coord_fixed</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-corr3" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-corr3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="10-correlations_files/figure-html/fig-corr3-1.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-3" title="Figure&nbsp;3: Pairwise of the Ecklonia dataset correlations created in ggplot2."><img src="10-correlations_files/figure-html/fig-corr3-1.svg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-corr3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3: Pairwise of the <em>Ecklonia</em> dataset correlations created in <strong>ggplot2</strong>.
</figcaption></figure>
</div>
</div>
</div>
</section><section id="spearman-rank-correlation" class="level2 page-columns page-full"><h2 class="anchored" data-anchor-id="spearman-rank-correlation">Spearman rank correlation</h2>
<p>Spearman correlation is used to measure the strength and direction of the relationship between two variables, based on their rank order. Unlike Pearson correlation, which assumes that the relationship between two variables is linear, Spearman correlation can be used to measure the strength of any monotonic relationship, whether it is linear or not. Additionally, this correlation is useful even when the data are not normally distributed, or contain outliers.</p>
<p>To calculate the Spearman correlation coefficient, <span class="math inline">\(\rho\)</span>, the values of both variables are first ranked from lowest to highest and each value is assigned a numerical rank based on its position in the ordered list. Then, the difference between the ranks of the two variables is calculated for each observation, and the squared differences are summed across all observations. The Spearman correlation coefficient is then calculated as the ratio of the sum of the squared differences to the total number of observations, adjusted for ties (<a href="#eq-spearman" class="quarto-xref">Equation&nbsp;2</a>). Like the Pearson correlation coefficient, <span class="math inline">\(\rho\)</span> can also range from -1 to +1.</p>

<div class="no-row-height column-margin column-container"><div class="">
<p><strong>Spearman’s <span class="math inline">\(\rho\)</span>:</strong> <span id="eq-spearman"><span class="math display">\[\rho = 1 - \frac{6 \sum_{i=1}^n d_i^2}{n(n^2-1)} \tag{2}\]</span></span></p>
<p>where <span class="math inline">\(\rho\)</span> is the Spearman correlation, <span class="math inline">\(d_i\)</span> is the difference between the ranks of the two variables for the <span class="math inline">\(i^{th}\)</span> observation, and <span class="math inline">\(n\)</span> is the sample size. The factor of 6 in the equation is a normalisation constant that adjusts the range of possible values of the correlation coefficient to be between -1 and +1.</p>
</div></div><p>In the code below we will add a column of ordinal data to our <code>ecklonia</code> data to so that we may look at this test.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="co"># Create ordinal data</span></span>
<span id="cb9-2"><a href="#cb9-2"></a>ecklonia<span class="sc">$</span>length <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">cut</span>((ecklonia<span class="sc">$</span>stipe_length <span class="sc">+</span> ecklonia<span class="sc">$</span>frond_length), <span class="at">breaks =</span> <span class="dv">3</span>))</span>
<span id="cb9-3"><a href="#cb9-3"></a></span>
<span id="cb9-4"><a href="#cb9-4"></a><span class="co"># What does this new column look like?</span></span>
<span id="cb9-5"><a href="#cb9-5"></a><span class="fu">head</span>(<span class="fu">select</span>(ecklonia, <span class="fu">c</span>(species, site, stipe_length, frond_length, length)), <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   species           site stipe_length frond_length length
1   maxima Boulders Beach          456          116      1
2   maxima Boulders Beach          477          141      2
3   maxima Boulders Beach          427          144      1
4   maxima Boulders Beach          347          127      1
5   maxima Boulders Beach          470          160      2
6   maxima Boulders Beach          478          181      2
7   maxima Boulders Beach          472          174      2
8   maxima Boulders Beach          459           95      1
9   maxima Boulders Beach          397           87      1
10  maxima Boulders Beach          541          127      2</code></pre>
</div>
</div>
<p>Now let us correlate the new <code>length</code> variable with any one of the other variables:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="fu">cor.test</span>(ecklonia<span class="sc">$</span>length, ecklonia<span class="sc">$</span>digits, <span class="at">method =</span> <span class="st">"spearman"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Spearman's rank correlation rho

data:  ecklonia$length and ecklonia$digits
S = 1930, p-value = 0.08906
alternative hypothesis: true rho is not equal to 0
sample estimates:
      rho 
0.3401765 </code></pre>
</div>
</div>
</section><section id="kendall-rank-correlation" class="level2 page-columns page-full"><h2 class="anchored" data-anchor-id="kendall-rank-correlation">Kendall rank correlation</h2>
<p>Kendall’s correlation, also known as Kendall’s <span class="math inline">\(\tau\)</span>, is a non-parametric correlation method for assessing the strength and direction of the relationship between two variables. It is similar to Spearman’s rank correlation, but it is calculated differently.</p>
<p>Kendall’s <span class="math inline">\(\tau\)</span> is calculated based on the number of concordant and discordant pairs of observations between the two variables being correlated. A concordant pair is one in which the values of both variables have the same order, meaning that if the value of one variable is higher than the other for one observation, it is also higher for the other observation. A discordant pair is one in which the values of the two variables have different order, meaning that if one variable is higher than the other for one observation, it is lower for the other observation.</p>
<p><span class="math inline">\(\tau\)</span> is calculated as the difference between the number of concordant and discordant pairs of observations, divided by the total number of possible pairs (<a href="#eq-kendall" class="quarto-xref">Equation&nbsp;3</a>). As in Pearson’s and Spearman’s correlations, the result also ranges from -1 and +1.</p>

<div class="no-row-height column-margin column-container"><div class="">
<p><strong>Kendal’s <span class="math inline">\(\tau\)</span>:</strong> <span id="eq-kendall"><span class="math display">\[\tau = \frac{n_c - n_d}{\binom{n}{2}} \tag{3}\]</span></span></p>
<p>where <span class="math inline">\(\tau\)</span> is Kendall’s <span class="math inline">\(\tau\)</span> correlation coefficient, <span class="math inline">\(n\)</span> is the sample size, <span class="math inline">\(n_c\)</span> is the number of concordant pairs of observations, <span class="math inline">\(n_d\)</span> is the number of discordant pairs of observations, and <span class="math inline">\(\binom{n}{2}\)</span> is the number of possible pairs of observations in the sample.</p>
</div></div><p>Kendall’s <span class="math inline">\(\tau\)</span> is a useful correlation statistic for non-parametric data, such as ordinal or categorical data, and is robust to outliers and non-normal distributions.</p>
<p>Let’s look at the normality of our <code>ecklonia</code> variables and pull out those that are not normal in order to see how the results of this test may differ from our Pearson tests.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a>ecklonia_norm <span class="ot">&lt;-</span> ecklonia_sub <span class="sc">%&gt;%</span></span>
<span id="cb13-2"><a href="#cb13-2"></a>  <span class="fu">gather</span>(<span class="at">key =</span> <span class="st">"variable"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb13-3"><a href="#cb13-3"></a>  <span class="fu">group_by</span>(variable) <span class="sc">%&gt;%</span></span>
<span id="cb13-4"><a href="#cb13-4"></a>  <span class="fu">summarise</span>(<span class="at">variable_norm =</span> <span class="fu">as.numeric</span>(<span class="fu">shapiro.test</span>(value)[<span class="dv">2</span>]))</span>
<span id="cb13-5"><a href="#cb13-5"></a>ecklonia_norm</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 9 × 2
  variable             variable_norm
  &lt;chr&gt;                        &lt;dbl&gt;
1 digits                     0.0671 
2 epiphyte_length            0.626  
3 frond_length               0.202  
4 frond_mass                 0.277  
5 primary_blade_length       0.00393
6 primary_blade_width        0.314  
7 stipe_diameter             0.170  
8 stipe_length               0.213  
9 stipe_mass                 0.817  </code></pre>
</div>
</div>
<p>From this analysis we may see that the values for primary blade length are not normally distributed. In order to make up for this violation of our assumption of normality we may use the Kendall test.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a><span class="fu">cor.test</span>(ecklonia<span class="sc">$</span>primary_blade_length, ecklonia<span class="sc">$</span>primary_blade_width, <span class="at">method =</span> <span class="st">"kendall"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Kendall's rank correlation tau

data:  ecklonia$primary_blade_length and ecklonia$primary_blade_width
z = 2.3601, p-value = 0.01827
alternative hypothesis: true tau is not equal to 0
sample estimates:
      tau 
0.3426171 </code></pre>
</div>
</div>
<p>Here the correlation coefficient is called Kendall’s <span class="math inline">\(\tau\)</span> but it is interpreted as we would Pearson’s.</p>


<!-- -->

</section><div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-reuse"><h2 class="anchored quarto-appendix-heading">Reuse</h2><div class="quarto-appendix-contents"><div><a rel="license" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a></div></div></section><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{smit,_a._j.2021,
  author = {Smit, A. J.,},
  title = {10. {Correlations}},
  date = {2021-01-01},
  url = {http://tangledbank.netlify.app/BCB744/basic_stats/10-correlations.html},
  langid = {en}
}
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-smit,_a._j.2021" class="csl-entry quarto-appendix-citeas" role="listitem">
Smit, A. J. (2021) 10. Correlations. <a href="http://tangledbank.netlify.app/BCB744/basic_stats/10-correlations.html">http://tangledbank.netlify.app/BCB744/basic_stats/10-correlations.html.
</a>
</div></div></section></div></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
    const viewSource = window.document.getElementById('quarto-view-source') ||
                       window.document.getElementById('quarto-code-tools-source');
    if (viewSource) {
      const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
      viewSource.addEventListener("click", function(e) {
        if (sourceUrl) {
          // rstudio viewer pane
          if (/\bcapabilities=\b/.test(window.location)) {
            window.open(sourceUrl);
          } else {
            window.location.href = sourceUrl;
          }
        } else {
          const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
          modal.show();
        }
        return false;
      });
    }
    function toggleCodeHandler(show) {
      return function(e) {
        const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
        for (let i=0; i<detailsSrc.length; i++) {
          const details = detailsSrc[i].parentElement;
          if (show) {
            details.open = true;
          } else {
            details.removeAttribute("open");
          }
        }
        const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
        const fromCls = show ? "hidden" : "unhidden";
        const toCls = show ? "unhidden" : "hidden";
        for (let i=0; i<cellCodeDivs.length; i++) {
          const codeDiv = cellCodeDivs[i];
          if (codeDiv.classList.contains(fromCls)) {
            codeDiv.classList.remove(fromCls);
            codeDiv.classList.add(toCls);
          } 
        }
        return false;
      }
    }
    const hideAllCode = window.document.getElementById("quarto-hide-all-code");
    if (hideAllCode) {
      hideAllCode.addEventListener("click", toggleCodeHandler(false));
    }
    const showAllCode = window.document.getElementById("quarto-show-all-code");
    if (showAllCode) {
      showAllCode.addEventListener("click", toggleCodeHandler(true));
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("http:\/\/tangledbank\.netlify\.app");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
            // target, if specified
            link.setAttribute("target", "_blank");
            if (link.getAttribute("rel") === null) {
              link.setAttribute("rel", "noopener");
            }
            // default icon
            link.classList.add("external");
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="../../BCB744/basic_stats/09-regressions.html" class="pagination-link" aria-label="9. Simple Linear Regressions">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">9. Simple Linear Regressions</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../../BCB744/basic_stats/11-decision_guide.html" class="pagination-link" aria-label="11. Parametric Tests">
        <span class="nav-page-text">11. Parametric Tests</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb17" data-shortcodes="false"><pre class="sourceCode numberSource markdown number-lines code-with-copy"><code class="sourceCode markdown"><span id="cb17-1"><a href="#cb17-1"></a><span class="co">---</span></span>
<span id="cb17-2"><a href="#cb17-2"></a><span class="an">date:</span><span class="co"> "2021-01-01"</span></span>
<span id="cb17-3"><a href="#cb17-3"></a><span class="an">title:</span><span class="co"> "10. Correlations"</span></span>
<span id="cb17-4"><a href="#cb17-4"></a><span class="an">subtitle:</span><span class="co"> "The association between continuous variables"</span></span>
<span id="cb17-5"><a href="#cb17-5"></a><span class="an">reference-location:</span><span class="co"> margin</span></span>
<span id="cb17-6"><a href="#cb17-6"></a><span class="co">---</span></span>
<span id="cb17-7"><a href="#cb17-7"></a></span>
<span id="cb17-8"><a href="#cb17-8"></a><span class="in">```{r, echo=FALSE}</span></span>
<span id="cb17-9"><a href="#cb17-9"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(</span>
<span id="cb17-10"><a href="#cb17-10"></a>  <span class="at">echo =</span> <span class="cn">TRUE</span>,</span>
<span id="cb17-11"><a href="#cb17-11"></a>  <span class="at">eval =</span> <span class="cn">TRUE</span>,</span>
<span id="cb17-12"><a href="#cb17-12"></a>  <span class="at">warning =</span> <span class="cn">FALSE</span>,</span>
<span id="cb17-13"><a href="#cb17-13"></a>  <span class="at">message =</span> <span class="cn">FALSE</span>,</span>
<span id="cb17-14"><a href="#cb17-14"></a>  <span class="at">fig.width =</span> <span class="dv">6</span>,</span>
<span id="cb17-15"><a href="#cb17-15"></a>  <span class="at">fig.asp =</span> <span class="fl">0.65</span>,</span>
<span id="cb17-16"><a href="#cb17-16"></a>  <span class="at">out.width =</span> <span class="st">"100%"</span>,</span>
<span id="cb17-17"><a href="#cb17-17"></a>  <span class="at">fig.align =</span> <span class="st">"center"</span></span>
<span id="cb17-18"><a href="#cb17-18"></a>)</span>
<span id="cb17-19"><a href="#cb17-19"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb17-20"><a href="#cb17-20"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb17-21"><a href="#cb17-21"></a><span class="fu">library</span>(ggthemes)</span>
<span id="cb17-22"><a href="#cb17-22"></a><span class="fu">library</span>(gt)</span>
<span id="cb17-23"><a href="#cb17-23"></a><span class="in">```</span></span>
<span id="cb17-24"><a href="#cb17-24"></a></span>
<span id="cb17-25"><a href="#cb17-25"></a>::: {.callout-note appearance="simple"}</span>
<span id="cb17-26"><a href="#cb17-26"></a><span class="fu">## In this Chapter</span></span>
<span id="cb17-27"><a href="#cb17-27"></a></span>
<span id="cb17-28"><a href="#cb17-28"></a><span class="ss">-   </span>Correlations</span>
<span id="cb17-29"><a href="#cb17-29"></a><span class="ss">-   </span>Pearson's product moment correlation</span>
<span id="cb17-30"><a href="#cb17-30"></a><span class="ss">-   </span>Paired correlations</span>
<span id="cb17-31"><a href="#cb17-31"></a><span class="ss">-   </span>Spearman rank correlation</span>
<span id="cb17-32"><a href="#cb17-32"></a><span class="ss">-   </span>Kendal rank correlation</span>
<span id="cb17-33"><a href="#cb17-33"></a>:::</span>
<span id="cb17-34"><a href="#cb17-34"></a></span>
<span id="cb17-35"><a href="#cb17-35"></a>::: {.callout-note appearance="simple"}</span>
<span id="cb17-36"><a href="#cb17-36"></a><span class="fu">## Cheatsheet</span></span>
<span id="cb17-37"><a href="#cb17-37"></a>Find here a <span class="co">[</span><span class="ot">Cheatsheet</span><span class="co">](../../docs/Methods_cheatsheet_v1.pdf)</span> on statistical methods.</span>
<span id="cb17-38"><a href="#cb17-38"></a>:::</span>
<span id="cb17-39"><a href="#cb17-39"></a></span>
<span id="cb17-40"><a href="#cb17-40"></a>::: {.callout-note appearance="simple"}</span>
<span id="cb17-41"><a href="#cb17-41"></a><span class="fu">## Slides with additional information about correlations</span></span>
<span id="cb17-42"><a href="#cb17-42"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">Slide deck 1</span><span class="co">](../../slides/BCB744_Correlations_slides--1-.html)</span></span>
<span id="cb17-43"><a href="#cb17-43"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">Slide deck 2</span><span class="co">](../../slides/BCB744_Correlations_slides--2-.html)</span></span>
<span id="cb17-44"><a href="#cb17-44"></a>:::</span>
<span id="cb17-45"><a href="#cb17-45"></a></span>
<span id="cb17-46"><a href="#cb17-46"></a>::: {.callout-important appearance="simple"}</span>
<span id="cb17-47"><a href="#cb17-47"></a><span class="fu">## Tasks to complete in this Chapter</span></span>
<span id="cb17-48"><a href="#cb17-48"></a></span>
<span id="cb17-49"><a href="#cb17-49"></a><span class="ss">-   </span>Task Η</span>
<span id="cb17-50"><a href="#cb17-50"></a>:::</span>
<span id="cb17-51"><a href="#cb17-51"></a></span>
<span id="cb17-52"><a href="#cb17-52"></a><span class="fu">## At a glance</span></span>
<span id="cb17-53"><a href="#cb17-53"></a></span>
<span id="cb17-54"><a href="#cb17-54"></a>Correlation analysis is used to quantify the *strength and direction of the linear relationship between two continuous variables*. The expectations about the data needed for a correlation analysis are:</span>
<span id="cb17-55"><a href="#cb17-55"></a></span>
<span id="cb17-56"><a href="#cb17-56"></a><span class="ss">-   </span>**Continuous variables** Both variables should be measured on a continuous scale (e.g., height, depth, income). Note that we *do not have dependent and independent variables* as no dependency of one variable upon the other is implied.</span>
<span id="cb17-57"><a href="#cb17-57"></a></span>
<span id="cb17-58"><a href="#cb17-58"></a><span class="ss">-   </span>**Bivariate relationship** Correlation analysis is used to assess the relationship between two variables at a time. If you are interested in the relationship between multiple variables, you may need to consider pairwise correlations, or other multivariate techniques such as multiple regression or canonical correlation.</span>
<span id="cb17-59"><a href="#cb17-59"></a></span>
<span id="cb17-60"><a href="#cb17-60"></a><span class="ss">-   </span>**Linear relationship** The relationship between the two variables should be linear. This can be visually assessed using scatter plots. If the relationship is not linear, you may need to consider non-linear correlation measures, such as Spearman's $\rho$ correlation or Kendall's $\tau$.</span>
<span id="cb17-61"><a href="#cb17-61"></a></span>
<span id="cb17-62"><a href="#cb17-62"></a><span class="ss">-   </span>**No outliers** Outliers can have a strong influence on the correlation coefficient, potentially leading to misleading conclusions. It's important to visually inspect the data using scatter plots and address any outliers before performing correlation analysis.</span>
<span id="cb17-63"><a href="#cb17-63"></a></span>
<span id="cb17-64"><a href="#cb17-64"></a><span class="ss">-   </span>**Normality** While not strictly required for correlation analysis, the assumption of bivariate normality can be important when making inferences about the population correlation coefficient. If the variables are not normally distributed or have a non-linear relationship, consider using non-parametric correlation measures like Spearman's $\rho$ correlation or Kendall's $\tau$.</span>
<span id="cb17-65"><a href="#cb17-65"></a></span>
<span id="cb17-66"><a href="#cb17-66"></a><span class="ss">-   </span>**Independence of observations** The observations should be independent of each other. In the case of time series data or clustered data, this assumption may be violated, requiring specific techniques to account for the dependence (e.g., autocorrelation, cross-correlation).</span>
<span id="cb17-67"><a href="#cb17-67"></a></span>
<span id="cb17-68"><a href="#cb17-68"></a><span class="ss">-   </span>**Random sampling** The data should be obtained through random sampling, ensuring that each observation has an equal chance of being included in the sample.</span>
<span id="cb17-69"><a href="#cb17-69"></a></span>
<span id="cb17-70"><a href="#cb17-70"></a>Keep in mind that correlation does not imply causation; it only describes the association between variables without establishing a cause-and-effect relationship. When the intention is to model causation you'll need to apply a regression.</span>
<span id="cb17-71"><a href="#cb17-71"></a></span>
<span id="cb17-72"><a href="#cb17-72"></a><span class="fu">## Introduction to correlation</span></span>
<span id="cb17-73"><a href="#cb17-73"></a></span>
<span id="cb17-74"><a href="#cb17-74"></a>A correlation is performed when we want to investigate the potential *association* between two continuous quantitative variables, or between some ordinal variables. We assume that the association is linear, like in a linear regression, and that one variable increases or decreases by a constant amount for a corresponding unit increase or decrease in the other variable. This does not suggest that one variable explains the other---that is the purpose of regression, as seen in <span class="co">[</span><span class="ot">Chapter 9</span><span class="co">](09-regressions.qmd)</span>. Like all statistical tests, correlation requires a series of assumptions:</span>
<span id="cb17-75"><a href="#cb17-75"></a></span>
<span id="cb17-76"><a href="#cb17-76"></a><span class="ss">-   </span>pair-wise data</span>
<span id="cb17-77"><a href="#cb17-77"></a><span class="ss">-   </span>absence of outliers</span>
<span id="cb17-78"><a href="#cb17-78"></a><span class="ss">-   </span>linearity</span>
<span id="cb17-79"><a href="#cb17-79"></a><span class="ss">-   </span>normality of distribution</span>
<span id="cb17-80"><a href="#cb17-80"></a><span class="ss">-   </span>homoscedasticity</span>
<span id="cb17-81"><a href="#cb17-81"></a><span class="ss">-   </span>level (type) of measurement</span>
<span id="cb17-82"><a href="#cb17-82"></a><span class="ss">-   </span>continuous data (Pearson $r$)</span>
<span id="cb17-83"><a href="#cb17-83"></a><span class="ss">-   </span>non-parametric correlations (Spearman's $\rho$ and Kendall's $\tau$)</span>
<span id="cb17-84"><a href="#cb17-84"></a></span>
<span id="cb17-85"><a href="#cb17-85"></a><span class="fu">## Pearson correlation</span></span>
<span id="cb17-86"><a href="#cb17-86"></a></span>
<span id="cb17-87"><a href="#cb17-87"></a>::: {.column-margin}</span>
<span id="cb17-88"><a href="#cb17-88"></a>**Pearson's $r$:**</span>
<span id="cb17-89"><a href="#cb17-89"></a></span>
<span id="cb17-90"><a href="#cb17-90"></a>$$r_{xy} = \frac{\sum_{i=1}^{n}(x_i - \bar{x})(y_i - \bar{y})}{\sqrt{\sum_{i=1}^{n}(x_i - \bar{x})^2}\sqrt{\sum_{i=1}^{n}(y_i - \bar{y})^2}}$$ {#eq-pearson}</span>
<span id="cb17-91"><a href="#cb17-91"></a></span>
<span id="cb17-92"><a href="#cb17-92"></a>where $r_{xy}$ is the Pearson correlation coefficient, $x_i$ and $y_i$ are the observed values of the two variables for each observation $i$, $\bar{x}$ and $\bar{y}$ are the sample means of the two variables, and $n$ is the sample size.</span>
<span id="cb17-93"><a href="#cb17-93"></a>:::</span>
<span id="cb17-94"><a href="#cb17-94"></a></span>
<span id="cb17-95"><a href="#cb17-95"></a>Pearson's $r$ is a measure of the linear relationship between two variables. It assumes that the relationship between the variables is linear, and is calculated as the ratio of the covariance between the variables to the product of their standard deviations (@eq-pearson).</span>
<span id="cb17-96"><a href="#cb17-96"></a></span>
<span id="cb17-97"><a href="#cb17-97"></a>The degree of association is measured by a correlation coefficient, denoted by $r$ (note, in a regression we use the $r^{2}$, or $R^{2}$). The $r$ statistic is a measure of linear association. The value for $r$ varies from -1 to 1, with 0 indicating that there is absolutely no association, 1 showing a perfect positive association, and -1 a perfect inverse correlation.</span>
<span id="cb17-98"><a href="#cb17-98"></a></span>
<span id="cb17-99"><a href="#cb17-99"></a>In order to investigate correlations in biological data lets load the <span class="in">`ecklonia`</span> dataset.</span>
<span id="cb17-100"><a href="#cb17-100"></a></span>
<span id="cb17-101"><a href="#cb17-101"></a><span class="in">```{r message=FALSE, warning=FALSE}</span></span>
<span id="cb17-102"><a href="#cb17-102"></a><span class="co"># Load libraries</span></span>
<span id="cb17-103"><a href="#cb17-103"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb17-104"><a href="#cb17-104"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb17-105"><a href="#cb17-105"></a><span class="fu">library</span>(corrplot)</span>
<span id="cb17-106"><a href="#cb17-106"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb17-107"><a href="#cb17-107"></a></span>
<span id="cb17-108"><a href="#cb17-108"></a><span class="co"># Load data</span></span>
<span id="cb17-109"><a href="#cb17-109"></a>ecklonia <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"../../data/ecklonia.csv"</span>)</span>
<span id="cb17-110"><a href="#cb17-110"></a><span class="in">```</span></span>
<span id="cb17-111"><a href="#cb17-111"></a></span>
<span id="cb17-112"><a href="#cb17-112"></a>We will also create a subsetted version of our data by removing all of the categorical variables. If we have a dataframe where each column represents pair-wise continuous/ordinal measurements with all of the other columns we may very quickly and easily perform a much wider range of correlation analyses.</span>
<span id="cb17-113"><a href="#cb17-113"></a></span>
<span id="cb17-116"><a href="#cb17-116"></a><span class="in">```{r}</span></span>
<span id="cb17-117"><a href="#cb17-117"></a>ecklonia_sub <span class="ot">&lt;-</span> ecklonia <span class="sc">%&gt;%</span></span>
<span id="cb17-118"><a href="#cb17-118"></a>  <span class="fu">select</span>(<span class="sc">-</span>species, <span class="sc">-</span> site, <span class="sc">-</span> ID)</span>
<span id="cb17-119"><a href="#cb17-119"></a></span>
<span id="cb17-120"><a href="#cb17-120"></a><span class="co"># order the columns alphabetically</span></span>
<span id="cb17-121"><a href="#cb17-121"></a>ecklonia_sub <span class="ot">&lt;-</span> ecklonia_sub[,<span class="fu">order</span>(<span class="fu">colnames</span>(ecklonia_sub))]</span>
<span id="cb17-122"><a href="#cb17-122"></a><span class="in">```</span></span>
<span id="cb17-123"><a href="#cb17-123"></a></span>
<span id="cb17-124"><a href="#cb17-124"></a>When the values we are comparing are continuous, we may use a Pearson test. This is the default and so requires little work on our end. The resulting statistic from this test is known as the Pearson correlation coefficient:</span>
<span id="cb17-125"><a href="#cb17-125"></a></span>
<span id="cb17-128"><a href="#cb17-128"></a><span class="in">```{r}</span></span>
<span id="cb17-129"><a href="#cb17-129"></a><span class="co"># Perform correlation analysis on two specific variables</span></span>
<span id="cb17-130"><a href="#cb17-130"></a><span class="co"># Note that we do not need the final two arguments in this function to be stated</span></span>
<span id="cb17-131"><a href="#cb17-131"></a><span class="co"># as they are the defaut settings.</span></span>
<span id="cb17-132"><a href="#cb17-132"></a><span class="co"># They are only shown here to illustrate that they exist.</span></span>
<span id="cb17-133"><a href="#cb17-133"></a><span class="fu">cor.test</span>(<span class="at">x =</span> ecklonia<span class="sc">$</span>stipe_length, ecklonia<span class="sc">$</span>frond_length,</span>
<span id="cb17-134"><a href="#cb17-134"></a>         <span class="at">use =</span> <span class="st">"everything"</span>, <span class="at">method =</span> <span class="st">"pearson"</span>)</span>
<span id="cb17-135"><a href="#cb17-135"></a><span class="in">```</span></span>
<span id="cb17-136"><a href="#cb17-136"></a></span>
<span id="cb17-137"><a href="#cb17-137"></a>Above we have tested the correlation between the length of *Ecklonia maxima* stipes and the length of their fronds. A perfect positive (negative) relationship would produce a value of 1 (-1), whereas no relationship would produce a value of 0. The result above, <span class="in">`cor = 0.65`</span> is relatively strong.</span>
<span id="cb17-138"><a href="#cb17-138"></a></span>
<span id="cb17-139"><a href="#cb17-139"></a>As is the case with everything else we have learned thus far, a good visualisation can go a long way to help us understand what the statistics are doing. Below we visualise the stipe length to frond length relationship.</span>
<span id="cb17-140"><a href="#cb17-140"></a></span>
<span id="cb17-143"><a href="#cb17-143"></a><span class="in">```{r}</span></span>
<span id="cb17-144"><a href="#cb17-144"></a><span class="co">#| label: fig-corr1</span></span>
<span id="cb17-145"><a href="#cb17-145"></a><span class="co">#| fig-cap: "Scatterplot showing relationship between _Ecklonia maxima_ stipe length (cm) and frond length (cm). The correlation coefficient (Pearson _r_) is shown in the top left corner. Note that the best fit blue line was produced by a linear model and that it is not responsible for generating the correlation coefficient; rather it is included to help visually demonstrate the strength of the relationship."</span></span>
<span id="cb17-146"><a href="#cb17-146"></a></span>
<span id="cb17-147"><a href="#cb17-147"></a><span class="co"># Calculate Pearson r beforehand for plotting</span></span>
<span id="cb17-148"><a href="#cb17-148"></a>r_print <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"r = "</span>,</span>
<span id="cb17-149"><a href="#cb17-149"></a>                  <span class="fu">round</span>(<span class="fu">cor</span>(<span class="at">x =</span> ecklonia<span class="sc">$</span>stipe_length, ecklonia<span class="sc">$</span>frond_length),<span class="dv">2</span>))</span>
<span id="cb17-150"><a href="#cb17-150"></a></span>
<span id="cb17-151"><a href="#cb17-151"></a><span class="co"># Then create a single panel showing one correlation</span></span>
<span id="cb17-152"><a href="#cb17-152"></a><span class="fu">ggplot</span>(<span class="at">data =</span> ecklonia, <span class="fu">aes</span>(<span class="at">x =</span> stipe_length, <span class="at">y =</span> frond_length)) <span class="sc">+</span></span>
<span id="cb17-153"><a href="#cb17-153"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">colour =</span> <span class="st">"blue3"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">size =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb17-154"><a href="#cb17-154"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">col =</span> <span class="st">"red3"</span>, <span class="at">shape =</span> <span class="dv">16</span>) <span class="sc">+</span></span>
<span id="cb17-155"><a href="#cb17-155"></a>  <span class="fu">geom_label</span>(<span class="at">x =</span> <span class="dv">300</span>, <span class="at">y =</span> <span class="dv">240</span>, <span class="at">label =</span> r_print) <span class="sc">+</span></span>
<span id="cb17-156"><a href="#cb17-156"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Stipe length (cm)"</span>, <span class="at">y =</span> <span class="st">"Frond length (cm)"</span>) <span class="sc">+</span></span>
<span id="cb17-157"><a href="#cb17-157"></a>  <span class="fu">theme_pubclean</span>()</span>
<span id="cb17-158"><a href="#cb17-158"></a><span class="in">```</span></span>
<span id="cb17-159"><a href="#cb17-159"></a></span>
<span id="cb17-160"><a href="#cb17-160"></a>Just by eye-balling this scatterplot it should be clear that these data tend to increase at a roughly similar rate. Our Pearson r value is an indication of what that is.</span>
<span id="cb17-161"><a href="#cb17-161"></a></span>
<span id="cb17-162"><a href="#cb17-162"></a>Should our dataset contain multiple variables, as <span class="in">`ecklonia`</span> does, we may investigate all of the correlations simultaneously. Remember that in order to do so we want to ensure that we may perform the same test on each of our paired variables. In this case we will use <span class="in">`ecklonia_sub`</span> as we know that it contains only continuous data and so are appropriate for use with a Pearson test. By default R will use all of the data we give it and perform a Pearson test so we do not need to specify any further arguments. Note however that this will only output the correlation coefficients, and does not produce a full test of each correlation. This will however be useful for us to have just now.</span>
<span id="cb17-163"><a href="#cb17-163"></a></span>
<span id="cb17-166"><a href="#cb17-166"></a><span class="in">```{r}</span></span>
<span id="cb17-167"><a href="#cb17-167"></a><span class="co">#| column: page</span></span>
<span id="cb17-168"><a href="#cb17-168"></a>ecklonia_pearson <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">cor</span>(ecklonia_sub), <span class="dv">2</span>)</span>
<span id="cb17-169"><a href="#cb17-169"></a>ecklonia_pearson <span class="sc">|&gt;</span> </span>
<span id="cb17-170"><a href="#cb17-170"></a>  <span class="fu">kbl</span>(<span class="at">caption =</span> <span class="st">"A pairwise matrix of the *Ecklonia* dataset."</span>) <span class="sc">%&gt;%</span></span>
<span id="cb17-171"><a href="#cb17-171"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>)</span>
<span id="cb17-172"><a href="#cb17-172"></a><span class="in">```</span></span>
<span id="cb17-173"><a href="#cb17-173"></a></span>
<span id="cb17-174"><a href="#cb17-174"></a></span>
<span id="cb17-175"><a href="#cb17-175"></a>How would we visualise this matrix of correlations? It is relatively straightforward to quickly plot correlation results for all of our variables in one go. In order to show which variables associate most with which other variables all at once, without creating chaos, we will create what is known as a pairwise correlation plot. This visualisation uses a range of colours, usually blue to red, to demonstrate where more of something is. In this case, we use it to show where more correlation is occurring between morphometric properties of the kelp *Ecklonia maxima*.</span>
<span id="cb17-176"><a href="#cb17-176"></a></span>
<span id="cb17-179"><a href="#cb17-179"></a><span class="in">```{r}</span></span>
<span id="cb17-180"><a href="#cb17-180"></a><span class="co">#| label: fig-corr2</span></span>
<span id="cb17-181"><a href="#cb17-181"></a><span class="co">#| fig-cap: "Plot of pairwise correlations showing the strength of all correlations between all variables as a scale from red (negative) to blue (positive)."</span></span>
<span id="cb17-182"><a href="#cb17-182"></a></span>
<span id="cb17-183"><a href="#cb17-183"></a><span class="co"># extract the lower triangle and plot</span></span>
<span id="cb17-184"><a href="#cb17-184"></a>ecklonia_pearson[<span class="fu">upper.tri</span>(ecklonia_pearson)] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb17-185"><a href="#cb17-185"></a><span class="fu">corrplot</span>(ecklonia_pearson, <span class="at">method =</span> <span class="st">"circle"</span>, <span class="at">na.label.col =</span> <span class="st">"white"</span>)</span>
<span id="cb17-186"><a href="#cb17-186"></a><span class="in">```</span></span>
<span id="cb17-187"><a href="#cb17-187"></a></span>
<span id="cb17-188"><a href="#cb17-188"></a>Let's do it is **ggplot2** (@fig-corr3). Here I use the `geom_tile()` function. However, before I can use the data in **ggplot2**, I need to create a long dataframe from the correlation matrix, and I can do this with the <span class="in">`pivot_longer()`</span> function. There are several other methods for plotting pairwise correlations available---please feel free to scratch around the internet for options you like. This graph is called a heatmap, which is not dissimilar to the heatmaps and Hovmöller diagrams created in <span class="co">[</span><span class="ot">Chapter 2</span><span class="co">](03-visualise.qmd#sec-heatmaps)</span>. </span>
<span id="cb17-189"><a href="#cb17-189"></a></span>
<span id="cb17-190"><a href="#cb17-190"></a>Pairwise correlations are useful for identifying patterns and relationships between variables that may be hidden in the overall correlation structure of the dataset. This is particularly useful in a large dataset with many variables, where this type of analysis---especially when coupled with a suitable visualisation---can help identify subsets of variables that are strongly related to each other, which can then point the path to further analysis or modelling.</span>
<span id="cb17-191"><a href="#cb17-191"></a></span>
<span id="cb17-194"><a href="#cb17-194"></a><span class="in">```{r}</span></span>
<span id="cb17-195"><a href="#cb17-195"></a><span class="co">#| label: fig-corr3</span></span>
<span id="cb17-196"><a href="#cb17-196"></a><span class="co">#| fig-cap: "Pairwise of the *Ecklonia* dataset correlations created in **ggplot2**."</span></span>
<span id="cb17-197"><a href="#cb17-197"></a></span>
<span id="cb17-198"><a href="#cb17-198"></a>ecklonia_pearson <span class="sc">|&gt;</span> </span>
<span id="cb17-199"><a href="#cb17-199"></a>  <span class="fu">as.data.frame</span>() <span class="sc">|&gt;</span> </span>
<span id="cb17-200"><a href="#cb17-200"></a>  <span class="fu">mutate</span>(<span class="at">x =</span> <span class="fu">rownames</span>(ecklonia_pearson)) <span class="sc">|&gt;</span> </span>
<span id="cb17-201"><a href="#cb17-201"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> stipe_length<span class="sc">:</span>epiphyte_length,</span>
<span id="cb17-202"><a href="#cb17-202"></a>               <span class="at">names_to =</span> <span class="st">"y"</span>,</span>
<span id="cb17-203"><a href="#cb17-203"></a>               <span class="at">values_to =</span> <span class="st">"r"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb17-204"><a href="#cb17-204"></a>  <span class="fu">filter</span>(x <span class="sc">!=</span> <span class="st">"digits"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb17-205"><a href="#cb17-205"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(x, y, <span class="at">fill =</span> r)) <span class="sc">+</span></span>
<span id="cb17-206"><a href="#cb17-206"></a>    <span class="fu">geom_tile</span>(<span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb17-207"><a href="#cb17-207"></a>    <span class="fu">scale_fill_gradient2</span>(<span class="at">low =</span> <span class="st">"blue"</span>, <span class="at">high =</span> <span class="st">"red"</span>, <span class="at">mid =</span> <span class="st">"white"</span>,</span>
<span id="cb17-208"><a href="#cb17-208"></a>                         <span class="at">midpoint =</span> <span class="dv">0</span>, <span class="at">limit =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>),</span>
<span id="cb17-209"><a href="#cb17-209"></a>                          <span class="at">na.value =</span> <span class="st">"grey95"</span>,, <span class="at">space =</span> <span class="st">"Lab"</span>,</span>
<span id="cb17-210"><a href="#cb17-210"></a>                         <span class="at">name =</span> <span class="st">"r"</span>) <span class="sc">+</span></span>
<span id="cb17-211"><a href="#cb17-211"></a>    <span class="fu">xlab</span>(<span class="cn">NULL</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb17-212"><a href="#cb17-212"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb17-213"><a href="#cb17-213"></a>    <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">vjust =</span> <span class="dv">1</span>,</span>
<span id="cb17-214"><a href="#cb17-214"></a>                                     <span class="at">hjust =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb17-215"><a href="#cb17-215"></a>    <span class="fu">coord_fixed</span>() </span>
<span id="cb17-216"><a href="#cb17-216"></a><span class="in">```</span></span>
<span id="cb17-217"><a href="#cb17-217"></a></span>
<span id="cb17-218"><a href="#cb17-218"></a><span class="fu">## Spearman rank correlation</span></span>
<span id="cb17-219"><a href="#cb17-219"></a></span>
<span id="cb17-220"><a href="#cb17-220"></a>Spearman correlation is used to measure the strength and direction of the relationship between two variables, based on their rank order. Unlike Pearson correlation, which assumes that the relationship between two variables is linear, Spearman correlation can be used to measure the strength of any monotonic relationship, whether it is linear or not. Additionally, this correlation is useful even when the data are not normally distributed, or contain outliers.</span>
<span id="cb17-221"><a href="#cb17-221"></a></span>
<span id="cb17-222"><a href="#cb17-222"></a>To calculate the Spearman correlation coefficient, $\rho$, the values of both variables are first ranked from lowest to highest and each value is assigned a numerical rank based on its position in the ordered list. Then, the difference between the ranks of the two variables is calculated for each observation, and the squared differences are summed across all observations. The Spearman correlation coefficient is then calculated as the ratio of the sum of the squared differences to the total number of observations, adjusted for ties (@eq-spearman). Like the Pearson correlation coefficient, $\rho$ can also range from -1 to +1.</span>
<span id="cb17-223"><a href="#cb17-223"></a></span>
<span id="cb17-224"><a href="#cb17-224"></a>::: {.column-margin}</span>
<span id="cb17-225"><a href="#cb17-225"></a>**Spearman's $\rho$:**</span>
<span id="cb17-226"><a href="#cb17-226"></a>$$\rho = 1 - \frac{6 \sum_{i=1}^n d_i^2}{n(n^2-1)}$$ {#eq-spearman}</span>
<span id="cb17-227"><a href="#cb17-227"></a></span>
<span id="cb17-228"><a href="#cb17-228"></a>where $\rho$ is the Spearman correlation, $d_i$ is the difference between the ranks of the two variables for the $i^{th}$ observation, and $n$ is the sample size. The factor of 6 in the equation is a normalisation constant that adjusts the range of possible values of the correlation coefficient to be between -1 and +1.</span>
<span id="cb17-229"><a href="#cb17-229"></a>:::</span>
<span id="cb17-230"><a href="#cb17-230"></a></span>
<span id="cb17-231"><a href="#cb17-231"></a>In the code below we will add a column of ordinal data to our <span class="in">`ecklonia`</span> data to so that we may look at this test.</span>
<span id="cb17-232"><a href="#cb17-232"></a></span>
<span id="cb17-235"><a href="#cb17-235"></a><span class="in">```{r}</span></span>
<span id="cb17-236"><a href="#cb17-236"></a><span class="co"># Create ordinal data</span></span>
<span id="cb17-237"><a href="#cb17-237"></a>ecklonia<span class="sc">$</span>length <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">cut</span>((ecklonia<span class="sc">$</span>stipe_length <span class="sc">+</span> ecklonia<span class="sc">$</span>frond_length), <span class="at">breaks =</span> <span class="dv">3</span>))</span>
<span id="cb17-238"><a href="#cb17-238"></a></span>
<span id="cb17-239"><a href="#cb17-239"></a><span class="co"># What does this new column look like?</span></span>
<span id="cb17-240"><a href="#cb17-240"></a><span class="fu">head</span>(<span class="fu">select</span>(ecklonia, <span class="fu">c</span>(species, site, stipe_length, frond_length, length)), <span class="dv">10</span>)</span>
<span id="cb17-241"><a href="#cb17-241"></a><span class="in">```</span></span>
<span id="cb17-242"><a href="#cb17-242"></a></span>
<span id="cb17-243"><a href="#cb17-243"></a>Now let us correlate the new <span class="in">`length`</span> variable with any one of the other variables:</span>
<span id="cb17-244"><a href="#cb17-244"></a></span>
<span id="cb17-247"><a href="#cb17-247"></a><span class="in">```{r}</span></span>
<span id="cb17-248"><a href="#cb17-248"></a><span class="fu">cor.test</span>(ecklonia<span class="sc">$</span>length, ecklonia<span class="sc">$</span>digits, <span class="at">method =</span> <span class="st">"spearman"</span>)</span>
<span id="cb17-249"><a href="#cb17-249"></a><span class="in">```</span></span>
<span id="cb17-250"><a href="#cb17-250"></a></span>
<span id="cb17-251"><a href="#cb17-251"></a><span class="fu">## Kendall rank correlation</span></span>
<span id="cb17-252"><a href="#cb17-252"></a></span>
<span id="cb17-253"><a href="#cb17-253"></a>Kendall's correlation, also known as Kendall's $\tau$, is a non-parametric correlation method for assessing the strength and direction of the relationship between two variables. It is similar to Spearman's rank correlation, but it is calculated differently.</span>
<span id="cb17-254"><a href="#cb17-254"></a></span>
<span id="cb17-255"><a href="#cb17-255"></a>Kendall's $\tau$ is calculated based on the number of concordant and discordant pairs of observations between the two variables being correlated. A concordant pair is one in which the values of both variables have the same order, meaning that if the value of one variable is higher than the other for one observation, it is also higher for the other observation. A discordant pair is one in which the values of the two variables have different order, meaning that if one variable is higher than the other for one observation, it is lower for the other observation.</span>
<span id="cb17-256"><a href="#cb17-256"></a></span>
<span id="cb17-257"><a href="#cb17-257"></a>$\tau$ is calculated as the difference between the number of concordant and discordant pairs of observations, divided by the total number of possible pairs (@eq-kendall). As in Pearson's and Spearman's correlations, the result also ranges from -1 and +1.</span>
<span id="cb17-258"><a href="#cb17-258"></a></span>
<span id="cb17-259"><a href="#cb17-259"></a>::: {.column-margin}</span>
<span id="cb17-260"><a href="#cb17-260"></a>**Kendal's $\tau$:**</span>
<span id="cb17-261"><a href="#cb17-261"></a>$$\tau = \frac{n_c - n_d}{\binom{n}{2}}$$ {#eq-kendall}</span>
<span id="cb17-262"><a href="#cb17-262"></a></span>
<span id="cb17-263"><a href="#cb17-263"></a>where $\tau$ is Kendall's $\tau$ correlation coefficient, $n$ is the sample size, $n_c$ is the number of concordant pairs of observations, $n_d$ is the number of discordant pairs of observations, and $\binom{n}{2}$ is the number of possible pairs of observations in the sample.</span>
<span id="cb17-264"><a href="#cb17-264"></a>:::</span>
<span id="cb17-265"><a href="#cb17-265"></a></span>
<span id="cb17-266"><a href="#cb17-266"></a>Kendall's $\tau$ is a useful correlation statistic for non-parametric data, such as ordinal or categorical data, and is robust to outliers and non-normal distributions.</span>
<span id="cb17-267"><a href="#cb17-267"></a></span>
<span id="cb17-268"><a href="#cb17-268"></a>Let's look at the normality of our <span class="in">`ecklonia`</span> variables and pull out those that are not normal in order to see how the results of this test may differ from our Pearson tests.</span>
<span id="cb17-269"><a href="#cb17-269"></a></span>
<span id="cb17-272"><a href="#cb17-272"></a><span class="in">```{r}</span></span>
<span id="cb17-273"><a href="#cb17-273"></a>ecklonia_norm <span class="ot">&lt;-</span> ecklonia_sub <span class="sc">%&gt;%</span></span>
<span id="cb17-274"><a href="#cb17-274"></a>  <span class="fu">gather</span>(<span class="at">key =</span> <span class="st">"variable"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb17-275"><a href="#cb17-275"></a>  <span class="fu">group_by</span>(variable) <span class="sc">%&gt;%</span></span>
<span id="cb17-276"><a href="#cb17-276"></a>  <span class="fu">summarise</span>(<span class="at">variable_norm =</span> <span class="fu">as.numeric</span>(<span class="fu">shapiro.test</span>(value)[<span class="dv">2</span>]))</span>
<span id="cb17-277"><a href="#cb17-277"></a>ecklonia_norm</span>
<span id="cb17-278"><a href="#cb17-278"></a><span class="in">```</span></span>
<span id="cb17-279"><a href="#cb17-279"></a></span>
<span id="cb17-280"><a href="#cb17-280"></a>From this analysis we may see that the values for primary blade length are not normally distributed. In order to make up for this violation of our assumption of normality we may use the Kendall test.</span>
<span id="cb17-281"><a href="#cb17-281"></a></span>
<span id="cb17-284"><a href="#cb17-284"></a><span class="in">```{r}</span></span>
<span id="cb17-285"><a href="#cb17-285"></a><span class="fu">cor.test</span>(ecklonia<span class="sc">$</span>primary_blade_length, ecklonia<span class="sc">$</span>primary_blade_width, <span class="at">method =</span> <span class="st">"kendall"</span>)</span>
<span id="cb17-286"><a href="#cb17-286"></a><span class="in">```</span></span>
<span id="cb17-287"><a href="#cb17-287"></a></span>
<span id="cb17-288"><a href="#cb17-288"></a>Here the correlation coefficient is called Kendall's $\tau$ but it is interpreted as we would Pearson's.</span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
<p>© 2025, AJ Smit</p>
</div>   
    <div class="nav-footer-center">

<div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/ajsmit/tangled_bank/edit/main/BCB744/basic_stats/10-correlations.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/ajsmit/tangled_bank/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div><div class="cookie-consent-footer"><a href="#" id="open_preferences_center">Cookie Preferences</a></div></div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer><script>var lightboxQuarto = GLightbox({"closeEffect":"zoom","descPosition":"bottom","loop":false,"openEffect":"zoom","selector":".lightbox"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>


<script src="../../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>