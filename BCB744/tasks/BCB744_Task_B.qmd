---
title: "BCB744 Task B"
format: 
  html:
    fig-format: svg
    fig_retina: 2
    fig-dpi: 400
params: 
  hide_answers: true
execute:
  fig-format: png
  dev: ragg_png
---

```{r code-brewing-opts, echo=FALSE}
knitr::opts_chunk$set(
  comment = "R>", 
  warning = FALSE, 
  message = FALSE,
  fig.width = 4.5,
  fig.height = 2.625,
  out.width = "75%",
  fig.asp = NULL, # control via width/height
  dpi = 300
)

ggplot2::theme_set(
  ggplot2::theme_minimal(base_size = 8)
)
ggplot2::theme_set(
  ggplot2::theme_bw(base_size = 8)
)
```

```{r code-knitr-opts-chunk-set, echo=FALSE}
knitr::opts_chunk$set(
  echo = TRUE,
  eval = TRUE,
  warning = FALSE,
  message = FALSE,
  fig.width = 6,
  fig.asp = 0.65,
  out.width = "100%",
  fig.align = "center"
)
library(tidyverse)
library(ggpubr)
library(ggthemes)
```

# [[Assessment Sheet](BCB744_Task_B_Surname.xlsx)]{.my-highlight} {#sec-assessment}

# 6. Faceting Figures

## Question 1

Create a scatterplot of `bill_length_mm` against `bill_depth_mm` for `Adelie` penguins on `Biscoe` island. **(/10)**

`r if (params$hide_answers) "::: {.content-hidden}"`

**Answer**

```{r fig-library-palmerpenguins, fig.width=5, fig.asp=0.65, out.width="60%", fig.align='center'}
#| fig-cap: "Adelie bill length vs. bill depth on Biscoe Island."
library(palmerpenguins) # ✓ 
library(tidyverse) # ✓ 
data(penguins)
head(penguins)

penguins %>% # ✓ 
  filter(island == "Biscoe" & species == "Adelie") %>%  # ✓ 
  ggplot(aes(x = bill_length_mm, y = bill_depth_mm)) +  # ✓ 
  geom_point() +  # ✓ 
  labs(title = "Adelie Penguins on Biscoe Island",  # ✓ 
         x = "Bill Length (mm)", # ✓ 
         y = "Bill Depth (mm)") # ✓ 
```


`r if (params$hide_answers) ":::"`

## Question 2

Create histograms of `bill_length_mm` for `Adelie` penguins on all three islands (one figure per island). Save each figure as a separate R object which you can later reuse. Again for `Adelie` penguins, create a boxplot for `bill_length_mm` showing all the data on one plot. Save it too as an R object. Combine the four saved figures into one figure using `ggarrange()`. **(/25)**

`r if (params$hide_answers) "::: {.content-hidden}"`

**Answer**

```{r fig-library-ggpubr, fig.width=8, fig.asp=0.65, out.width="60%", fig.align='center'}
#| fig-cap: "Adelie bill length histograms by island plus overall boxplot."
library(ggpubr) # ✓

# Create histograms
adelie_biscoe <- penguins %>% # ✓ x 5
  filter(island == "Biscoe" & species == "Adelie") %>% 
  ggplot(aes(x = bill_length_mm)) + 
  geom_histogram() + 
  labs(title = "Adelie Penguins on Biscoe Island", 
       x = "Bill Length (mm)", 
       y = "Frequency")

adelie_dream <- penguins %>% # ✓ x 5
  filter(island == "Dream" & species == "Adelie") %>% 
  ggplot(aes(x = bill_length_mm)) + 
  geom_histogram() + 
  labs(title = "Adelie Penguins on Dream Island", 
       x = "Bill Length (mm)", 
       y = "Frequency")

adelie_torgersen <- penguins %>% # ✓ x 5
  filter(island == "Torgersen" & species == "Adelie") %>% 
  ggplot(aes(x = bill_length_mm)) + 
  geom_histogram() + 
  labs(title = "Adelie Penguins on Torgersen Island", 
       x = "Bill Length (mm)", 
       y = "Frequency")

# Create boxplot # ✓ x 5
adelie_boxplot <- penguins %>% 
  filter(species == "Adelie") %>% 
  ggplot(aes(x = island, y = bill_length_mm)) + 
  geom_boxplot() + 
  labs(title = "Adelie Penguins Bill Length Boxplot", 
       x = "Island", 
       y = "Bill Length (mm)")

# Combine figures # ✓ x 1
ggarrange(adelie_biscoe, adelie_dream, adelie_torgersen, adelie_boxplot, 
          ncol = 2, nrow = 2)
```


`r if (params$hide_answers) ":::"`

## Question 3

Create a scatter plot of `flipper_length_mm` against `body_mass_g` and use `facet_wrap()` to create separate panels for each island (combine all species). Also indicate the effect of species. Add a best-fit straight line with 95% confidence intervals through the points, ignoring the effect of species. Take into account which variable best belongs on `x` and `y`. Describe your findings. **(/10)**

`r if (params$hide_answers) "::: {.content-hidden}"`

**Answer**

```{r fig-penguins-x, warning=FALSE, message=FALSE, fig.width=6, fig.asp=0.65, out.width="60%", fig.align='center'}
#| fig-cap: "Flipper length vs. body mass faceted by island and coloured by species."
penguins %>% # ✓ x 6
  ggplot(aes(x = body_mass_g, y = flipper_length_mm)) + 
  geom_point(aes(colour = species)) + 
  geom_smooth(method = "lm", se = TRUE) +
  facet_wrap(~island) + 
  labs(title = "Flipper Length vs Body Mass", 
       x = "Body Mass (g)",
       y = "Flipper Length (mm)")
```

- The `body_mass_g` variable is best suited to the `x`-axis as it is the independent variable. The `flipper_length_mm` variable is best suited to the `y`-axis as it is the dependent variable.
- ✓ For all penguin species, the `flipper_length_mm` and `body_mass_g` variables show a positive correlation, with larger penguins having longer flippers, higher body masses.
- ✓ The `Adelie` penguins on `Biscoe` island have the shortest flippers and lowest body masses, while `Gentoo` penguins have the longest flippers and highest body masses.
- ✓ `Chinstrap` and `Adelie` penguins are present on `Dream` island; these species' body masses and flipper lengths are difficult to distinguish from one-another.
- ✓ Only `Adelie` penguins are present on `Torgersen` island. The `Adelie` penguins appear to have the same flipper length vs body mass relationship across all three islands.

`r if (params$hide_answers) ":::"`

## Question 4

Create a scatter plot of `bill_length_mm` and `body_mass_g` and use `facet_grid()` to create separate panels for each species and island. **(/6)**

`r if (params$hide_answers) "::: {.content-hidden}"`

**Answer**

```{r fig-grid-plt-penguins-x, warning=FALSE, message=FALSE, fig.width=6, fig.asp=0.65, out.width="60%", fig.align='center'}
#| fig-cap: "Bill length vs. body mass faceted by species and island."
grid_plt <-  penguins %>% # ✓ x 6
  ggplot(aes(x = body_mass_g, y = bill_length_mm)) + 
  geom_point() + 
  facet_grid(species ~ island) + 
  labs(title = "Bill Length vs Body Mass", 
       x = "Body Mass (g)",
       y = "Bill Length (mm)")
grid_plt
```


`r if (params$hide_answers) ":::"`

## Question 5

Using the figure created in point 4, also show the effect of `sex` and add a best-fit straight line. Explain the findings. **(/9)**

`r if (params$hide_answers) "::: {.content-hidden}"`

**Answer**

```{r code-grid-plt-x, warning=FALSE, message=FALSE, fig.width=6, fig.asp=0.65, out.width="60%", fig.align='center'}
grid_plt +  # ✓ x 6
  geom_point(aes(col = sex)) +
  geom_smooth(method = "lm", se = TRUE, colour = "black")
```

- ✓ The `bill_length_mm` and `body_mass_g` variables show a positive correlation, with larger penguins having longer bills, higher body masses.
- ✓ The `sex` variable appear to have an effect on the relationship between `bill_length_mm` and `body_mass_g`, with male penguins tending to be heavier with longer bill lengths.
- ✓ There also appears to be differences in the relationship between `bill_length_mm` and `body_mass_g` between the different species and islands.

`r if (params$hide_answers) ":::"`

## Question 6

What are the benefits of using faceting in data visualisation? **(/3)**

`r if (params$hide_answers) "::: {.content-hidden}"`

**Answer**

- ✓ Faceting allows for the visualisation of multiple relationships in a single plot, making it easier to compare relationships between different groups.
- ✓ Faceting can help to identify patterns and trends in the data that may not be immediately obvious when looking at the data as a whole.
- ✓ Faceting can help to identify differences in relationships between different groups, such as species, islands or allowing for more detailed analysis of the data.

`r if (params$hide_answers) ":::"`
