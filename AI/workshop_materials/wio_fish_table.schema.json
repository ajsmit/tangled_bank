{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://example.org/schemas/wio-fish-table.schema.json",
  "title": "Western Indian Ocean – Harmonised Fish Table",
  "description": "Row-wise schema for harmonised taxonomic records used for cross-source binding. Rows represent taxa (primarily finfish; cephalopods appear when required for contextual linkage). Use 'Scientific Name' as the canonical key where available; otherwise fall back to 'FishBase accepted' or 'WoRMS accepted'. All text fields use Unicode NFC; leading/trailing whitespace should be trimmed before validation.",
  "type": "array",
  "items": {
    "type": "object",
    "additionalProperties": false,
    "required": [
      "Scientific Name"
    ],
    "properties": {
      "Common Name": {
        "type": "string",
        "description": "English vernacular name associated with the taxon; may be regionally ambiguous."
      },
      "Scientific Name": {
        "type": "string",
        "description": "Canonical binomen (Genus species) used as the primary join key for binding across data sources.",
        "pattern": "^[A-Z][a-z-]+\\s+[a-z-]+(?:\\s+[a-z-]+)?$"
      },
      "Family": {
        "type": "string",
        "description": "Taxonomic family (e.g., Serranidae, Carcharhinidae)."
      },
      "Distribution": {
        "type": "string",
        "description": "Geographic scope or region string (e.g., 'South West Indian Ocean', 'WIO reefs')."
      },
      "Additional Data Available": {
        "type": "string",
        "description": "Free-text indicator of ancillary assets or metadata available in the source (e.g., 'Pictured in report')."
      },
      "Submitted name": {
        "type": "string",
        "description": "Original string as submitted by the upstream source prior to normalisation."
      },
      "FishBase accepted": {
        "type": "string",
        "description": "Name per FishBase usage after standardisation; blank when the taxon lies outside FishBase scope (e.g., cephalopods)."
      },
      "WoRMS accepted": {
        "type": "string",
        "description": "Accepted name per WoRMS (or WoRMS→MolluscaBase); used to reconcile discordant cases (e.g., Stegostoma, Loligo)."
      },
      "Provenance": {
        "type": "string",
        "description": "Authority trail applied when standardising this row.",
        "enum": [
          "FishBase",
          "FishBase + WoRMS",
          "WoRMS + SeaLifeBase",
          "—"
        ]
      }
    },
    "allOf": [
      {
        "properties": {
          "Scientific Name": {
            "pattern": "^(?!\\s).*(?<!\\s)$"
          }
        }
      },
      {
        "anyOf": [
          {
            "required": [
              "FishBase accepted"
            ]
          },
          {
            "required": [
              "WoRMS accepted"
            ]
          }
        ]
      }
    ]
  },
  "$comment": "Joining rule (not formally enforceable here): bind rows primarily on 'Scientific Name'. If absent or not resolvable, match on 'FishBase accepted'; if still absent, match on 'WoRMS accepted'. Disallow binding on 'Common Name' alone. Before binding, normalise Unicode and collapse internal whitespace to single spaces.",
  "examples": [
    {
      "Common Name": "Emperor angelfish",
      "Scientific Name": "Pomacanthus imperator",
      "Family": "Pomacanthidae",
      "Distribution": "South West Indian Ocean",
      "Additional Data Available": "Pictured in report",
      "Submitted name": "Pomacanthus imperator",
      "FishBase accepted": "Pomacanthus imperator",
      "WoRMS accepted": "",
      "Provenance": "FishBase"
    }
  ]
}