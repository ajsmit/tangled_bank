% --- Customised preamble.tex begins here ---
\usepackage[a4paper]{geometry}
\usepackage[british]{babel}
\frenchspacing
\tolerance=400
\emergencystretch=3em
\hyphenpenalty=20

\usepackage{microtype}
\microtypesetup{
  tracking   = true,
  protrusion = true,
  expansion  = true,
  factor     = 1100,
  stretch    = 15,
  shrink     = 15,
}

\let\oldtexttt\texttt
\renewcommand{\texttt}[1]{\oldtexttt{\small #1}}
\usepackage{etoolbox}
\AtBeginEnvironment{Highlighting}{\footnotesize}
\AtBeginEnvironment{verbatim}{\footnotesize}
\AtBeginEnvironment{Shaded}{\footnotesize}

% ——————————————————————————————————————————————
% Fontspec and typography
% ——————————————————————————————————————————————
\usepackage{fontspec}
\usepackage{amsmath}
\usepackage{luatexja}

% Serif body text → TeX Gyre Pagella (Palatino)
\setmainfont[
UprightFont    = *-Regular,
ItalicFont     = *-Italic,
BoldFont       = *-Bold,
BoldItalicFont = *-BoldItalic,
Ligatures      = TeX,
Numbers        = {Proportional}
]{TeX Gyre Pagella}

% Sans‐serif headings → Fira Sans (with TeX ligatures)
\setsansfont[
  UprightFont    = *-Regular,
  ItalicFont     = *-Italic,
  BoldFont       = *-Bold,
  BoldItalicFont = *-BoldItalic,
  Ligatures      = {TeX, Common, Discretionary},
  Numbers        = {Proportional}
]{Fira Sans}

% Monospace Font
\setmonofont[Scale=0.89]{FiraCode Nerd Font}

% Math Font (compatible with Merriweather)
\setmathfont{TeX Gyre Pagella Math}

% Configure all section titles to use the sans font
\usepackage{sectsty}
\allsectionsfont{\sffamily}

% Logo and title customization
\usepackage{graphicx}
\usepackage{titling}

% Disable default title hooks
\pretitle{}
\posttitle{}

% Disable Pandoc’s own title machinery
\renewcommand{\title}[1]{}
\renewcommand{\author}[1]{}
\renewcommand{\date}[1]{}

% Custom title page layout
\renewcommand{\maketitle}{%
  \begin{titlepage}
    \centering
    % Logos at top
    \includegraphics[height=3cm]{../Faculty_logo.png}\hspace{2cm}
    \includegraphics[height=3cm]{../UWC_logo.png}\\[2em]

    % Title lines in large bold
    {\Huge\bfseries
      BCB334 Biogeography \& Global Ecology Lecture Series, July 2025\\[0.5em]
      Biodiversity \& Conservation Biology Department\\[0.5em]
      University of the Western Cape\\[3em]
    }

    % Center vertically the descriptive paragraph
    \vfill
    {\large
      Author: Professor AJ Smit.\\[1em]
      This document contains transcripts from my online lectures prepared during the COVID-19 years of 2020 and 2021.\par
    }
    \vfill
  \end{titlepage}
}

% Auto-invoke title and TOC at start
\AtBeginDocument{%
  \maketitle
  \tableofcontents
  \newpage
}
